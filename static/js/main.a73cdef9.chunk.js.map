{"version":3,"sources":["helpers/BootstrapScripts.js","panels/icons/influence.png","panels/icons/planet.png","panels/icons/resource.png","panels/icons/specialty-biotic.png","panels/icons/specialty-warfare.png","panels/icons/specialty-propulsion.png","panels/icons/specialty-cybernetic.png","panels/icons/trait-cultural.png","panels/icons/trait-hazardous.png","panels/icons/trait-industrial.png","panels/MoreInfo.js","panels/ExtraTiles.js","overview/MainOverview.js","map/MainMap.js","map/ShareMapModal.js","map/MapControls.js","options/OptionsControls.js","options/HelpModal.js","options/SetPlayerNameModal.js","options/SetRacesModal.js","options/MapOptions.js","App.js","helpers/Helpers.js","reportWebVitals.js","index.js"],"names":["BootstrapScripts","id","src","integrity","crossOrigin","React","Component","MoreInfo","props","getAdjacent","bind","tileNumber","originalAdjacencies","adjacencyData","adjacencies","planets","resources","influence","specialties","traits","length","adjacentTileNumber","splice","adjacentTile","this","tiles","tileData","hyperlanes","indexOf","getTileNumber","hyperlaneAdjacencies","tilePositionRelatedToHyperlane","Number","hyperlaneLinks","all","currentRotation","split","hyperlane","hyperlaneStart","hyperlaneEnd","hyperlaneStartTilenumber","hyperlaneEndTilenumber","push","planetIndex","planet","moreInfoByPlayer","adjacentInfo","playerName","currentPlayerNames","scope","className","Array","cultural","map","e","i","traitCultural","alt","hazardous","traitHazardous","industrial","traitIndustrial","biotic","specialtyBiotic","warfare","specialtyWarfare","propulsion","specialtyPropulsion","cybernetic","specialtyCybernetic","fullSliceData","sliceData","playerSliceDataString","undefined","j","Player","SliceWeight","EQWeight","HSWeight","TotalWeight","PlayerWeight","HomeTile","Slice","toString","Equidistant","SliceTiles","HomeResources","HomeInfluence","HomePlanets","HomeSpecialties","HomeWormholes","SliceResources","SliceInfluence","SlicePlanets","SliceSpecialties","SliceWormholes","SliceAnomalies","EQResources","EQInfluence","EQPlanets","EQSpecialties","EQWormholes","EQAnomalies","visible","resource","ExtraTiles","underlayStyle","width","height","position","top","left","tileStyle","display","margin","overlayStyle","marginLeft","systemNumbers","concat","blue","red","useProphecyOfKings","showAllExtraTiles","customMapBuilding","pokBlue","pokRed","tileObjects","systemNumber","isNaN","overlayVisible","style","window","location","origin","pathname","draggable","onDragStart","drag","onDrop","drop","onDragOver","allowDrop","onDragEnter","dragEnter","onDragLeave","dragLeave","xmlns","viewBox","fill","points","type","name","checked","onChange","toggleShowAllExtraTiles","htmlFor","toggleCustomMapBuilding","MainOverview","transform","href","MainMap","toggleControls","getRotationDegrees","prevProps","prevState","snapshot","ReactTooltip","rebuild","event","splitArray","target","targetName","newTileClicked","tileClicked","updateTileClicked","rotationDirection","tile","$","degrees","rotationAngle","newTiles","updateTiles","css","unusedTiles","randomUnusedTile","Math","floor","random","lockedIndex","lockedTiles","newLockedTiles","updateLockedTiles","excludedIndex","excludedTiles","newExcludedTiles","newIncludedTiles","includedTiles","includedIndex","updateInExcludedTiles","obj","matrix","angle","values","a","b","round","atan2","PI","mapTiles","hidden","boardData","pokSize","hideRaceTiles","homeworlds","raceData","onClick","data-tip","data-place","onTouchMove","touchMove","onTouchEnd","touchEnd","ShareMapModal","getTTSTileString","getSliceDataTable","copyTileStringToClipboard","copyLinkToClipboard","removeTrailing","sleep","downloadImage","tileString","shift","replaceAll","console","log","navigator","clipboard","writeText","pop","ms","Promise","resolve","setTimeout","addClass","scrollTo","exportComponentAsPNG","fileName","html2CanvasOptions","backgroundColor","scrollX","scrollY","pageYOffset","scale","removeClass","Modal","show","onHide","hideModal","Header","closeButton","Title","Body","value","readOnly","aria-label","aria-describedby","MapControls","state","shareMapHelp","toggleShareMapHelp","setState","zoomPlus","zoomMinus","toggleOverlay","toggleExtraTiles","extraTilesVisible","toggleMoreInfo","moreInfoVisible","toggleBackground","OptionsControls","isMobileView","toggleOptions","HelpModal","title","dangerouslySetInnerHTML","__html","content","SetPlayerNameModal","x","placeholder","defaultValue","handleNameChange","SetRacesModal","searchString","updateSearchString","visibleRaces","races","pokRaces","handleRacesChange","raceName","raceIndex","raceVisible","toLowerCase","includes","replace","currentRaces","MapOptions","startingValues","numberOfPlayers","pokNumberOfPlayers","boardStyles","2","Object","keys","styles","key","3","4","5","6","filter","boardStylesPok","7","8","pickStyles","placementStyles","pokHomeworlds","optionsPossible","currentNumberOfPlayers","currentNumberOfPlayersOptions","currentBoardStyleOptions","currentBoardStyle","currentPickStyle","currentPlacementStyle","currentSeed","generationIterations","stopCriterion","userSetSeed","pickRaces","pickMultipleRaces","shuffleBoards","reversePlacementOrder","ensureRacialAnomalies","generated","pickRacesHelp","boardStyleHelp","pickStyleHelp","placementStyleHelp","setPlayerNamesHelp","setRacesHelp","pickMultipleRacesHelp","shufflePriorityHelp","reversePlacementOrderHelp","ensureRacialAnomaliesHelp","hideRaceTilesHelp","setIterationsHelp","setStopCritHelp","resourceWeight","influenceWeight","planetCountWeight","specialtyWeight","anomalyWeight","wormholeWeight","shuffleThreshold","handleInputChange","updatePok","updateHRT","updatePlayerCount","updateBoardStyle","updateSeed","resetGenerationIterations","resetStopCriterion","ensureAnomalies","ensureWormholesForType","updateBoardStyleOptions","encodeSettings","decodeSettings","generateBoard","getNewTileSet","togglePickRacesHelp","toggleBoardStyleHelp","togglePickStyleHelp","togglePlacementStyleHelp","toggleSetPlayerNamesHelp","toggleSetRacesHelp","togglePickMultipleRacesHelp","toggleShufflePriorityHelp","toggleReversePlacementOrderHelp","toggleEnsureRacialAnomaliesHelp","toggleHideRaceTilesHelp","toggleGenIterHelp","toggleStopCritHelp","nameIndex","parseInt","substring","newPlayerNames","race","newCurrentRaces","indexToToggle","updateRaces","boardOptions","toggleProphecyOfKings","toggleHideRaceTiles","newSeed","str","charAt","toUpperCase","slice","array","t","m","seed","valueOf","sin","encodedSettings","padStart","combinedRaces","changedPlayerName","playerNames","newSettings","currentIndex","updatePlayerNames","newTileSetGenerated","newSliceDataGenerated","getSliceData","preventDefault","genIter","sliceTotalWeights","k","maxDeltaWeight","max","min","systemIndexes","getNewTilesToPlace","shuffle","newSystems","getNewSystemsToPlace","blankMap","placeHyperlanes","placeHomeSystems","playerSliceComplete","EQSliceComplete","newSystem","theSliceData","weights","UsedWeights","EQSlice","allPlayersComplete","lowestPlayer","lowestPlayerWeight","EQSliceClean","thisSystem","getWeight","thisPlayerSlice","shuffledSlice","chosenIndex","chosenTile","placeLockedSystems","checkAdjacencies","checkRaceSlices","primary","secondary","tertiary","home","newPrimary","homeSystem","adjacentSystems","adjacentSystem","numberOfSystems","allBlues","allReds","system","blueTileRatio","redTileRatio","redsToPlace","bluesToPlace","ensuredAnomalies","forEach","anomalies","match","asteroidFields","pokAsteroidFields","supernovas","pokSupernovas","nebulae","pokNebulae","gravityRifts","pokGravityRifts","some","find","allAlphaWormholes","alphaWormholes","pokAlphaWormholes","allBetaWormholes","betaWormholes","pokBetaWormholes","getWeightedPlanetList","index","hyperlaneData","raceToHomeSystemMap","currentLocation","newTilesLocation","allTrueAnomalies","anomaly","pokAnomaly","anomalyTileNumber","adjacentTiles","adjacentAnomalies","swapped","blankReds","blankRed","pokBlankRed","possibleBlanks","blankRedTileNumber","swappable","alphaWormhole","alphaWormholeTileNumber","adjacentTileNumbers","adjacentWormhole","el","adjacentTilesNumbers","betaWormhole","betaWormholeTileNumber","anomalyTestSet","currentRaces2","currentHomeTile","homeSystemToRaceMap","r","anomalyFound","thisSlice","playerSliceWeights","sliceTileIndex","allMatchingAnomalyIndexes","matchingAnomaly","anomalyIndexToSwap","l","anomalyToSwapWeight","deltaweight","playerTileIndexToSwap","deltaweightBackup","playerTileIndexToSwapBackup","deltaweightBackup2","playerTileIndexToSwapBackup2","abs","anomalyToSwap","possibleTiles","planetWormholes","allWormholes","oppositeWormholes","allAnomalyList","unusedWormholes","usedWormholes","wormholeIndex","wormholesToUse","unusedWormhole","reverseReplace","numPlanetsToPlace","numAnomaliesLeftToBePlaced","possibleAnomalies","anomalyIndex","numTilesToReplace","replacementTiles","reverseBeforeAndAfter","reverse","currentTileIndex","tileOfInterest","possiblePlanets","planetWeights","planetTileNumber","sort","currentHighValue","currentSetToShuffle","postPossiblePlanets","planetWeight","orderedPlanets","weightedPlanet","total_weight","homeTiles","playerCounter","allAdjData","allAdjDataArray","homeTile","playerAdjData","tilesAlreadyListed","distance","thisTileArray","startTile","adjArray","newAdjData","Distances","allSliceData","allSliceDataArray","allSliceEquidistArray","thisplayer","systemIndex","distanceToPlayerX","tileFound","thisDistance","shortestDistance","thePlayer","equiDistTile","newAllSliceData","thisPlayer","numPlanets","wormholes","resourcesEQ","influenceEQ","numPlanetsEQ","specialtiesEQ","wormholesEQ","anomaliesEQ","resourcesHS","influenceHS","numPlanetsHS","specialtiesHS","wormholesHS","sliceWeight","totalWeight","playerWeight","thisWeight","foundDistance","sliceTiles","tIndex","onSubmit","capitalize","App","isOptionsMenuShowing","overviewVisible","backgroundAnimated","zoom","lastCall","mobileBreakpoint","encodedOptions","currentMobileHover","mapOptions","createRef","drawMap","onPopState","checkResize","validateTiles","toggleOptionsMenu","updateTileNumberOverlays","showExtraTiles","zoomScroll","zoomPlusClick","zoomMinusClick","handleDrop","handleTouchMove","handleTouchEnd","$mapContainer","$tiMap","onpopstate","onresize","document","addEventListener","removeEventListener","innerWidth","documentElement","setProperty","url","URL","settings","searchParams","get","current","newEncodedOptions","isNewGeneration","newSliceData","params","history","pushState","newOptionsMenuState","optionsSize","showTiles","numOverlay","hide","justTriggeredTiles","justTriggeredInfo","systemSelector","overlaySelector","Date","now","ctrlKey","deltaY","numberOnly","result","exec","mapVisible","mapControlsVisible","mapNumberTilesHeight","mapNumberTilesWidth","mapWidth","mapHeight","tileWidth","tileHeight","constraintWidth","constraintHeight","offsets","leftWidth","topHeight","halfWidth","ceil","halfHeight","treQuarWidth","calculateOffsets","currentPlayerNumber","tileWrapper","underlay","html","scrollIntoView","behavior","block","inline","ev","targetSelector","targetUnderlay","dataTransfer","setData","fromId","getData","targetId","fromSelector","targetType","fromType","targetSecond","fromSecond","tilesCopy","swapSources","temp","attr","targetSource","from","item","changedTouch","changedTouches","elem","elementFromPoint","clientX","clientY","stopPropagation","ref","effect","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.a73cdef9.chunk.js","sourcesContent":["import React from \"react\";\r\n\r\n/**\r\n * Scripts for bootstrap and jquery integration.\r\n */\r\nclass BootstrapScripts extends React.Component {\r\n    render() {\r\n        return (\r\n            <div id=\"bootstrapScripts\">\r\n                <script src=\"https://code.jquery.com/jquery-3.3.1.min.js\"\r\n                         integrity=\"sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=\"\r\n                         crossOrigin=\"anonymous\" />\r\n                <script src=\"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js\"\r\n                        integrity=\"sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1\"\r\n                        crossOrigin=\"anonymous\" />\r\n                <script src=\"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js\"\r\n                        integrity=\"sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM\"\r\n                        crossOrigin=\"anonymous\" />\r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default BootstrapScripts;","export default __webpack_public_path__ + \"static/media/influence.d1f8e76f.png\";","export default __webpack_public_path__ + \"static/media/planet.7203e647.png\";","export default __webpack_public_path__ + \"static/media/resource.4e66e6d4.png\";","export default __webpack_public_path__ + \"static/media/specialty-biotic.683b8aa5.png\";","export default __webpack_public_path__ + \"static/media/specialty-warfare.222674a3.png\";","export default __webpack_public_path__ + \"static/media/specialty-propulsion.767d15a0.png\";","export default __webpack_public_path__ + \"static/media/specialty-cybernetic.16601911.png\";","export default __webpack_public_path__ + \"static/media/trait-cultural.800b2f56.png\";","export default __webpack_public_path__ + \"static/media/trait-hazardous.64956721.png\";","export default __webpack_public_path__ + \"static/media/trait-industrial.37a31434.png\";","import React from \"react\";\r\nimport adjacencyData from \"../data/adjacencyData.json\";\r\nimport tileData from \"../data/tileData.json\";\r\nimport boardData from \"../data/boardData.json\";\r\n\r\nimport influence from './icons/influence.png';\r\nimport planet from './icons/planet.png';\r\nimport resource from './icons/resource.png';\r\nimport specialtyBiotic from './icons/specialty-biotic.png';\r\nimport specialtyWarfare from './icons/specialty-warfare.png';\r\nimport specialtyPropulsion from './icons/specialty-propulsion.png';\r\nimport specialtyCybernetic from './icons/specialty-cybernetic.png';\r\nimport traitCultural from './icons/trait-cultural.png';\r\nimport traitHazardous from './icons/trait-hazardous.png';\r\nimport traitIndustrial from './icons/trait-industrial.png';\r\n\r\nclass MoreInfo extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.getAdjacent = this.getAdjacent.bind(this);\r\n    }\r\n\r\n    getAdjacent(tileNumber) {\r\n        // TODO rewrite this to calculate adjacencies, not reference them from a data file\r\n        let originalAdjacencies = [...adjacencyData[tileNumber]];\r\n        let adjacencies = [...adjacencyData[tileNumber]];\r\n        // adjacencies.push(tileNumber);  // Add back in if we want to add the home system to these calcs\r\n\r\n        let planets = 0;\r\n        let resources = 0;\r\n        let influence = 0;\r\n        let specialties = {\r\n            \"biotic\": 0,\r\n            \"warfare\": 0,\r\n            \"propulsion\": 0,\r\n            \"cybernetic\": 0\r\n        };\r\n        let traits = {\r\n            \"cultural\": 0,\r\n            \"industrial\": 0,\r\n            \"hazardous\": 0\r\n        }\r\n\r\n        while (adjacencies.length > 0) {\r\n            let adjacentTileNumber = adjacencies.splice(0, 1)[0]\r\n            let adjacentTile = this.props.tiles[adjacentTileNumber]\r\n            if (tileData.hyperlanes.indexOf(this.props.getTileNumber(adjacentTile)) >= 0) {\r\n                // This is a hyperlane, so add the tiles that are linked\r\n                let hyperlaneAdjacencies = [...adjacencyData[adjacentTileNumber]];\r\n                let tilePositionRelatedToHyperlane = hyperlaneAdjacencies.indexOf(Number(tileNumber)); // In the future this code can be adapted, with this tile number being the source tile\r\n                let hyperlaneLinks = tileData.all[this.props.getTileNumber(adjacentTile)][\"hyperlanes\"];\r\n                let currentRotation = Number(adjacentTile.split(\"-\")[1])\r\n\r\n                for (let hyperlane of hyperlaneLinks) {\r\n                    let hyperlaneStart = (hyperlane[0] + currentRotation) % 6;\r\n                    let hyperlaneEnd = (hyperlane[1] + currentRotation) % 6;\r\n                    let hyperlaneStartTilenumber = hyperlaneAdjacencies[hyperlaneStart]\r\n                    let hyperlaneEndTilenumber = hyperlaneAdjacencies[hyperlaneEnd]\r\n\r\n                    if (hyperlaneStart === tilePositionRelatedToHyperlane && originalAdjacencies.indexOf(hyperlaneEndTilenumber) < 0) {\r\n                        // Add the tile on the other end of this hyperlane to be added to the total\r\n                        adjacencies.push(hyperlaneEndTilenumber)\r\n                    } else if (hyperlaneEnd === tilePositionRelatedToHyperlane && originalAdjacencies.indexOf(hyperlaneStartTilenumber) < 0) {\r\n                        // Add the tile on the other end of this hyperlane to be added to the total\r\n                        adjacencies.push(hyperlaneStartTilenumber)\r\n                    }\r\n                }\r\n            }\r\n            if (adjacentTile > 0) {\r\n                for (let planetIndex in tileData.all[adjacentTile][\"planets\"]) {\r\n                    let planet = tileData.all[adjacentTile][\"planets\"][planetIndex];\r\n                    planets += 1;\r\n                    resources += planet[\"resources\"];\r\n                    influence += planet[\"influence\"];\r\n                    specialties[planet[\"specialty\"]] += 1;\r\n                    traits[planet[\"trait\"]] += 1;\r\n                }\r\n            }\r\n        }\r\n        return {\r\n            \"planets\": planets,\r\n            \"resources\": resources,\r\n            \"influence\": influence,\r\n            \"specialties\": specialties,\r\n            \"traits\": traits,\r\n        }\r\n    }\r\n\r\n    render() {\r\n        let moreInfoByPlayer = [];\r\n\r\n        for (let tileNumber in this.props.tiles) {\r\n            if ((this.props.tiles[tileNumber] >= 0 && this.props.tiles[tileNumber] < 18) ||\r\n                (this.props.tiles[tileNumber] >= 51 && this.props.tiles[tileNumber] < 59)) {\r\n                // This is a homeworld, so gather its info\r\n                let adjacentInfo = this.getAdjacent(tileNumber);\r\n                let playerName = this.props.currentPlayerNames[moreInfoByPlayer.length];\r\n                if (playerName === \"\") {\r\n                    playerName = \"P\" + (moreInfoByPlayer.length + 1);\r\n                }\r\n                moreInfoByPlayer.push(\r\n                    <tr key={\"more-info-\" + playerName} >\r\n                        <th scope=\"row\">{playerName}</th>\r\n                        <td>{adjacentInfo.resources}</td>\r\n                        <td>{adjacentInfo.influence}</td>\r\n                        <td>\r\n                            <span className={\"d-flex\"}>\r\n                                {[...Array(adjacentInfo.traits.cultural)].map((e, i) => <img key={playerName + \"-cultural-\" + i} className={\"icon\"} src={traitCultural} alt={\"C\"}/>)}\r\n                                {[...Array(adjacentInfo.traits.hazardous)].map((e, i) => <img key={playerName + \"-hazardous-\" + i} className={\"icon\"} src={traitHazardous} alt={\"H\"}/>)}\r\n                                {[...Array(adjacentInfo.traits.industrial)].map((e, i) => <img key={playerName + \"-industrial-\" + i} className={\"icon\"} src={traitIndustrial} alt={\"I\"}/>)}\r\n                            </span>\r\n                        </td>\r\n                        <td>\r\n                            <span className={\"d-flex\"}>\r\n                                {[...Array(adjacentInfo.specialties.biotic)].map((e, i) => <img key={playerName + \"-biotic-\" + i} className={\"icon\"} src={specialtyBiotic} alt={\"B\"}/>)}\r\n                                {[...Array(adjacentInfo.specialties.warfare)].map((e, i) => <img key={playerName + \"-warfare-\" + i} className={\"icon\"} src={specialtyWarfare} alt={\"W\"}/>)}\r\n                                {[...Array(adjacentInfo.specialties.propulsion)].map((e, i) => <img key={playerName + \"-propulsion-\" + i} className={\"icon\"} src={specialtyPropulsion} alt={\"P\"}/>)}\r\n                                {[...Array(adjacentInfo.specialties.cybernetic)].map((e, i) => <img key={playerName + \"-cybernetic-\" + i} className={\"icon\"} src={specialtyCybernetic} alt={\"C\"}/>)}\r\n                            </span>\r\n                        </td>\r\n                    </tr>\r\n                );\r\n            }\r\n\r\n        }\r\n\t\t\r\n\t\t//let fullSliceData = this.getSliceData();\r\n\t\tlet fullSliceData = this.props.sliceData;\r\n\t\tlet playerSliceDataString = [];\r\n\t\t\r\n\t\tif (fullSliceData != null && fullSliceData != undefined && fullSliceData.length > 0) {\r\n\t\t\tfor (let j = 0; j < fullSliceData.length; j++){\r\n\t\t\t\t\r\n\t\t\t\tplayerSliceDataString.push(\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<th scope=\"row\">{fullSliceData[j].Player}</th>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].SliceWeight}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].EQWeight}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].HSWeight}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].TotalWeight}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].PlayerWeight}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].HomeTile}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].Slice.toString()}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].Equidistant.toString()}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].SliceTiles.toString()}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].HomeResources}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].HomeInfluence}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].HomePlanets}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].HomeSpecialties}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].HomeWormholes}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].SliceResources}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].SliceInfluence}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].SlicePlanets}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].SliceSpecialties}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].SliceWormholes}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].SliceAnomalies}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].EQResources}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].EQInfluence}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].EQPlanets}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].EQSpecialties}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].EQWormholes}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].EQAnomalies}</td>\r\n\t\t\t\t\t</tr>\r\n\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n        return (\r\n            <div id=\"moreInfoContainer\" className={this.props.visible ? \"\" : \"d-none\"}>\r\n                <div className=\"title\">\r\n                    <h4 id=\"infoTitle\" className=\"text-center\">Assets Adjacent to Home System</h4>\r\n                </div>\r\n                <div id=\"moreInfo\" className=\"\">\r\n                    <table className=\"table\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th scope=\"col\"></th>\r\n                                <th scope=\"col\"><img className={\"icon\"} src={resource} alt={\"Res.\"}/></th>\r\n                                <th scope=\"col\"><img className={\"icon\"} src={influence} alt={\"Inf.\"}/></th>\r\n                                <th scope=\"col\"><img className={\"icon\"} src={planet} alt={\"Planets\"}/></th>\r\n                                <th scope=\"col\"><img className={\"icon\"} src={specialtyWarfare} alt={\"Tech\"}/></th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {moreInfoByPlayer}\r\n                        </tbody>\r\n                    </table>\r\n\t\t\t\t\t<table className=\"table\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th scope=\"col\"></th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"Slice Weight\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"Equid Weight\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"HS Weight\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"Total Weight\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"Player Weight\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"HS Index\"}</th>\r\n                                <th scope=\"col\">{\"Slice Indexes\"}</th>\r\n                                <th scope=\"col\">{\"EquiDist Indexes\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"Slice Tiles\"}</th>\r\n                                <th scope=\"col\">{\"HS RES\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"HS INF\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"HS Planets\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"HS Specialties\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"HS Wormholes\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"Slice RES\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"Slice INF\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"Slice Planets\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"Slice Specialties\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"Slice Wormholes\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"Slice Anomalies\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"EquiDist RES\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"EquiDist INF\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"EquiDist Planets\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"EquiDist Specialties\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"EquiDist Wormholes\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"EquiDist Anomalies\"}</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {playerSliceDataString}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default MoreInfo;\r\n","import React from \"react\";\r\nimport tileData from \"../data/tileData.json\";\r\n\r\nclass ExtraTiles extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.underlayStyle = {\r\n            width: \"210px\",\r\n            height: \"185px\",\r\n            position: \"absolute\",\r\n            top: \"0\",\r\n            left: \"0\",\r\n        }\r\n        this.tileStyle = {\r\n            width: \"200px\",\r\n            height: \"175px\",\r\n            display: \"none\",\r\n            margin: \"5px\",\r\n            position: \"relative\",\r\n        }\r\n        this.overlayStyle = {\r\n            height: \"175px\",\r\n            marginLeft: \"92px\",\r\n            top: \"85px\",\r\n            display: \"none\",\r\n        }\r\n    }\r\n    \r\n    render() {\r\n        let systemNumbers = [];\r\n        systemNumbers = systemNumbers.concat(tileData.blue).concat(tileData.red);\r\n        if (this.props.useProphecyOfKings || this.props.showAllExtraTiles || this.props.customMapBuilding) {\r\n            systemNumbers = systemNumbers.concat(tileData.pokBlue).concat(tileData.pokRed);\r\n        }\r\n        if (this.props.customMapBuilding) {\r\n            systemNumbers = [-1].concat(systemNumbers.concat(tileData.hyperlanes));\r\n        }\r\n\r\n        const tileObjects = []\r\n        for (let systemNumber of systemNumbers) {\r\n\r\n            // Handle hyperlanes differently. Pull out their tile number, separate from their rotation angle\r\n            if (isNaN(Number(systemNumber)) && systemNumber !== undefined) {\r\n                systemNumber = systemNumber.split(\"-\")[0]\r\n            }\r\n\r\n            tileObjects.push(\r\n                <div key={\"extra-tile-wrapper-\" + systemNumber} className=\"tile-wrapper\">\r\n                    <span id={\"extra-number-\" + systemNumber} className={\"overlay\" + (this.props.overlayVisible ? \"\" : \" d-none\")} style={this.overlayStyle}>{systemNumber === -1 ? \"Empty\" : systemNumber}</span>\r\n                    <img id={\"extra-\" + systemNumber}\r\n                         width=\"200px\"\r\n                         height=\"175px\"\r\n                         className=\"tile\"\r\n                         src={window.location.origin + window.location.pathname + \"/tiles/ST_\" + systemNumber + \".png\"}\r\n                         draggable=\"true\" onDragStart={this.props.drag} onDrop={this.props.drop}\r\n                         onDragOver={this.props.allowDrop} onDragEnter={this.props.dragEnter}\r\n                         onDragLeave={this.props.dragLeave}\r\n                         alt=\"\"\r\n                         style={this.tileStyle}\r\n                    />\r\n                    <svg id={\"extra-underlay-\" + systemNumber} xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 359.35 311.21\" className=\"underlay\" fill=\"currentColor\"\r\n                         style={this.underlayStyle}>\r\n                        <polygon points=\"269.51 0 89.84 0 0 155.6 89.84 311.2 269.51 311.2 359.35 155.6 269.51 0\" />\r\n                    </svg>\r\n                </div>\r\n            )\r\n        }\r\n    \r\n        return (\r\n            <div id=\"extraTilesContainer\" className={this.props.visible ? \"\" : \"d-none\"}>\r\n                <div className=\"title\">\r\n                    <h4 id=\"extraTitle\" className=\"text-center\">Extra Tiles</h4>\r\n                </div>\r\n\r\n                <div className=\"custom-control custom-checkbox mt-3 ml-3 mr-3 text-center\">\r\n                    <input type=\"checkbox\" className=\"custom-control-input\" id=\"showAllExtraTiles\" name=\"showAllExtraTiles\" checked={this.props.showAllExtraTiles} onChange={this.props.toggleShowAllExtraTiles} />\r\n                    <label className=\"custom-control-label\" htmlFor=\"showAllExtraTiles\">Show All Tiles</label>\r\n                </div>\r\n\r\n                <div className=\"custom-control custom-checkbox mt-3 ml-3 mr-3 text-center\">\r\n                    <input type=\"checkbox\" className=\"custom-control-input\" id=\"customMapBuilding\" name=\"customMapBuilding\" checked={this.props.customMapBuilding} onChange={this.props.toggleCustomMapBuilding} />\r\n                    <label className=\"custom-control-label\" htmlFor=\"customMapBuilding\">Custom Map Building</label>\r\n                </div>\r\n\r\n                <div id=\"extraTiles\" className=\"\">\r\n                    {tileObjects}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default ExtraTiles;","import React from \"react\";\r\nimport {ArrowRepeat, Check, Share, Lock, X} from \"react-bootstrap-icons\";\r\n\r\nclass MainOverview extends React.Component {\r\n    render() {\r\n        return (\r\n            <div id=\"overview\" className={\"flex-column justify-content-center\" + (this.props.visible ? \" d-flex\" : \" d-none\")}>\r\n                <div className=\"title\">\r\n                    <h1>TI4 Map Generator</h1>\r\n                </div>\r\n\r\n                <div className={\"overview-panel mb-4 mt-4 ml-auto mr-auto\"}>\r\n                    <h4 className={\"m-3\"}>Customize Your Next Twilight Imperium 4 Map!</h4>\r\n                    <div className={\"d-flex\"}>\r\n                        <p className={\"text-left p-3\"}>\r\n                            Use this tool to generate a fresh new Twilight Imperium map for the next game you play. The\r\n                            goal of this tool is to cut down the game setup time by letting you generate a fair and balanced map\r\n                            before you play, so that you are not spending a half-hour picking and placing tiles, or getting a bad draw of tiles. Get started\r\n                            by customizing settings via the generation panel on the right, and hit \"Generate\" to see a new\r\n                            map.\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className={\"overview-panel mb-4 mt-4 ml-auto mr-auto\"}>\r\n                    <h4 className={\"m-3\"}>Individual Tile Controls</h4>\r\n                    <div className={\"d-flex\"}>\r\n                        <p className={\"text-left p-3\"}>\r\n                            Modify individual tiles by clicking on them to pull up the tile control menu. Lock the tile in place\r\n                            with the (\r\n                            <Lock className=\"icon d-inline\" />\r\n                            ) button. Include it in all future generations with the (\r\n                            <Check className=\"icon d-inline\" />\r\n                            ) button. Exclude it from all future generations with the (\r\n                            <X className=\"icon d-inline\" />\r\n                            ) button. Finally, swap it with a tile not on the board with the (\r\n                            <ArrowRepeat className=\"icon d-inline\" />\r\n                            ) button. Controls reset on page refresh.\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className={\"overview-panel mb-4 mt-4 ml-auto mr-auto\"}>\r\n                    <h4 className={\"m-3\"}>Drag and Drop for Further Customization</h4>\r\n                    <div className={\"d-flex\"}>\r\n                        <p className={\"text-left p-3\"}>\r\n                            Unhappy with a wormhole next to a home world? Are two asteroids next to one another? Don't like\r\n                            a certain system? Just swap it with another tile by clicking and dragging one tile over the top of\r\n                            another tile. Alternatively, use the tile controls (click on a tile once to see them) and click\r\n                            the bottom middle \"Swap with an extra tile\" button (\r\n                            <ArrowRepeat className=\"icon d-inline\" />\r\n                            ) to swap with a tile not on the board.\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className={\"overview-panel mb-4 mt-4 ml-auto mr-auto\"}>\r\n                    <h4 className={\"m-3\"}>New Prophecy of Kings Expansion Content</h4>\r\n                    <div className={\"d-flex\"}>\r\n                        <p className={\"text-left p-3\"}>\r\n                            The new expansion content for TI4, called Prophecy of Kings, was recently released. Check out\r\n                            the new tiles as well as the 7 and 8 player maps. Hyperlanes which connect systems together\r\n                            were also added, and are included on some non expansion board styles.\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className={\"overview-panel mb-4 mt-4 ml-auto mr-auto\"}>\r\n                    <h4 className={\"m-3\"}>Share With Your Friends</h4>\r\n                    <div className={\"d-flex\"}>\r\n                        <p className={\"text-left p-3\"}>\r\n                            After you have made your custom map, click on the \"Share This Map\" button (\r\n                            <Share className=\"icon d-inline\" />\r\n                            ) to find out how to send it to your friends! You can share the url as a link, copy the\r\n                            Table Top Simulator string to use in the TI4 mod, or simply download an image of the map\r\n                            to post. If you toggle the tile overlay on, you can have the tile numbers appear in your\r\n                            downloaded image.\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className={\"overview-panel mb-4 mt-4 ml-auto mr-auto\"}>\r\n                    <h4 className={\"m-3\"}>Use Any Tile You Want</h4>\r\n                    <div className={\"d-flex\"}>\r\n                        <p className={\"text-left p-3\"}>\r\n                            Do you really like the gravity rift anomaly and not see it on the board? Click the \"Show unused\r\n                            tiles\" button (\r\n                            <svg id=\"showExtraTilesSvg\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 359.35 311.21\" className=\"icon d-inline\" fill=\"currentColor\">\r\n                                <polygon id=\"showExtraTilesPoly\" points=\"269.51 0 89.84 0 0 155.6 89.84 311.2 269.51 311.2 359.35 155.6 269.51 0\" />\r\n                            </svg>\r\n                            ) to see any tiles not currently being used in the map, and drag and drop them to add them!\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className={\"overview-panel mb-4 mt-4 ml-auto mr-auto\"}>\r\n                    <h4 className={\"m-3\"}>Easy Setup On Game Day</h4>\r\n                    <div className={\"d-flex\"}>\r\n                        <p className={\"text-left p-3\"}>\r\n                            It can be hard to know which tile is which when it is time to setup your new board. Click the\r\n                            \"Toggle Tile Number Overlay\" button (\r\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 194.78 169.62\" className=\"icon d-inline\" fill=\"currentColor\">\r\n                                <polygon className=\"overlay-cls-1\" points=\"148.03 4 51.81 4 4.61 86.92 52.02 169.84 148.03 169.84 195.03 86.92 148.03 4\"/>\r\n                                <text className=\"overlay-cls-2\" transform=\"translate(27.09 132.03)\">18</text>\r\n                            </svg>\r\n                            )\r\n                             to see the numbers of every tile on your custom board.\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className={\"overview-panel mb-4 mt-4 ml-auto mr-auto\"}>\r\n                    <h4 className={\"m-3\"}>Have Any Ideas On Improvements?</h4>\r\n                    <div className={\"d-flex\"}>\r\n                        <p className={\"text-left p-3\"}>\r\n                            I am always open to feedback and suggestions! You can see\r\n                            the <a href=\"https://github.com/KeeganW/ti4/issues\">current set of issues</a> with the generator, or if\r\n                            you don't see your issue or want to suggest a new feature, add\r\n                            it <a href=\"https://github.com/KeeganW/ti4/issues/new\">to my issue tracker</a>. Thanks for checking\r\n                            this out!\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className={\"overview-panel mb-4 mt-4 ml-auto mr-auto\"}>\r\n                    &#169; Keegan Williams 2021\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default MainOverview;","import React from \"react\";\r\nimport './MainMap.css';\r\nimport boardData from \"../data/boardData.json\";\r\nimport raceData from \"../data/raceData.json\";\r\nimport {Arrow90degLeft, Arrow90degRight, ArrowRepeat, Check, Lock, X} from \"react-bootstrap-icons\";\r\nimport ReactTooltip from \"react-tooltip\";\r\nimport $ from \"jquery\";\r\n\r\nclass MainMap extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.toggleControls = this.toggleControls.bind(this);\r\n        this.getRotationDegrees = this.getRotationDegrees.bind(this);\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        ReactTooltip.rebuild();\r\n    }\r\n\r\n    toggleControls(event) {\r\n        const splitArray = event.target.id.split(\"-\")\r\n        const targetName = splitArray[0];\r\n        const tileNumber = Number(splitArray[splitArray.length - 1]);\r\n        const systemNumber = this.props.getTileNumber(this.props.tiles[tileNumber]);\r\n\r\n        if (targetName === \"tile\") {\r\n            let newTileClicked = -1;\r\n            \r\n            // Ensure that the tile is a different tile, and it is not an empty tile\r\n            if (this.props.tileClicked !== tileNumber && systemNumber !== -1 && systemNumber !== 0) {\r\n                newTileClicked = tileNumber;\r\n            }\r\n            this.props.updateTileClicked(newTileClicked);\r\n        } else if (targetName === \"rotate\") {\r\n            const rotationDirection = splitArray[1];\r\n            let tile = $(\"#tile-\" + tileNumber);\r\n            let degrees = this.getRotationDegrees(tile);\r\n\r\n            if (rotationDirection === \"left\") {\r\n                degrees -= 60;\r\n            } else if (rotationDirection === \"right\") {\r\n                degrees += 60;\r\n            }\r\n            if (degrees < 0) degrees += 360\r\n            let rotationAngle = (degrees/60) % 6\r\n\r\n            let newTiles = [...this.props.tiles];\r\n            newTiles[tileNumber] = this.props.getTileNumber(newTiles[tileNumber]) + \"-\" + rotationAngle;\r\n            this.props.updateTiles(newTiles)\r\n\r\n            tile.css({'transform' : 'rotate('+ degrees +'deg)'});\r\n        } else if (targetName === \"swap\") {\r\n            if (this.props.unusedTiles.length > 0) {\r\n                // Get new tile to update\r\n                const randomUnusedTile = this.props.unusedTiles[Math.floor(Math.random() * this.props.unusedTiles.length)];\r\n\r\n                // Update tiles\r\n                let newTiles = [...this.props.tiles];\r\n                newTiles[tileNumber] = randomUnusedTile;\r\n                this.props.updateTiles(newTiles)\r\n            }\r\n\r\n        } else if (targetName === \"lock\") {\r\n            // Get tile location in locked tiles list\r\n            let lockedIndex = this.props.lockedTiles.indexOf(systemNumber);\r\n            let newLockedTiles = this.props.lockedTiles;\r\n\r\n            // Either remove it or add it, depending on if it is there already or not\r\n            if (lockedIndex >= 0) {\r\n                newLockedTiles.splice(lockedIndex, 1);\r\n            } else {\r\n                newLockedTiles.push(systemNumber);\r\n            }\r\n\r\n            this.props.updateLockedTiles(newLockedTiles)\r\n        } else if (targetName === \"exclude\") {\r\n            // Get tile location in locked tiles list\r\n            let excludedIndex = this.props.excludedTiles.indexOf(systemNumber);\r\n            let newExcludedTiles = this.props.excludedTiles;\r\n            let newIncludedTiles = this.props.includedTiles;\r\n\r\n            // Either remove it or add it, depending on if it is there already or not\r\n            if (excludedIndex >= 0) {\r\n                newExcludedTiles.splice(excludedIndex, 1);\r\n            } else {\r\n                newExcludedTiles.push(systemNumber);\r\n                // Check if is included. If so, remove it\r\n                let includedIndex = this.props.includedTiles.indexOf(systemNumber);\r\n                if (includedIndex >= 0) {\r\n                    newIncludedTiles.splice(includedIndex, 1);\r\n                }\r\n            }\r\n\r\n            // Update the list\r\n            this.props.updateInExcludedTiles(newIncludedTiles, newExcludedTiles)\r\n        } else if (targetName === \"include\") {\r\n            // Get tile location in locked tiles list\r\n            let includedIndex = this.props.includedTiles.indexOf(systemNumber);\r\n            let newIncludedTiles = this.props.includedTiles;\r\n            let newExcludedTiles = this.props.excludedTiles;\r\n\r\n            // Either remove it or add it, depending on if it is there already or not\r\n            if (includedIndex >= 0) {\r\n                newIncludedTiles.splice(includedIndex, 1);\r\n            } else {\r\n                newIncludedTiles.push(systemNumber);\r\n                // Check if is excluded. If so, remove it\r\n                let excludedIndex = this.props.excludedTiles.indexOf(systemNumber);\r\n                if (excludedIndex >= 0) {\r\n                    newExcludedTiles.splice(excludedIndex, 1);\r\n                }\r\n            }\r\n\r\n            // Update the list\r\n            this.props.updateInExcludedTiles(newIncludedTiles, newExcludedTiles)\r\n        }\r\n    }\r\n\r\n    getRotationDegrees(obj) {\r\n        let matrix = obj.css(\"-webkit-transform\") ||\r\n            obj.css(\"-moz-transform\")    ||\r\n            obj.css(\"-ms-transform\")     ||\r\n            obj.css(\"-o-transform\")      ||\r\n            obj.css(\"transform\");\r\n        let angle = 0;\r\n        if(matrix !== 'none') {\r\n            let values = matrix.split('(')[1].split(')')[0].split(',');\r\n            let a = values[0];\r\n            let b = values[1];\r\n            angle = Math.round(Math.atan2(b, a) * (180/Math.PI));\r\n        }\r\n\r\n        if(angle < 0) angle +=360;\r\n        return angle;\r\n    }\r\n\r\n    render() {\r\n        const mapTiles = []\r\n        const style = {position: \"absolute\"}\r\n        const hidden = {display: \"none\"}\r\n\r\n        // Loop over 0 to pok board size, and add in the tile objects to be displayed\r\n        for (let tileNumber = 0; tileNumber < boardData.pokSize; tileNumber++) {\r\n            let systemNumber = this.props.getTileNumber(this.props.tiles[tileNumber])\r\n\r\n\t\t\t//KSL hide race home tiles on the map if this parameter is checked\r\n\t\t\tif (this.props.hideRaceTiles) {\r\n\t\t\t\tlet homeworlds = raceData[\"homeSystems\"];\r\n\t\t\t\thomeworlds = homeworlds.concat(raceData[\"pokHomeSystems\"]);\r\n\t\t\t\tif (homeworlds.indexOf(systemNumber) > -1) {\r\n\t\t\t\t\t\t\tsystemNumber = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n            // Add the tile to the array of tiles to be displayed, if they are valid tiles\r\n            if (systemNumber !== undefined) {\r\n                mapTiles.push(\r\n                    <div key={\"tile-wrapper-\" + tileNumber} id={\"tile-wrapper-\" + tileNumber} className=\"tile-wrapper\" style={style} onClick={this.toggleControls}>\r\n                        <button id={\"rotate-left-\" + tileNumber} className={\"btn btn-primary tile-control rotate-left\" + (this.props.tileClicked === tileNumber ? \"\" : \" d-none\")} data-tip=\"Rotate tile left\" data-place=\"top\" >\r\n                            <Arrow90degLeft id={\"rotate-left-svg-\" + tileNumber} className={\"icon\"}/>\r\n                        </button>\r\n                        <button id={\"lock-\" + tileNumber} className={\"btn btn-primary tile-control lock\" + (this.props.tileClicked === tileNumber ? \"\" : \" d-none\") + (this.props.lockedTiles.indexOf(systemNumber) >= 0 ? \" active\" : \"\")} data-tip=\"Keep tile here on generation\" >\r\n                            <Lock id={\"lock-svg-\" + tileNumber} className={\"icon\"}/>\r\n                        </button>\r\n                        <button id={\"rotate-right-\" + tileNumber} className={\"btn btn-primary tile-control rotate-right\" + (this.props.tileClicked === tileNumber ? \"\" : \" d-none\")} data-tip={\"Rotate tile right\"} >\r\n                            <Arrow90degRight id={\"rotate-right-svg-\" + tileNumber} className={\"icon\"}/>\r\n                        </button>\r\n                        <span id={\"number-\" + tileNumber} className={\"overlay\"} style={hidden}>{tileNumber}</span>\r\n                        <img id={\"tile-\" + tileNumber}\r\n                             className=\"tile\"\r\n                             src={window.location.origin + window.location.pathname + \"/tiles/ST_\" + systemNumber + \".png\"}\r\n                             draggable=\"true\" onDragStart={this.props.drag} onDrop={this.props.drop} onDragOver={this.props.allowDrop} onDragEnter={this.props.dragEnter} onDragLeave={this.props.dragLeave} onTouchMove={this.props.touchMove} onTouchEnd={this.props.touchEnd}\r\n                             alt={\"Twilight Imperium 4 Tile Number \" + tileNumber + \" and System Number \" + systemNumber + \".\"}\r\n                        />\r\n                        <svg id={\"underlay-\" + tileNumber} xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 359.35 311.21\" className=\"underlay\" fill=\"currentColor\">\r\n                            <polygon points=\"269.51 0 89.84 0 0 155.6 89.84 311.2 269.51 311.2 359.35 155.6 269.51 0\" />\r\n                        </svg>\r\n                        <button id={\"exclude-\" + tileNumber} className={\"btn btn-primary tile-control exclude\" + (this.props.tileClicked === tileNumber ? \"\" : \" d-none\") + (this.props.excludedTiles.indexOf(systemNumber) >= 0 ? \" active\" : \"\")} data-tip={\"Exclude from generation\"} data-place=\"bottom\" >\r\n                            <X id={\"exclude-svg-\" + tileNumber} className={\"icon\"}/>\r\n                        </button>\r\n                        <button id={\"swap-\" + tileNumber} className={\"btn btn-primary tile-control swap\" + (this.props.tileClicked === tileNumber ? \"\" : \" d-none\")} data-tip={\"Swap with an extra tile\"} data-place=\"bottom\" >\r\n                            <ArrowRepeat id={\"swap-svg-\" + tileNumber} className={\"icon\"}/>\r\n                        </button>\r\n                        <button id={\"include-\" + tileNumber} className={\"btn btn-primary tile-control include\" + (this.props.tileClicked === tileNumber ? \"\" : \" d-none\") + (this.props.includedTiles.indexOf(systemNumber) >= 0 ? \" active\" : \"\")} data-tip={\"Always include in generation\"} data-place=\"bottom\" >\r\n                            <Check id={\"include-svg-\" + tileNumber} className={\"icon\"}/>\r\n                        </button>\r\n                    </div>\r\n                )\r\n            }\r\n        }\r\n        \r\n        return (\r\n            <div id=\"map\" className={\"map center-map \" + (this.props.visible ? \"\" : \"d-none\")}>\r\n                {mapTiles}\r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default MainMap;","import React from \"react\";\r\nimport Modal from \"react-bootstrap/Modal\";\r\nimport $ from 'jquery';\r\nimport {exportComponentAsPNG} from \"react-component-export-image\";\r\n\r\nclass ShareMapModal extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.getTTSTileString = this.getTTSTileString.bind(this);\r\n\t\tthis.getSliceDataTable = this.getSliceDataTable.bind(this);\r\n        this.copyTileStringToClipboard = this.copyTileStringToClipboard.bind(this);\r\n        this.copyLinkToClipboard = this.copyLinkToClipboard.bind(this);\r\n        this.removeTrailing = this.removeTrailing.bind(this);\r\n        this.sleep = this.sleep.bind(this);\r\n        this.downloadImage = this.downloadImage.bind(this);\r\n    }\r\n\r\n    /**\r\n     * Using writeText, copy the tiles currently being displayed to the user's clipboard.\r\n     * @returns {string} A string representing the tiles in the TTS format\r\n     */\r\n    getTTSTileString() {\r\n        // Get the current tiles\r\n        let tileString = [...this.props.tiles];\r\n        tileString = this.removeTrailing(tileString);\r\n\r\n        // Remove mecatol rex\r\n        tileString.shift();\r\n\r\n        tileString = tileString.toString();\r\n        tileString = tileString.replaceAll(\",-1\", \",0\");  // Remove the -1s because it is unused\r\n        tileString = tileString.replaceAll(\",\", \" \");  // Remove commas from old array\r\n        tileString = tileString.replaceAll(/(\\d+)-\\d/gm, \"$1\");  // Remove rotation for non hyperlanes\r\n        tileString = tileString.replaceAll(\"-\", \"\");  // Remove rotation dash in hyperlanes\r\n\r\n        return tileString\r\n    }\r\n\t\r\n\tgetSliceDataTable() {\r\n\t//let fullSliceData = this.getSliceData();\r\n\tdebugger;\r\n\t\tlet fullSliceData = this.props.sliceData;\r\n\t\tlet playerSliceDataString = [];\r\n\t\t\r\n\t\tif (fullSliceData != null && fullSliceData != undefined && fullSliceData.length > 0) {\r\n\t\t\tfor (let j = 0; j < fullSliceData.length; j++){\r\n\t\t\t\t\r\n\t\t\t\tplayerSliceDataString.push(\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<th scope=\"row\">{fullSliceData[j].Player}</th>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].SliceWeight}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].EQWeight}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].HSWeight}</td>\r\n\t\t\t\t\t\t<td>{fullSliceData[j].PlayerWeight}</td>\r\n\t\t\t\t\t</tr>\r\n\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn playerSliceDataString;\r\n\t}\r\n    /**\r\n     * Copies the TTS tile string to the clipboard\r\n     */\r\n    copyTileStringToClipboard() {\r\n        let tileString = this.getTTSTileString();\r\n        console.log(\"Here is the tile string for use with this mod: https://steamcommunity.com/sharedfiles/filedetails/?id=1288687076\")\r\n        console.log(tileString)\r\n        navigator.clipboard.writeText(tileString);\r\n    }\r\n\r\n    /**\r\n     * Copies the page link to the clipboard\r\n     */\r\n    copyLinkToClipboard() {\r\n        navigator.clipboard.writeText(window.location.href);\r\n    }\r\n\r\n    /**\r\n     * Removes any trailing -1s from a tile string.\r\n     * @param {number[]} tiles the tile string to clean\r\n     * @returns {number[]} the clean tile string\r\n     */\r\n    removeTrailing(tiles) {\r\n        while(tiles[tiles.length - 1] === -1){\r\n            tiles.pop();\r\n        }\r\n        return tiles;\r\n    }\r\n\r\n    /**\r\n     * Has the thread wait for a certain amount of time before continuing.\r\n     * @param ms The number of milliseconds before continuing\r\n     * @returns {Promise<unknown>} A timeout\r\n     */\r\n    sleep(ms) {\r\n        return new Promise(resolve => setTimeout(resolve, ms));\r\n    }\r\n\r\n    /**\r\n     * Downloads an image of the map to the user's computer.\r\n     * @returns {Promise<void>} null\r\n     */\r\n    async downloadImage() {\r\n        // Set the button as active to let the user know the action is still happening\r\n        $(\"#downloadMapButton\").addClass(\"active\")\r\n\r\n        // Scroll so that the image is centered properly\r\n        window.scrollTo(0, 0);\r\n\r\n        // Export as a png with a blank background. Scale so its not a giant file\r\n        await exportComponentAsPNG(this.props.map, {\r\n            fileName: \"ti4-map\",\r\n            html2CanvasOptions: {backgroundColor: null, scrollX: 0, scrollY: -window.pageYOffset, scale: 1.5}\r\n        })\r\n\r\n        // Wait a little bit, then un activate the button.\r\n        await this.sleep(750);\r\n        $(\"#downloadMapButton\").removeClass(\"active\")\r\n    }\r\n\r\n    render() {\r\n        let tileString = this.getTTSTileString();\r\n\t\tlet playerSliceDataString = this.getSliceDataTable();\r\n\t\t\r\n        return (\r\n            <Modal show={this.props.visible} onHide={this.props.hideModal}>\r\n                <Modal.Header closeButton>\r\n                    <Modal.Title>Share Map</Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    <div className=\"input-group mb-3\">\r\n                        <input type=\"text\" className=\"form-control\" value={window.location.href} readOnly\r\n                               aria-label=\"Recipient's username\" aria-describedby=\"basic-addon2\" />\r\n                        <div className=\"input-group-append\">\r\n                            <button className=\"btn btn-primary\" type=\"button\" onClick={this.copyLinkToClipboard}>Copy Link</button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"input-group mb-3\">\r\n                        <input type=\"text\" className=\"form-control\" value={tileString} readOnly\r\n                               aria-label=\"Recipient's username\" aria-describedby=\"basic-addon2\" />\r\n                        <div className=\"input-group-append\">\r\n                            <button className=\"btn btn-primary\" type=\"button\" onClick={this.copyTileStringToClipboard}>Copy TTS String</button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"input-group mb-3 justify-content-center\">\r\n                        <button id=\"downloadMapButton\" className=\"btn btn-primary\" type=\"button\" onClick={this.downloadImage}>Download Map Image</button>\r\n                    </div>\r\n\t\t\t\t\t<div className=\"KSL-slicedata\">\r\n\t\t\t\t\t<table className=\"table\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th scope=\"col\"></th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"Slice Weight\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"Equid Weight\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"HS Weight\"}</th>\r\n\t\t\t\t\t\t\t\t<th scope=\"col\">{\"Player Weight\"}</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {playerSliceDataString}\r\n                        </tbody>\r\n                    </table>\r\n\t\t\t\t\t</div>\r\n                </Modal.Body>\r\n            </Modal>\r\n        );\r\n    }\r\n}\r\nexport default ShareMapModal;","import React from \"react\";\r\nimport {CardImage, Dash, InfoCircle, Plus, Share} from \"react-bootstrap-icons\";\r\nimport ShareMapModal from \"./ShareMapModal\";\r\n\r\nclass MapControls extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            shareMapHelp: false\r\n        }\r\n\r\n        this.toggleShareMapHelp = this.toggleShareMapHelp.bind(this);\r\n    }\r\n\r\n    /**\r\n     * Toggle the modal for the sharing page.\r\n     * @param event The event trigger for the toggle.\r\n     */\r\n    toggleShareMapHelp(event) {\r\n        this.setState({\r\n            shareMapHelp: !this.state.shareMapHelp\r\n        })\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div id={\"map-controls\"}>\r\n                <div id=\"zoomButtons\" className={\"btn-group-justified btn-group-sm btn-group-vertical\" + (this.props.visible ? \"\" : \" d-none\")}>\r\n                    <button className=\"btn btn-primary\" id=\"zoomPlus\" onClick={this.props.zoomPlus} data-tip=\"Or Hold CTRL and Use Scroll Wheel\" data-place=\"left\" >\r\n                        <Plus className=\"icon\" />\r\n                    </button>\r\n                    <button className=\"btn btn-primary\" id=\"zoomMinus\" onClick={this.props.zoomMinus}>\r\n                        <Dash className=\"icon\" />\r\n                    </button>\r\n                </div>\r\n    \r\n                <div id=\"hexOverlay\" className={\"btn-group-justified btn-group-sm\" + (this.props.visible ? \"\" : \" d-none\")} onClick={this.props.toggleOverlay}>\r\n                    <button className={\"btn btn-primary\" + (this.props.overlayVisible ? \" active\": \"\")} id=\"showHexOverlay\" data-tip=\"Tile Number Overlay\" data-place=\"left\" >\r\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 194.78 169.62\" className=\"icon\" fill=\"currentColor\">\r\n                            <polygon className=\"overlay-cls-1\" points=\"148.03 4 51.81 4 4.61 86.92 52.02 169.84 148.03 169.84 195.03 86.92 148.03 4\"/>\r\n                            <text className=\"overlay-cls-2\" transform=\"translate(27.09 132.03)\">18</text>\r\n                        </svg>\r\n                    </button>\r\n                </div>\r\n    \r\n                <div id=\"extraTilesButton\" className={\"btn-group-justified btn-group-sm\" + (this.props.visible ? \"\" : \" d-none\")} onClick={this.props.toggleExtraTiles}>\r\n                    <button className={\"btn btn-primary\" + (this.props.extraTilesVisible ? \" active\": \"\")} id=\"showExtraTiles\" data-tip=\"Unused Tiles\" data-place=\"left\" >\r\n                        <svg id=\"showExtraTilesSvg\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 359.35 311.21\" className=\"icon\" fill=\"currentColor\">\r\n                            <polygon id=\"showExtraTilesPoly\" points=\"269.51 0 89.84 0 0 155.6 89.84 311.2 269.51 311.2 359.35 155.6 269.51 0\" />\r\n                        </svg>\r\n                    </button>\r\n                </div>\r\n\r\n                <div id=\"moreInfoButton\" className={\"btn-group-justified btn-group-sm\" + (this.props.visible ? \"\" : \" d-none\")} onClick={this.props.toggleMoreInfo}>\r\n                    <button className={\"btn btn-primary\" + (this.props.moreInfoVisible ? \" active\": \"\")} id=\"showMoreInfo\" data-tip=\"Assets Adjacent to Home\" data-place=\"left\" >\r\n                        <InfoCircle id=\"showMoreInfoSvg\" className=\"icon\" />\r\n                    </button>\r\n                </div>\r\n\r\n                <div id=\"shareMapButton\" className={\"btn-group-justified btn-group-sm\" + (this.props.visible ? \"\" : \" d-none\")} onClick={this.toggleShareMapHelp}>\r\n                    <button className={\"btn btn-primary\"} id=\"shareMapInfo\" data-tip=\"Share This Map\" data-place=\"left\" >\r\n                        <Share id=\"shareMapSvg\" className=\"icon\" />\r\n                    </button>\r\n                </div>\r\n\r\n                <ShareMapModal visible={this.state.shareMapHelp} hideModal={this.toggleShareMapHelp}\r\n                               tiles={this.props.tiles} map={this.props.map} sliceData={this.props.sliceData}\r\n                />\r\n\r\n                <div id=\"toggleBackgroundButton\" className={\"btn-group-justified btn-group-sm\"} onClick={this.props.toggleBackground}>\r\n                    <button className={\"btn btn-primary\"} id=\"toggleBackground\" data-tip=\"Toggle Background Animation\">\r\n                        <CardImage id=\"toggleBackgroundSvg\" className=\"icon\" />\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default MapControls;","import React from \"react\";\r\nimport {ArrowBarLeft, ArrowBarRight} from \"react-bootstrap-icons\";\r\n\r\nclass OptionsControls extends React.Component {\r\n    render() {\r\n        return (\r\n            <div className=\"controls btn-group-justified btn-group-sm\">\r\n                <button type=\"button\" id=\"toggleOptions\" className={\"btn btn-primary\" + (this.props.visible ? \"\" : \" hidden\") + (this.props.isMobileView ? \" full-screen\" : \"\")} onClick={this.props.toggleOptions}>\r\n                    <ArrowBarRight className={\"icon icon-contract\"} />\r\n                    <ArrowBarLeft className={\"icon icon-expand\"} />\r\n                </button>\r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default OptionsControls;","import React from \"react\";\r\nimport Modal from \"react-bootstrap/Modal\";\r\n\r\nclass HelpModal extends React.Component {\r\n    render() {\r\n        return (\r\n            <Modal show={this.props.visible} onHide={this.props.hideModal}>\r\n                <Modal.Header closeButton>\r\n                    <Modal.Title>{this.props.title}</Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    <div dangerouslySetInnerHTML={{__html: this.props.content}} />\r\n                </Modal.Body>\r\n            </Modal>\r\n        );\r\n    }\r\n}\r\nexport default HelpModal;","import React from \"react\";\r\nimport Modal from \"react-bootstrap/Modal\";\r\n\r\nclass SetPlayerNameModal extends React.Component {\r\n    render() {\r\n        return (\r\n            <Modal show={this.props.visible} onHide={this.props.hideModal}>\r\n                <Modal.Header closeButton>\r\n                    <Modal.Title>Set Player Names</Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    <form id={\"playerNameForm\"}>\r\n                        {this.props.currentPlayerNames.map((x, i) => {\r\n                            return (\r\n                                <div className={\"form-group\"} key={\"set-names-\" + i}>\r\n                                    <label htmlFor={\"player\" + (i+1) + \"Name\"}>Player {(i+1)}</label>\r\n                                    <input className={\"form-control\"} name={\"playerName\" + i} type={\"text\"} placeholder={\"P\" + (i+1)} defaultValue={x} onChange={this.props.handleNameChange} />\r\n                                </div>\r\n                            )\r\n                        })}\r\n                    </form>\r\n\r\n\r\n                </Modal.Body>\r\n            </Modal>\r\n        );\r\n    }\r\n}\r\nexport default SetPlayerNameModal;","import React from \"react\";\r\nimport Modal from \"react-bootstrap/Modal\";\r\n\r\nclass SetRacesModal extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            searchString: \"\"\r\n        }\r\n\r\n        this.updateSearchString = this.updateSearchString.bind(this);\r\n    }\r\n\r\n    updateSearchString(event) {\r\n        this.setState({\r\n            searchString: event.target.value,\r\n        })\r\n    }\r\n\r\n    render() {\r\n        let visibleRaces = this.props.races\r\n        if (this.props.useProphecyOfKings) {\r\n            visibleRaces = visibleRaces.concat(this.props.pokRaces)\r\n        }\r\n\r\n        let breakStyle = {\r\n            \"border-bottom\": \"1px solid #dee2e6\"\r\n        }\r\n\r\n        return (\r\n            <Modal show={this.props.visible} onHide={this.props.hideModal}>\r\n                <Modal.Header closeButton>\r\n                    <Modal.Title>Set Races</Modal.Title>\r\n                </Modal.Header>\r\n                <div style={breakStyle} >\r\n                    <button type=\"button\" name={\"all\"} className=\"btn btn-outline-primary m-2 ml-3\" onClick={this.props.handleRacesChange}>Select All</button>\r\n                    <button type=\"button\" name={\"none\"} className=\"btn btn-outline-primary m-2\" onClick={this.props.handleRacesChange}>Deselect All</button>\r\n                </div>\r\n                <Modal.Body>\r\n                    <form id={\"includedRacesForm\"}>\r\n                        <div className={\"form-group\"}>\r\n                            <input className={\"form-control\"} id={\"filterRaces\"} type={\"text\"} placeholder={\"Filter Races...\"} value={this.state.searchString} onChange={this.updateSearchString} />\r\n                        </div>\r\n                        {visibleRaces.map((raceName, raceIndex) => {\r\n                            let raceVisible = raceName.toLowerCase().includes(this.state.searchString);\r\n                            return (\r\n                                <div className={\"custom-control custom-checkbox mb-3 races\" + (raceVisible ? \"\" : \" d-none\")} key={\"set-races-\" + raceIndex}>\r\n                                    <input className={\"custom-control-input\"} name={raceName} type={\"checkbox\"} id={\"include\" + raceName.replace(\" \", \"\")} checked={this.props.currentRaces.indexOf(raceName) > -1} onChange={this.props.handleRacesChange} />\r\n                                    <label className={\"custom-control-label d-flex\"} htmlFor={\"include\" + raceName.replace(\" \", \"\")}>{raceName}</label>\r\n                                </div>\r\n                            )\r\n                        })}\r\n                    </form>\r\n                </Modal.Body>\r\n            </Modal>\r\n        );\r\n    }\r\n}\r\nexport default SetRacesModal;","import React from \"react\";\r\nimport {QuestionCircle} from \"react-bootstrap-icons\";\r\nimport boardData from \"../data/boardData.json\";\r\nimport tileData from \"../data/tileData.json\";\r\nimport raceData from \"../data/raceData.json\";\r\nimport adjacencyData from \"../data/adjacencyData.json\";\r\nimport HelpModal from \"./HelpModal\";\r\nimport SetPlayerNameModal from \"./SetPlayerNameModal\";\r\nimport SetRacesModal from \"./SetRacesModal\";\r\n\r\n\r\nclass MapOptions extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        const startingValues = {\r\n            numberOfPlayers: [2, 3, 4, 5, 6],\r\n            pokNumberOfPlayers: [7, 8],\r\n            boardStyles: {\r\n                2: Object.keys(boardData.styles[\"2\"]).map((key) => key),\r\n                3: Object.keys(boardData.styles[\"3\"]).map((key) => key),\r\n                4: Object.keys(boardData.styles[\"4\"]).map((key) => key),\r\n                5: Object.keys(boardData.styles[\"5\"]).map((key) => key),\r\n                6: Object.keys(boardData.styles[\"6\"]).map((key) => key === \"large\" ? null : key).filter(x => x),\r\n            },\r\n            boardStylesPok: {\r\n                2: Object.keys(boardData.styles[\"2\"]).map((key) => key),\r\n                3: Object.keys(boardData.styles[\"3\"]).map((key) => key),\r\n                4: Object.keys(boardData.styles[\"4\"]).map((key) => key),\r\n                5: Object.keys(boardData.styles[\"5\"]).map((key) => key),\r\n                6: Object.keys(boardData.styles[\"6\"]).map((key) => key),\r\n                7: Object.keys(boardData.styles[\"7\"]).map((key) => key),\r\n                8: Object.keys(boardData.styles[\"8\"]).map((key) => key),\r\n            },\r\n            pickStyles: [\"balanced\", \"random\", \"resource\", \"influence\", \"custom\", \"KSL\"],\r\n            placementStyles: [\"slice\", \"initial\", \"home\", \"random\", \"Fairness\",\"OptimalBalance\"],\r\n            races: [...raceData[\"races\"]],\r\n            pokRaces: [...raceData[\"pokRaces\"]],\r\n            homeworlds: raceData[\"homeSystems\"],\r\n            pokHomeworlds: raceData[\"pokHomeSystems\"]\r\n        }\r\n        const startingPlayers = 6;\r\n\r\n        this.state = {\r\n            optionsPossible: startingValues,\r\n            currentNumberOfPlayers: startingPlayers,\r\n            currentNumberOfPlayersOptions: startingValues[\"numberOfPlayers\"],\r\n            currentBoardStyleOptions: startingValues[\"boardStyles\"][startingPlayers],\r\n            currentBoardStyle: startingValues[\"boardStyles\"][startingPlayers][0],\r\n            currentPickStyle: startingValues[\"pickStyles\"][0],\r\n            currentPlacementStyle: startingValues[\"placementStyles\"][0],\r\n            currentSeed: \"\",\r\n\t\t\tgenerationIterations: 0,\r\n\t\t\tstopCriterion: 0.1,\r\n            userSetSeed: false,\r\n            pickRaces: false,\r\n            pickMultipleRaces: false,\r\n            shuffleBoards: false,\r\n            reversePlacementOrder: false,\r\n            ensureRacialAnomalies: true,\r\n\t\t\t//hideRaceTiles: false,\r\n            generated: false,\r\n\r\n            pickRacesHelp: false,\r\n            boardStyleHelp: false,\r\n            pickStyleHelp: false,\r\n            placementStyleHelp: false,\r\n            setPlayerNamesHelp: false,\r\n            setRacesHelp: false,\r\n            pickMultipleRacesHelp: false,\r\n            shufflePriorityHelp: false,\r\n            reversePlacementOrderHelp: false,\r\n            ensureRacialAnomaliesHelp: false,\r\n\t\t\thideRaceTilesHelp: false,\r\n\t\t\tsetIterationsHelp: false,\r\n\t\t\tsetStopCritHelp: false,\r\n\r\n            resourceWeight: 70,\r\n            influenceWeight: 30,\r\n            planetCountWeight: 15,\r\n            specialtyWeight: 50,\r\n            anomalyWeight: 10,\r\n            wormholeWeight: 25,\r\n\r\n            shuffleThreshold: 5,\r\n        };\r\n\r\n        this.handleInputChange = this.handleInputChange.bind(this);\r\n        this.handleNameChange = this.handleNameChange.bind(this);\r\n        this.handleRacesChange = this.handleRacesChange.bind(this);\r\n        this.updatePok = this.updatePok.bind(this);\r\n\t\tthis.updateHRT = this.updateHRT.bind(this);\r\n        this.updatePlayerCount = this.updatePlayerCount.bind(this);\r\n        this.updateBoardStyle = this.updateBoardStyle.bind(this);\r\n        this.updateSeed = this.updateSeed.bind(this);\r\n\t\tthis.resetGenerationIterations = this.resetGenerationIterations.bind(this);\r\n\t\tthis.resetStopCriterion = this.resetStopCriterion.bind(this);\r\n\r\n        this.ensureAnomalies = this.ensureAnomalies.bind(this);\r\n        this.ensureWormholesForType = this.ensureWormholesForType.bind(this);\r\n\r\n        this.updateBoardStyleOptions = this.updateBoardStyleOptions.bind(this); // TODO is the bind needed?\r\n\r\n        this.encodeSettings = this.encodeSettings.bind(this);\r\n        this.decodeSettings = this.decodeSettings.bind(this);\r\n\r\n        this.generateBoard = this.generateBoard.bind(this);\r\n        this.getNewTileSet = this.getNewTileSet.bind(this);\r\n\r\n        this.togglePickRacesHelp = this.togglePickRacesHelp.bind(this);\r\n        this.toggleBoardStyleHelp = this.toggleBoardStyleHelp.bind(this);\r\n        this.togglePickStyleHelp = this.togglePickStyleHelp.bind(this);\r\n        this.togglePlacementStyleHelp = this.togglePlacementStyleHelp.bind(this);\r\n        this.toggleSetPlayerNamesHelp = this.toggleSetPlayerNamesHelp.bind(this);\r\n        this.toggleSetRacesHelp = this.toggleSetRacesHelp.bind(this);\r\n        this.togglePickMultipleRacesHelp = this.togglePickMultipleRacesHelp.bind(this);\r\n        this.toggleShufflePriorityHelp = this.toggleShufflePriorityHelp.bind(this);\r\n        this.toggleReversePlacementOrderHelp = this.toggleReversePlacementOrderHelp.bind(this);\r\n        this.toggleEnsureRacialAnomaliesHelp = this.toggleEnsureRacialAnomaliesHelp.bind(this);\r\n\t\tthis.toggleHideRaceTilesHelp = this.toggleHideRaceTilesHelp.bind(this);\r\n        this.toggleGenIterHelp = this.toggleGenIterHelp.bind(this);\r\n\t\tthis.toggleStopCritHelp = this.toggleStopCritHelp.bind(this);\r\n    }\r\n\r\n    handleInputChange(event) {\r\n        const target = event.target;\r\n        const value = target.type === 'checkbox' ? target.checked : target.value;\r\n        const name = target.name;\r\n\r\n        this.setState({\r\n            [name]: value\r\n        });\r\n    }\r\n\r\n    handleNameChange(event) {\r\n        let nameIndex = parseInt(event.target.name.substring(10))\r\n        let newPlayerNames = this.props.currentPlayerNames\r\n        newPlayerNames[nameIndex] = event.target.value\r\n\r\n        this.setState({\r\n            currentPlayerNames: newPlayerNames\r\n        })\r\n    }\r\n\r\n    handleRacesChange(event) {\r\n        let race = event.target.name;\r\n        let newCurrentRaces = this.props.currentRaces;\r\n        if (race === \"none\") {  // The deselect all option\r\n            newCurrentRaces = []\r\n        } else if (race === \"all\") {  // The deselect all option\r\n            if (this.props.useProphecyOfKings) {\r\n                newCurrentRaces = [...this.state.optionsPossible.races.concat(this.state.optionsPossible.pokRaces)]\r\n            } else {\r\n                newCurrentRaces = [...this.state.optionsPossible.races]\r\n            }\r\n        } else {\r\n            let indexToToggle = newCurrentRaces.indexOf(race)\r\n            if (indexToToggle >= 0) {\r\n                newCurrentRaces.splice(indexToToggle, 1)\r\n            } else {\r\n                newCurrentRaces.push(race)\r\n            }\r\n        }\r\n\r\n        this.props.updateRaces(newCurrentRaces);\r\n    }\r\n\r\n    updatePok(event) {\r\n        let boardOptions = this.state.optionsPossible.boardStyles;\r\n        if (event.target.checked) {\r\n            boardOptions = this.state.optionsPossible.boardStylesPok;\r\n            this.setState({\r\n                currentNumberOfPlayersOptions: this.state.optionsPossible.numberOfPlayers.concat(this.state.optionsPossible.pokNumberOfPlayers),\r\n                currentBoardStyle: boardOptions[this.state.currentNumberOfPlayers][0],\r\n                currentBoardStyleOptions: boardOptions[this.state.currentNumberOfPlayers],\r\n            }, () => {\r\n                this.props.updateRaces([...this.state.optionsPossible.races.concat(this.state.optionsPossible.pokRaces)]);\r\n                this.props.toggleProphecyOfKings(event);\r\n            });\r\n        } else {\r\n            this.setState({\r\n                currentNumberOfPlayers: this.state.currentNumberOfPlayers > 6 ? 6 : this.state.currentNumberOfPlayers,\r\n                currentNumberOfPlayersOptions: this.state.optionsPossible.numberOfPlayers,\r\n                currentBoardStyle: this.state.currentNumberOfPlayers > 6 ? boardOptions[\"6\"][0] : this.state.currentBoardStyle,\r\n                currentBoardStyleOptions: this.state.currentNumberOfPlayers > 6 ? boardOptions[\"6\"] : boardOptions[this.state.currentNumberOfPlayers],\r\n            }, () => {\r\n                this.props.updateRaces([...this.state.optionsPossible.races]);\r\n                this.props.toggleProphecyOfKings(event);\r\n            });\r\n        }\r\n    }\r\n\t\r\n    updateHRT(event) {\r\n\t\tthis.setState({\r\n\t\t\t\r\n\t\t}, () => {\r\n\t\t\t\r\n\t\t\tthis.props.toggleHideRaceTiles(event);\r\n\t\t});\r\n    }\r\n\r\n    updatePlayerCount(event) {\r\n        this.setState({\r\n            currentNumberOfPlayers: parseInt(event.target.value),\r\n        }, () => {\r\n            this.updateBoardStyleOptions(event)\r\n        });\r\n    }\r\n\r\n    updateBoardStyle(event) {\r\n        this.setState({\r\n            currentBoardStyle: event.target.value,\r\n        }, () => {\r\n            if (this.state.generated) {\r\n                this.generateBoard(event)\r\n            }\r\n        });\r\n    }\r\n\r\n    updateBoardStyleOptions(event) {\r\n        let boardOptions = this.state.optionsPossible.boardStyles;\r\n        if (this.props.useProphecyOfKings) {\r\n            boardOptions = this.state.optionsPossible.boardStylesPok;\r\n        }\r\n        this.setState({\r\n            currentBoardStyleOptions: boardOptions[this.state.currentNumberOfPlayers],\r\n            currentBoardStyle: boardOptions[this.state.currentNumberOfPlayers][0],\r\n        }, () => {\r\n            if (this.state.generated) {\r\n                this.generateBoard(event)\r\n            }\r\n        });\r\n    }\r\n\r\n    updateSeed(event) {\r\n        let newSeed = parseInt(event.target.value)\r\n        if (!isNaN(newSeed) || event.target.value === \"\") {\r\n            this.setState({\r\n                currentSeed: event.target.value,\r\n                userSetSeed: event.target.value !== \"\"  // Ignore user entry if the value is blank\r\n            });\r\n        }\r\n    }\r\n\t\r\n\tresetGenerationIterations(event) { \r\n\t\tthis.setState({\r\n\t\t\tgenerationIterations: 0,\r\n\t\t});\r\n        \r\n    }\r\n\tresetStopCriterion(event) { \r\n\t\tif (event.target.value != \"\") {\r\n\t\t\tthis.setState({\r\n\t\t\t\tstopCriterion: event.target.value,\r\n\t\t\t});\r\n\t\t}\r\n        \r\n    }\r\n\r\n    capitalize(str) {\r\n        return str.charAt(0).toUpperCase() + str.slice(1);\r\n    }\r\n\r\n    shuffle(array) {\r\n        let m = array.length, t, i;\r\n        let seed = this.state.currentSeed.valueOf();\r\n\r\n        // While there remain elements to shuffle…\r\n        while (m) {\r\n            // Pick a remaining element…\r\n            i = Math.floor(this.random(seed) * m--);\r\n\r\n            // And swap it with the current element.\r\n            t = array[m];\r\n            array[m] = array[i];\r\n            array[i] = t;\r\n            ++seed\r\n        }\r\n\r\n        return array;\r\n    }\r\n\r\n    random(seed) {\r\n        let x = Math.sin(seed++) * 10000;\r\n        return x - Math.floor(x);\r\n    }\r\n\r\n    encodeSettings() {\r\n        let encodedSettings = \"\";\r\n\r\n        encodedSettings += this.props.useProphecyOfKings ? \"T\" : \"F\";\r\n        encodedSettings += this.state.currentNumberOfPlayers.toString();\r\n        encodedSettings += this.state.currentBoardStyleOptions.indexOf(this.state.currentBoardStyle).toString();\r\n        encodedSettings += this.state.optionsPossible.placementStyles.indexOf(this.state.currentPlacementStyle).toString();\r\n        encodedSettings += this.state.optionsPossible.pickStyles.indexOf(this.state.currentPickStyle).toString();\r\n        if (this.state.currentPickStyle === \"custom\") {\r\n            encodedSettings += this.state.resourceWeight.toString().padStart(3, \"0\");\r\n            encodedSettings += this.state.influenceWeight.toString().padStart(3, \"0\");\r\n            encodedSettings += this.state.planetCountWeight.toString().padStart(3, \"0\");\r\n            encodedSettings += this.state.specialtyWeight.toString().padStart(3, \"0\");\r\n            encodedSettings += this.state.anomalyWeight.toString().padStart(3, \"0\");\r\n            encodedSettings += this.state.wormholeWeight.toString().padStart(3, \"0\");\r\n        }\r\n        encodedSettings += this.state.currentSeed.toString().padStart(4, \"0\");\r\n        encodedSettings += this.state.shuffleBoards ? \"T\" : \"F\";\r\n        encodedSettings += this.state.reversePlacementOrder ? \"T\" : \"F\";\r\n        encodedSettings += this.state.pickRaces ? \"T\" : \"F\";\r\n        if (this.state.pickRaces) {\r\n            encodedSettings += this.state.ensureRacialAnomalies ? \"T\" : \"F\";\r\n            let combinedRaces = this.state.optionsPossible.races.concat(this.state.optionsPossible.pokRaces)\r\n            if ((this.props.useProphecyOfKings === false && this.props.currentRaces.length !== this.state.optionsPossible.races.length) ||\r\n                (this.props.useProphecyOfKings === true && this.props.currentRaces.length !== combinedRaces.length)) {\r\n                // Need to encode all races, because it is not the default\r\n                for (let race of this.props.currentRaces) {\r\n                    if (combinedRaces.indexOf(race) >= 0) {\r\n                        encodedSettings += combinedRaces.indexOf(race).toString().padStart(2, \"0\");\r\n                    }\r\n                }\r\n            }\r\n            let changedPlayerName = false;\r\n            let playerNames = \"|\"\r\n            for (let playerName of this.props.currentPlayerNames) {\r\n                if (playerName !== \"\") {\r\n                    changedPlayerName = true;\r\n                }\r\n                playerNames += playerName + \"|\";\r\n            }\r\n            if (changedPlayerName) {\r\n                encodedSettings += playerNames\r\n                encodedSettings = encodedSettings.slice(0, -1)\r\n            }\r\n        }\r\n\r\n        return encodedSettings;\r\n    }\r\n\r\n    decodeSettings(newSettings, newTiles) {\r\n        let currentIndex = 0;\r\n\r\n        // Prophecy of Kings\r\n        let useProphecyOfKings = newSettings[currentIndex] === \"T\";\r\n        currentIndex += 1;\r\n\r\n        // Number of Players\r\n        let currentNumberOfPlayers = Number(newSettings[currentIndex]);\r\n        currentIndex += 1;\r\n        let currentNumberOfPlayersOptions = useProphecyOfKings ? this.state.optionsPossible.numberOfPlayers.concat(this.state.optionsPossible.pokNumberOfPlayers) : this.state.optionsPossible.numberOfPlayers;\r\n\r\n        // Board Style\r\n        let currentBoardStyleOptions = useProphecyOfKings ? this.state.optionsPossible.boardStylesPok[currentNumberOfPlayers] : this.state.optionsPossible.boardStyles[currentNumberOfPlayers];\r\n        let currentBoardStyle = currentBoardStyleOptions[Number(newSettings[currentIndex])]\r\n        currentIndex += 1;\r\n\r\n        // Placement Style\r\n        let currentPlacementStyle = this.state.optionsPossible.placementStyles[Number(newSettings[currentIndex])];\r\n        currentIndex += 1;\r\n\r\n        // Pick Style\r\n        let currentPickStyle = this.state.optionsPossible.pickStyles[Number(newSettings[currentIndex])];\r\n        currentIndex += 1;\r\n\r\n        let resourceWeight = this.state.resourceWeight;\r\n        let influenceWeight = this.state.influenceWeight;\r\n        let planetCountWeight = this.state.planetCountWeight;\r\n        let specialtyWeight = this.state.specialtyWeight;\r\n        let anomalyWeight = this.state.anomalyWeight;\r\n        let wormholeWeight = this.state.wormholeWeight;\r\n        if (currentPickStyle === \"custom\") {\r\n            resourceWeight = Number(newSettings.substring(currentIndex, currentIndex + 3));\r\n            currentIndex += 3;\r\n            influenceWeight = Number(newSettings.substring(currentIndex, currentIndex + 3));\r\n            currentIndex += 3;\r\n            planetCountWeight = Number(newSettings.substring(currentIndex, currentIndex + 3));\r\n            currentIndex += 3;\r\n            specialtyWeight = Number(newSettings.substring(currentIndex, currentIndex + 3));\r\n            currentIndex += 3;\r\n            anomalyWeight = Number(newSettings.substring(currentIndex, currentIndex + 3));\r\n            currentIndex += 3;\r\n            wormholeWeight = Number(newSettings.substring(currentIndex, currentIndex + 3));\r\n            currentIndex += 3;\r\n        }\r\n\r\n        // Current Seed\r\n        let currentSeed = Number(newSettings.substring(currentIndex, currentIndex + 4));\r\n        currentIndex += 4;\r\n\r\n        // Shuffle Boards\r\n        let shuffleBoards = newSettings[currentIndex] === \"T\";\r\n        currentIndex += 1;\r\n\r\n        // Reverse Placement Order\r\n        let reversePlacementOrder = newSettings[currentIndex] === \"T\";\r\n        currentIndex += 1;\r\n\r\n        // Pick Races\r\n        let pickRaces = newSettings[currentIndex] === \"T\";\r\n        currentIndex += 1;\r\n\r\n        let currentPlayerNames = this.props.currentPlayerNames;\r\n        let currentRaces = this.props.currentRaces;\r\n        let ensureRacialAnomalies = this.props.ensureRacialAnomalies;\r\n        if (pickRaces) {\r\n            // Ensure Racial Anomalies\r\n            ensureRacialAnomalies = newSettings[currentIndex] === \"T\";\r\n            currentIndex += 1;\r\n            \r\n            if (newSettings[currentIndex] !== \"|\") {\r\n                if (newSettings[currentIndex] !== undefined) {\r\n                    // Custom races, but not all of them\r\n                    currentRaces = [];\r\n                    let combinedRaces = this.state.optionsPossible.races.concat(this.state.optionsPossible.pokRaces)\r\n                    while (newSettings[currentIndex] !== \"|\" && currentIndex !== newSettings.length) {\r\n                        currentRaces.push(combinedRaces[Number(newSettings.substring(currentIndex, currentIndex + 2))])\r\n                        currentIndex += 2\r\n                    }\r\n                } else {\r\n                    currentRaces = useProphecyOfKings ? this.state.optionsPossible.races.concat(this.state.optionsPossible.pokRaces) : this.state.optionsPossible.races;\r\n                }\r\n            } else {\r\n                // No custom races, but player names are specified, so parse them\r\n                currentPlayerNames = newSettings.substring(currentIndex).split(\"|\").splice(1);\r\n            }\r\n        }\r\n\r\n        this.setState({\r\n            currentNumberOfPlayers: currentNumberOfPlayers,\r\n            currentNumberOfPlayersOptions: currentNumberOfPlayersOptions,\r\n            currentBoardStyle: currentBoardStyle,\r\n            currentBoardStyleOptions: currentBoardStyleOptions,\r\n            currentPlacementStyle: currentPlacementStyle,\r\n            currentPickStyle: currentPickStyle,\r\n            resourceWeight: resourceWeight,\r\n            influenceWeight: influenceWeight,\r\n            planetCountWeight: planetCountWeight,\r\n            specialtyWeight: specialtyWeight,\r\n            anomalyWeight: anomalyWeight,\r\n            wormholeWeight: wormholeWeight,\r\n            currentSeed: currentSeed,\r\n            shuffleBoards: shuffleBoards,\r\n            reversePlacementOrder: reversePlacementOrder,\r\n            pickRaces: pickRaces,\r\n            ensureRacialAnomalies: ensureRacialAnomalies,\r\n        }, () => {\r\n            this.props.updateRaces(currentRaces);\r\n            this.props.updatePlayerNames(currentPlayerNames);\r\n\r\n            if ((useProphecyOfKings && !this.props.useProphecyOfKings) || (!useProphecyOfKings && this.props.useProphecyOfKings)) {\r\n                this.props.toggleProphecyOfKings();\r\n            }\r\n\r\n            if (newTiles.length > 0) {\r\n                // Tiles were changed after rendering, so we need to display them\r\n                this.props.updateTiles(newTiles, newSettings);\r\n            } else {\r\n\t\t\t\tlet newTileSetGenerated = this.getNewTileSet(useProphecyOfKings, currentRaces);\r\n\t\t\t\tlet newSliceDataGenerated = this.getSliceData(newTileSetGenerated);\r\n                this.props.updateTiles(newTileSetGenerated, newSettings, false, newSliceDataGenerated);\r\n            }\r\n        })\r\n\r\n\r\n    }\r\n\r\n    /**\r\n     * Create a new board using a custom seed.\r\n     * @param event The event which triggered this action, to be ignored.\r\n     */\r\n    generateBoard(event) {\r\n\t\t// Don't actually submit the form\r\n\t\tif (event !== undefined) {\r\n\t\t\tevent.preventDefault();\r\n\t\t}\r\n\r\n\t\t// Create a random seed to use unless the user has specified one\r\n\t\tlet currentSeed = this.state.currentSeed;\r\n\t\tif (!this.state.userSetSeed) {\r\n\t\t\tcurrentSeed = Math.floor(Math.random() * Math.floor(9999));\r\n\t\t}\r\n\t\tlet genIter = this.state.generationIterations + 1;\r\n\t\t\r\n\t\tthis.setState({\r\n\t\t\tcurrentSeed: currentSeed,\r\n\t\t\tgenerated: true,\r\n\t\t\tgenerationIterations: genIter,\r\n\t\t}, () => {\r\n\t\t\t\t\r\n\t\t\tlet newTileSetGenerated = this.getNewTileSet();\r\n\t\t\tlet newSliceDataGenerated = this.getSliceData(newTileSetGenerated);\r\n\t\t\tlet sliceTotalWeights = [];\r\n\t\t\tfor (let k=0; k < newSliceDataGenerated.length; k++){\r\n\t\t\t\tsliceTotalWeights[k] = newSliceDataGenerated[k].PlayerWeight;\r\n\t\t\t}\r\n\t\t\tlet maxDeltaWeight = (Math.max(...sliceTotalWeights) - Math.min(...sliceTotalWeights))/Math.max(...sliceTotalWeights);\r\n\t\t\tthis.props.updateTiles(newTileSetGenerated, this.encodeSettings(), true, newSliceDataGenerated);\r\n\t\t\t//debugger;\r\n\t\t\tif (!this.state.userSetSeed && maxDeltaWeight>this.state.stopCriterion && this.state.generationIterations < 50) {\r\n\t\t\t\tthis.generateBoard(event);\r\n\t\t\t\t//console.log(\"iteration number: \" + this.state.generationIterations);\r\n\t\t\t}\r\n\t\t\r\n\t\t}); \r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Create a set of new tiles for the board based on the user's input.\r\n     */\r\n    getNewTileSet(useProphecyOfKings, currentRaces) {\r\n        if (useProphecyOfKings === undefined) {\r\n            useProphecyOfKings = this.props.useProphecyOfKings\r\n        }\r\n\r\n        // Get an ordered list of board spaces that need to have non-home systems assigned to them\r\n        let systemIndexes = this.getNewTilesToPlace()\r\n\t\r\n        // Get current races for placing races, and shuffle them around\r\n        if (currentRaces === undefined) {\r\n            currentRaces = [...this.props.currentRaces]\r\n        } else {\r\n            currentRaces = [...currentRaces]\r\n        }\r\n        this.shuffle(currentRaces)\r\n        currentRaces = currentRaces.slice(0, this.state.currentNumberOfPlayers)\r\n\r\n        // Get a set of systems to make the board with, ordered based on user supplied weights\r\n        let newSystems = this.getNewSystemsToPlace(systemIndexes.length, useProphecyOfKings, currentRaces)\r\n\r\n        // Copy a blank map to add to\r\n        let newTiles = [...boardData.blankMap]\r\n\r\n        // Put Mecatol Rex in the middle\r\n        newTiles[0] = 18\r\n\r\n        // Place hyperlanes\r\n        this.placeHyperlanes(newTiles)\r\n\r\n        // Place home planets\r\n        this.placeHomeSystems(newTiles, currentRaces)\r\n\r\n\t\tif (this.state.currentPlacementStyle == \"OptimalBalance\") {\r\n\t\t\t\r\n\t\t\tlet playerSliceComplete = [false, false, false, false, false, false, false, false];\r\n\t\t\tlet EQSliceComplete = false;\r\n\t\t\t\r\n\t\t\t//@KSL new placing algorithm\r\n\t\t\t//Run over all systems to place from heaviest weight to lightest weight\r\n\t\t\tfor (let newSystem of newSystems) {\r\n\t\t\t\t\r\n\t\t\t\t//Place this system in the slice with the lowest playerWeight\r\n\t\t\t\tlet theSliceData = this.getSliceData(newTiles);\r\n\t\t\t\tlet weights = theSliceData[0].UsedWeights;\r\n\t\t\t\tlet EQSlice = [];\r\n\t\t\t\t\r\n\t\t\t\tlet allPlayersComplete = true;\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tfor (let j = 0; j < theSliceData.length; j++) {\r\n\t\t\t\t\tplayerSliceComplete[j] = true;\r\n\t\t\t\t\tfor (let theSystem of theSliceData[j].Slice){\r\n\t\t\t\t\t\tif (newTiles[theSystem] < 0) {\r\n\t\t\t\t\t\t\tplayerSliceComplete[j] = false;\r\n\t\t\t\t\t\t\tallPlayersComplete = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t//find the right player\r\n\t\t\t\tlet lowestPlayer = 999;\r\n\t\t\t\tlet lowestPlayerWeight = 999;\r\n\t\t\t\tfor (let j = 0; j < theSliceData.length; j++) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tEQSlice = EQSlice.concat(theSliceData[j].Equidistant);\r\n\t\t\t\t\tif (theSliceData[j].PlayerWeight < lowestPlayerWeight && !playerSliceComplete[j]) {\r\n\t\t\t\t\t\tlowestPlayerWeight = theSliceData[j].PlayerWeight;\r\n\t\t\t\t\t\tlowestPlayer = j;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t//clean up EQSlice\r\n\t\t\t\tlet EQSliceClean = [];\r\n\t\t\t\tfor (let k = 0; k<EQSlice.length; k++){\r\n\t\t\t\t\t\tif (EQSliceClean.indexOf(EQSlice[k]) < 0 && EQSlice[k] > 0) {\r\n\t\t\t\t\t\t\tEQSliceClean.push(EQSlice[k]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t//check EQ if this is lowest in weight\r\n\t\t\t\tlet EQWeight = 0;\r\n\t\t\t\tEQSliceComplete = true;\r\n\t\t\t\t\r\n\t\t\t\tfor (let tileNumber of EQSliceClean) {\r\n\t\t\t\t\tlet thisSystem = newTiles[tileNumber];\r\n\t\t\t\t\tif (thisSystem > 0){\r\n\t\t\t\t\t\tlet thisWeight = this.getWeight(thisSystem, weights, []);\r\n\t\t\t\t\t\tEQWeight += thisWeight;\r\n\t\t\t\t\t} else if (thisSystem < 0){\r\n\t\t\t\t\t\tEQSliceComplete = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (!allPlayersComplete || !EQSliceComplete) {\r\n\t\t\t\t\tlet thisPlayerSlice = [];\r\n\t\t\t\t\tif (EQWeight < lowestPlayerWeight && !EQSliceComplete) {\r\n\t\t\t\t\t\tthisPlayerSlice = EQSliceClean;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthisPlayerSlice = theSliceData[lowestPlayer].Slice;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//Choose a random position in the slice of the found player\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet shuffledSlice = this.shuffle(thisPlayerSlice);\r\n\t\t\t\t\tlet chosenIndex = 0;\r\n\t\t\t\t\tlet chosenTile = shuffledSlice[chosenIndex];\r\n\t\t\t\t\twhile (newTiles[chosenTile] > -1 && chosenIndex < shuffledSlice.length) {\r\n\t\t\t\t\t\tchosenIndex++;\r\n\t\t\t\t\t\tchosenTile = shuffledSlice[chosenIndex];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnewTiles[chosenTile] = newSystem;\r\n\t\t\t\t}\t\t\t\t\t\r\n\t\t\t}\r\n\t\t} else {\r\n        // Place planets one at a time, using the indexes to place combined with the ordered planet list\r\n\t\t\tfor (let systemIndex of systemIndexes) {\r\n\t\t\t\tnewTiles[systemIndex] = newSystems.shift();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t\r\n\t\t\r\n        // Place any systems that were locked from the previous generation\r\n        this.placeLockedSystems(newTiles)\r\n\r\n        // Check that anomalies and wormholes are not adjacent\r\n        this.checkAdjacencies(newTiles, useProphecyOfKings)\r\n\r\n\t\t//KSL TODO Make sure specific races have their specific tile\r\n\t\tif(this.state.ensureRacialAnomalies) {\r\n\t\t\tthis.checkRaceSlices(newTiles, useProphecyOfKings)\r\n\t\t}\r\n\t\t\r\n        // Update the generated flag then update the tiles\r\n        return newTiles;\r\n    }\r\n\r\n    /**\r\n     * Generate a list of index on the board that need to be filled with tiles. The various inputs include:\r\n     * Board Data: Information about what this board looks like, the tiles split into 3 groupings of importance\r\n     * Random Priority: Whether the first player goes first, or who gets the various picks is randomized\r\n     * Placement Style: How the groupings of tiles should be added to the board\r\n     * Reverse Placement Order: Whether the groupsings should be added in reverse order\r\n     * @returns {number[]} A list of indexes on the board that need to be filled in with system tiles\r\n     */\r\n    getNewTilesToPlace() {\r\n        // Copy all the tile arrays from board data\r\n        let primary = [...boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle][\"primary_tiles\"]];\r\n        let secondary = [...boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle][\"secondary_tiles\"]];\r\n        let tertiary = [...boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle][\"tertiary_tiles\"]];\r\n\r\n        // If shuffling, we need to shuffle primary, secondary, and tertiary indexes.\r\n        if (this.state.shuffleBoards) {\r\n            this.shuffle(primary);\r\n            this.shuffle(secondary);\r\n            this.shuffle(tertiary);\r\n        }\r\n\r\n        // Based on the placement style, generate the list of indexes to place\r\n        let systemIndexes = [];\r\n        switch(this.state.currentPlacementStyle) {\r\n            case(\"random\"):\r\n                // Add them all together and shuffle them\r\n                if (this.state.reversePlacementOrder) {\r\n                    systemIndexes = tertiary.concat(secondary).concat(primary);\r\n                } else {\r\n                    systemIndexes = primary.concat(secondary).concat(tertiary);\r\n                }\r\n                this.shuffle(systemIndexes);\r\n                break;\r\n            case(\"initial\"):\r\n                // Primary tiles are separate from the secondary shuffled tiles\r\n                if (this.state.reversePlacementOrder) {\r\n                    systemIndexes = this.shuffle(secondary.concat(tertiary)).concat(primary);\r\n                } else {\r\n                    systemIndexes = primary.concat(this.shuffle(secondary.concat(tertiary)));\r\n                }\r\n                break;\r\n            case(\"home\"):\r\n                // Primary tiles are tiles adjacent to home systems\r\n                systemIndexes = primary.concat(secondary).concat(tertiary);\r\n\r\n                // Get home systems\r\n                let home = [...boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle][\"home_worlds\"]];\r\n                let newPrimary = [];\r\n                for (let homeSystem of home) {\r\n                    // Loop over adjacent systems\r\n                    let adjacentSystems = adjacencyData[homeSystem];\r\n                    for (let adjacentSystem of adjacentSystems) {\r\n                        // Remove the adjacent system from the complete list (if it exists), and add it to the front\r\n                        if (systemIndexes.indexOf(adjacentSystem) >= 0) {\r\n                            newPrimary.push(adjacentSystem);\r\n                            systemIndexes.splice(systemIndexes.indexOf(adjacentSystem), 1);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Add the adjacent planets to the front of the list\r\n                this.shuffle(newPrimary);\r\n                if (this.state.reversePlacementOrder) {\r\n                    systemIndexes = systemIndexes.concat(newPrimary);\r\n                } else {\r\n                    systemIndexes = newPrimary.concat(systemIndexes);\r\n                }\r\n                break;\r\n\t\t\tcase(\"Fairness\"):\r\n\t\t\t\t//@KSL shuffle secondary tiles to randomize equidistant planets\r\n\t\t\t\tthis.shuffle(secondary);\r\n                // Combine them in their listed order\r\n                if (this.state.reversePlacementOrder) {\r\n                    systemIndexes = tertiary.concat(secondary).concat(primary);\r\n                } else {\r\n                    systemIndexes = primary.concat(secondary).concat(tertiary);\r\n                }\r\n                break;\r\n            case(\"slice\"):\r\n            default:\r\n                // Combine them in their listed order\r\n                if (this.state.reversePlacementOrder) {\r\n                    systemIndexes = tertiary.concat(secondary).concat(primary);\r\n                } else {\r\n                    systemIndexes = primary.concat(secondary).concat(tertiary);\r\n                }\r\n                break;\r\n        }\r\n\r\n        return systemIndexes;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * Get an array of system tile numbers to place on the board.\r\n     * @param {number} numberOfSystems The number of systems to get.\r\n     * @param {boolean} useProphecyOfKings TODO\r\n     * @returns {[]}\r\n     */\r\n    getNewSystemsToPlace(numberOfSystems, useProphecyOfKings, currentRaces) {\r\n        // Pick our a random set of systems, following the needed number of anomalies\r\n        let allBlues = useProphecyOfKings ? [...tileData.blue.concat(tileData.pokBlue)] : [...tileData.blue];\r\n        let allReds = useProphecyOfKings ? [...tileData.red.concat(tileData.pokRed)] : [...tileData.red];\r\n\r\n        // Remove excluded tiles\r\n        for (let system of this.props.excludedTiles) {\r\n            if (allReds.indexOf(system) >= 0) {\r\n                allReds.splice(allReds.indexOf(system), 1);\r\n            } else if (allBlues.indexOf(system) >= 0) {\r\n                allBlues.splice(allBlues.indexOf(system), 1);\r\n            }\r\n        }\r\n\r\n        // Shuffle our tiles for randomness\r\n        this.shuffle(allBlues)\r\n        this.shuffle(allReds)\r\n\r\n        // Calculate how many reds we need based on player count\r\n        let blueTileRatio = 2;\r\n        let redTileRatio = 1;\r\n\r\n        //If the board style overrides blue and red ratios we use those values, otherwise we go to the switch statement\r\n        const currentBoardStyle = boardData.styles[this.state.currentNumberOfPlayers][this.state.currentBoardStyle];\r\n        if(currentBoardStyle['overrideRatios'] !== undefined) {\r\n            blueTileRatio = currentBoardStyle['overrideRatios']['blueTileRatio'];\r\n            redTileRatio = currentBoardStyle['overrideRatios']['redTileRatio'];\r\n        } else {\r\n            // For 3, 4, and 6 player games, there is a different ratio\r\n            switch (this.state.currentNumberOfPlayers) {\r\n                case(3):\r\n                    blueTileRatio = 3\r\n                    redTileRatio = 1\r\n                    break;\r\n                case(4):\r\n                    blueTileRatio = 5\r\n                    redTileRatio = 3\r\n                    break;\r\n                case(6):\r\n                    blueTileRatio = 3\r\n                    redTileRatio = 2\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n\r\n        let redsToPlace = Math.round(Number((numberOfSystems / (blueTileRatio + redTileRatio)) * redTileRatio));\r\n        let bluesToPlace = Math.round(Number((numberOfSystems / (blueTileRatio + redTileRatio)) * blueTileRatio));\r\n\r\n        // If planet heavy system, then reduce number of anomalies\r\n        // if (false) {\r\n        //     let newRedsToPlace = 2; // TODO make this user configurable\r\n        //     if (newRedsToPlace > redsToPlace) {\r\n        //         bluesToPlace = bluesToPlace - (newRedsToPlace - redsToPlace);\r\n        //     } else if (newRedsToPlace < redsToPlace) {\r\n        //         bluesToPlace = bluesToPlace + (redsToPlace - newRedsToPlace);\r\n        //     }\r\n        //     redsToPlace = newRedsToPlace\r\n        // }\r\n\r\n        // Start to get the new systems\r\n        let newSystems = [];\r\n\r\n        // Force add in the included tiles\r\n        for (let system of this.props.includedTiles) {\r\n            if (newSystems.indexOf(system) < 0) {\r\n                newSystems.push(system);\r\n\r\n                // Remove them from the pool to add\r\n                if (allReds.indexOf(system) >= 0) {\r\n                    allReds.splice(allReds.indexOf(system), 1);\r\n                    redsToPlace -= 1;\r\n                } else {\r\n                    allBlues.splice(allBlues.indexOf(system), 1);\r\n                    bluesToPlace -= 1;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Force add in the locked tiles\r\n        for (let system of this.props.lockedTiles) {\r\n            if (newSystems.indexOf(system) < 0) {\r\n                newSystems.push(system);\r\n\r\n                // Remove them from the pool to add\r\n                if (allReds.indexOf(system) >= 0) {\r\n                    allReds.splice(allReds.indexOf(system), 1);\r\n                    redsToPlace -= 1;\r\n                } else {\r\n                    allBlues.splice(allBlues.indexOf(system), 1);\r\n                    bluesToPlace -= 1;\r\n                }\r\n            }\r\n        }\r\n\r\n        // These tiles are ensured for races and may not be replaced\r\n        const ensuredAnomalies = [];\r\n\r\n        if(this.state.ensureRacialAnomalies && this.state.pickRaces) {\r\n            currentRaces.forEach(race => {\r\n                let anomalies = []\r\n                let match = false;\r\n                // If The Clan of Saar are in the game, ensure we have an asteroid field\r\n                if(race === 'The Clan of Saar') {\r\n                    anomalies = useProphecyOfKings ? [...tileData.asteroidFields.concat(tileData.pokAsteroidFields)] : [...tileData.asteroidFields];\r\n                    match = true;\r\n                // If The Embers of Muaat are in the game, ensure we have a supernova\r\n                } else if(race === 'The Embers of Muaat') {\r\n                    anomalies = useProphecyOfKings ? [...tileData.supernovas.concat(tileData.pokSupernovas)] : [...tileData.supernovas];\r\n                    match = true;\r\n                // If The Empyrean are in the game, ensure we have a nebulae\r\n                } else if(race === 'The Empyrean') {\r\n                    anomalies = useProphecyOfKings ? [...tileData.nebulae.concat(tileData.pokNebulae)] : [...tileData.nebulae];\r\n                    match = true;\r\n                // If The Vuil'raith Cabal are in the game, ensure we have a gravity rift\r\n                } else if(race === \"The Vuil'raith Cabal\") {\r\n                    anomalies = useProphecyOfKings ? [...tileData.gravityRifts.concat(tileData.pokGravityRifts)] : [...tileData.gravityRifts];\r\n                    match = true;\r\n                }\r\n                if(match && redsToPlace > 0) {\r\n                    // Check if the tile is already included\r\n                    const found = anomalies.some(tile=> newSystems.includes(tile));\r\n                    // If not we add it\r\n                    if(!found) {\r\n                        this.shuffle(anomalies);\r\n                        newSystems.push(anomalies[0]);\r\n                        ensuredAnomalies.push(anomalies[0]);\r\n                        allReds.splice(allReds.indexOf(anomalies[0]), 1);\r\n                        redsToPlace -= 1;\r\n                    } else {\r\n                        ensuredAnomalies.push(newSystems.find(system => anomalies.includes(system)));\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        // Place as many as possible from tile type if there is not enough to place\r\n        if (redsToPlace > allReds.length) {\r\n            newSystems = newSystems.concat(allBlues.slice(0, bluesToPlace + (redsToPlace - allReds.length)).concat(allReds))\r\n        } else if (bluesToPlace > allBlues.length) {\r\n            newSystems = newSystems.concat(allBlues.concat(allReds.slice(0, redsToPlace + (bluesToPlace - allBlues.length))))\r\n        } else {\r\n            newSystems = newSystems.concat(allBlues.slice(0, bluesToPlace).concat(allReds.slice(0, redsToPlace)))\r\n        }\r\n\r\n        // Ensure that if a wormhole is included, two are\r\n        const allAlphaWormholes = useProphecyOfKings ? [...tileData.alphaWormholes.concat(tileData.pokAlphaWormholes)] : [...tileData.alphaWormholes];\r\n        const allBetaWormholes = useProphecyOfKings ? [...tileData.betaWormholes.concat(tileData.pokBetaWormholes)] : [...tileData.betaWormholes];\r\n\r\n        newSystems = this.ensureWormholesForType(newSystems, [26], allAlphaWormholes, allBetaWormholes, useProphecyOfKings, ensuredAnomalies);\r\n\r\n        // Ensure that if we have an alpha wormhole, then we have at least two of them\r\n        newSystems = this.ensureWormholesForType(newSystems, [25, 64], allBetaWormholes, allAlphaWormholes, useProphecyOfKings, ensuredAnomalies);\r\n\r\n        // Based on the system style, order the systems according to their weights\r\n        let weights = {};\r\n        switch (this.state.currentPickStyle) {\r\n            case \"random\":\r\n                this.shuffle(newSystems)\r\n                return newSystems\r\n            case \"custom\":\r\n                weights = {\r\n                    \"resource\": parseInt(this.state.resourceWeight),\r\n                    \"influence\": parseInt(this.state.influenceWeight),\r\n                    \"planet_count\": parseInt(this.state.planetCountWeight),\r\n                    \"specialty\": parseInt(this.state.specialtyWeight),\r\n                    \"anomaly\": parseInt(this.state.anomalyWeight),\r\n                    \"wormhole\": parseInt(this.state.wormholeWeight),\r\n                    \"racial\": parseInt(this.state.wormholeWeight) - 5\r\n                }\r\n                break;\r\n            case \"resource\":\r\n                weights = {\r\n                    \"resource\": 100,\r\n                    \"influence\": 10,\r\n                    \"planet_count\": 10,\r\n                    \"specialty\": 10,\r\n                    \"anomaly\": 10,\r\n                    \"wormhole\": 10,\r\n                    \"racial\": 5\r\n                }\r\n                break;\r\n            case \"influence\":\r\n                weights = {\r\n                    \"resource\": 10,\r\n                    \"influence\": 100,\r\n                    \"planet_count\": 10,\r\n                    \"specialty\": 10,\r\n                    \"anomaly\": 10,\r\n                    \"wormhole\": 10,\r\n                    \"racial\": 5\r\n                }\r\n                break;\r\n\t\t\tcase \"KSL\":\r\n                weights = {\r\n                    \"resource\": 80,\r\n                    \"influence\": 40,\r\n                    \"planet_count\": 15,\r\n                    \"specialty\": 50,\r\n                    \"anomaly\": 10,\r\n                    \"wormhole\": 10,\r\n                    \"racial\": 5\r\n                }\r\n                break;\r\n            case \"balanced\":\r\n            default:\r\n                if (useProphecyOfKings) {\r\n                    weights = {\r\n                        \"resource\": 80,\r\n                        \"influence\": 30,\r\n                        \"planet_count\": 15,\r\n                        \"specialty\": 50,\r\n                        \"anomaly\": 40,\r\n                        \"wormhole\": 25,\r\n                        \"racial\": 20\r\n                    }\r\n                } else {\r\n                    weights = {\r\n                        \"resource\": 80,\r\n                        \"influence\": 30,\r\n                        \"planet_count\": 15,\r\n                        \"specialty\": 40,\r\n                        \"anomaly\": 30,\r\n                        \"wormhole\": 25,\r\n                        \"racial\": 20\r\n                    }\r\n                }\r\n                break;\r\n        }\r\n\r\n        // Re-order the planets based on their weights\r\n        newSystems = this.getWeightedPlanetList(newSystems, weights, ensuredAnomalies)\r\n\r\n        return newSystems\r\n\r\n    }\r\n    placeHyperlanes(newTiles) {\r\n        // Place hyperlanes in their specific layout and orientation\r\n        // TODO in the future, can this be random? Can they rotate?\r\n        for (let index = 0; index < boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle]['hyperlane_tiles'].length; index++) {\r\n            let hyperlaneData = boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle]['hyperlane_tiles'][index]\r\n            newTiles[hyperlaneData[0]] = hyperlaneData[1] + \"-\" + hyperlaneData[2]\r\n        }\r\n    }\r\n    placeHomeSystems(newTiles, currentRaces) {\r\n        // Place data for the homeSystems from board data\r\n        for (let index = 0; index < boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle]['home_worlds'].length; index++) {\r\n            let planetIndex = boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle]['home_worlds'][index]\r\n            if (this.state.pickRaces && !this.state.pickMultipleRaces) {\r\n                // Convert races into race hexes and assign a random race to a player\r\n                newTiles[planetIndex] = raceData.raceToHomeSystemMap[currentRaces[0]]\r\n                currentRaces.shift();\r\n            } else {\r\n                // Set home worlds to 0, races to be decided later\r\n                newTiles[planetIndex] = 0\r\n            }\r\n        }\r\n    }\r\n    placeLockedSystems(newTiles) {\r\n        for (let system of this.props.lockedTiles) {\r\n            // Get location in current tile set\r\n            let currentLocation = this.props.tiles.indexOf(system);\r\n            if (currentLocation >= 0) {\r\n                // It exists, so get its location on the current board\r\n                let newTilesLocation = newTiles.indexOf(system);\r\n\r\n                // Swap the two tiles\r\n                newTiles[newTilesLocation] = newTiles[currentLocation];\r\n                newTiles[currentLocation] = system;\r\n            }\r\n        }\r\n    }\r\n    checkAdjacencies(newTiles, useProphecyOfKings) {// Planets have been placed, time to do post processing checks to make sure things are good to go.\r\n        // Get all anomalies that are adjacent to one another\r\n        let allTrueAnomalies = useProphecyOfKings ? [...tileData.anomaly.concat(tileData.pokAnomaly)] : [...tileData.anomaly];\r\n\r\n        for (let anomaly of allTrueAnomalies) {\r\n            // Ignore any anomalies in the locked or include list\r\n            if (this.props.includedTiles.indexOf(anomaly) < 0 && this.props.lockedTiles.indexOf(anomaly) < 0) {\r\n\r\n                let anomalyTileNumber = newTiles.indexOf(anomaly);\r\n                if (anomalyTileNumber >= 0) {\r\n                    // anomaly exists in the map, so check it\r\n                    let adjacentTiles = adjacencyData[anomalyTileNumber];\r\n                    let adjacentAnomalies = [];\r\n\r\n                    // Get a list of all adjacent anomalies to this one\r\n                    for (let adjacentTileNumber of adjacentTiles) {\r\n                        let adjacentTile = newTiles[adjacentTileNumber];\r\n                        if (allTrueAnomalies.indexOf(adjacentTile) >= 0) {\r\n                            // This tile is an anomaly\r\n                            adjacentAnomalies.push(adjacentTile)\r\n                        }\r\n                    }\r\n\r\n                    // If tile is in conflict more than 1 anomaly, see if there is a \"blank\" anomaly off the board to swap with. if not, then continue\r\n                    let swapped = false;\r\n                    let blankReds = useProphecyOfKings ? [...tileData.blankRed.concat(tileData.pokBlankRed)] : [...tileData.blankRed];\r\n                    if (adjacentAnomalies.length > 1) {\r\n                        let possibleBlanks = [];\r\n                        for (let blankRed of blankReds) {\r\n                            if (newTiles.indexOf(blankRed) < 0) {\r\n                                possibleBlanks.push(blankRed)\r\n                            }\r\n                        }\r\n                        possibleBlanks = this.shuffle(possibleBlanks);\r\n                        if (possibleBlanks.length > 0) {\r\n                            swapped = true;\r\n                            newTiles[anomalyTileNumber] = possibleBlanks[0];\r\n                        }\r\n                    }\r\n\r\n                    if (!swapped && adjacentAnomalies.length > 0) {\r\n                        // Look at all red back tiles on the board that are not anomalies, and see if they have adjacent anomalies\r\n                        for (let blankRed of blankReds) {\r\n                            let blankRedTileNumber = newTiles.indexOf(blankRed)\r\n                            if (blankRedTileNumber >= 0) {\r\n                                let adjacentTiles = adjacencyData[blankRedTileNumber];\r\n                                let swappable = true;\r\n                                for (let adjacentTile of adjacentTiles) {\r\n                                    if (allTrueAnomalies.indexOf(newTiles[adjacentTile]) >= 0 && adjacentTile !== anomalyTileNumber) {\r\n                                        // This blank has an adjacent anomaly, so throw it out\r\n                                        swappable = false;\r\n                                        break;\r\n                                    }\r\n                                }\r\n                                if (swappable) {\r\n                                    // This blank red has no other adjacent anomalies, so swap\r\n                                    newTiles[anomalyTileNumber] = blankRed;\r\n                                    newTiles[blankRedTileNumber] = anomaly;\r\n                                    swapped = true;\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                        if (!swapped) {\r\n                            let blankReds = useProphecyOfKings ? [...tileData.blankRed.concat(tileData.pokBlankRed)] : [...tileData.blankRed];\r\n                            let possibleBlanks = [];\r\n                            for (let blankRed of blankReds) {\r\n                                if (newTiles.indexOf(blankRed) < 0) {\r\n                                    possibleBlanks.push(blankRed)\r\n                                }\r\n                            }\r\n                            possibleBlanks = this.shuffle(possibleBlanks);\r\n                            if (possibleBlanks.length > 0) {\r\n                                swapped = true;\r\n                                newTiles[anomalyTileNumber] = possibleBlanks[0];\r\n                            }\r\n                            if (!swapped) {\r\n                                console.log(\"Error! Unable to swap anomaly to a free position.\")\r\n                            }\r\n                            /*\r\n                            There is a potential use for this strategy, but for now it seems pretty safe to just let it fail\r\n                            to swap on a blank. It is rare that it is impossible, and even when it is, its a pretty simple\r\n                            rule. Plus the rules let you place reds next to each other if moving them is impossible.\r\n                            btw, not sure this code below works properly. I believe there is a bug in it.\r\n                             */\r\n\r\n                            /*\r\n                            // Going in reverse, find the first tile with no anomalies adjacent, and swap\r\n                            newTiles.reverse()\r\n                            for (let tile of newTiles) {\r\n                                if (tile !== 0 && tile !== -1 && allTrueAnomalies.indexOf(tile) < 0 && blankReds.indexOf(tile) < 0) {\r\n                                    console.log(\"Tile: \" + tile)\r\n                                    // This is a real tile, check for adjacency to other anomalies\r\n                                    let blankRedTileNumber = newTiles.indexOf(tile)\r\n                                    let adjacentTiles = adjacencyData[blankRedTileNumber];\r\n                                    let swappable = true;\r\n                                    for (let adjacentTile of adjacentTiles) {\r\n                                        if (allTrueAnomalies.indexOf(newTiles[adjacentTile]) >= 0) {\r\n                                            // This blank has an adjacent anomaly, so throw it out\r\n                                            swappable = false;\r\n                                            break;\r\n                                        }\r\n                                    }\r\n                                    if (swappable) {\r\n                                        // No adjacency breaks found, go ahead and swap it\r\n                                        console.log(anomalyTileNumber)\r\n                                        console.log(blankRedTileNumber)\r\n                                        newTiles[anomalyTileNumber] = tile;\r\n                                        newTiles[blankRedTileNumber] = anomaly;\r\n                                        swapped = true;\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n                            // If no swap possible, no problem. Continue on\r\n                            newTiles.reverse()\r\n                            */\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        const allAlphaWormholes = useProphecyOfKings ? [...tileData.alphaWormholes.concat(tileData.pokAlphaWormholes)] : [...tileData.alphaWormholes];\r\n        const allBetaWormholes = useProphecyOfKings ? [...tileData.betaWormholes.concat(tileData.pokBetaWormholes)] : [...tileData.betaWormholes];\r\n\r\n\r\n        // Alpha, at least one wormhole is a \"empty tile\" so swap it with a blank tile\r\n        for (let alphaWormhole of allAlphaWormholes) {\r\n            let alphaWormholeTileNumber = newTiles.indexOf(alphaWormhole);\r\n            if (alphaWormholeTileNumber >= 0 && tileData.all[alphaWormhole].planets.length === 0) {\r\n                // Wormhole exists on the board, and is blank. Check if it is adjacent to another wormhole\r\n                let adjacentTileNumbers = adjacencyData[alphaWormholeTileNumber];\r\n                let adjacentWormhole = false;\r\n                for (let adjacentTileNumber of adjacentTileNumbers) {\r\n                    if (allAlphaWormholes.indexOf(newTiles[adjacentTileNumber]) >= 0) {\r\n                        adjacentWormhole = true;\r\n                        break;\r\n                    }\r\n                }\r\n                if (adjacentWormhole) {\r\n                    // This blank has an adjacent wormhole, so we need to move it. Loop over all blanks to swap with\r\n                    let blankReds = useProphecyOfKings ? [...tileData.blankRed.concat(tileData.pokBlankRed)] : [...tileData.blankRed];\r\n                    // Remove wormholes from blank reds, because swapping alphas doesn't make sense.\r\n                    blankReds = blankReds.filter( function( el ) {\r\n                        return allAlphaWormholes.indexOf( el ) < 0;\r\n                    } );\r\n                    blankReds = this.shuffle(blankReds);\r\n                    for (let blankRed of blankReds) {\r\n                        let blankRedTileNumber = newTiles.indexOf(blankRed)\r\n                        if (blankRedTileNumber >= 0) {\r\n                            let adjacentTilesNumbers = adjacencyData[blankRedTileNumber];\r\n                            let swappable = true;\r\n                            for (let adjacentTileNumber of adjacentTilesNumbers) {\r\n                                if ((allAlphaWormholes.indexOf(newTiles[adjacentTileNumber]) >= 0 && adjacentTileNumber !== alphaWormholeTileNumber) || (allTrueAnomalies.indexOf(alphaWormhole) >= 0 && allTrueAnomalies.indexOf(newTiles[adjacentTileNumber]) >= 0)) {\r\n                                    // This blank has an adjacent anomaly, so throw it out\r\n                                    swappable = false;\r\n                                    break;\r\n                                }\r\n                            }\r\n                            if (swappable) {\r\n                                // This blank red has no other adjacent anomalies, so swap\r\n                                newTiles[alphaWormholeTileNumber] = blankRed;\r\n                                newTiles[blankRedTileNumber] = alphaWormhole;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        // Beta at least one planet wormhole, so swap it with another planet of equal resource value\r\n        for (let betaWormhole of allBetaWormholes) {\r\n            let betaWormholeTileNumber = newTiles.indexOf(betaWormhole);\r\n            if (betaWormholeTileNumber >= 0 && tileData.all[betaWormhole].planets.length === 0) {\r\n                // Wormhole exists on the board, and is blank. Check if it is adjacent to another wormhole\r\n                let adjacentTileNumbers = adjacencyData[betaWormholeTileNumber];\r\n                let adjacentWormhole = false;\r\n                for (let adjacentTileNumber of adjacentTileNumbers) {\r\n                    if (allBetaWormholes.indexOf(newTiles[adjacentTileNumber]) >= 0) {\r\n                        adjacentWormhole = true;\r\n                        break;\r\n                    }\r\n                }\r\n                if (adjacentWormhole) {\r\n                    // This blank has an adjacent wormhole, so we need to move it. Loop over all blanks to swap with\r\n                    let blankReds = useProphecyOfKings ? [...tileData.blue.concat(tileData.pokBlue)] : [...tileData.blue];\r\n                    // Remove wormholes from blank reds, because swapping alphas doesn't make sense.\r\n                    blankReds = blankReds.filter( function( el ) {\r\n                        return allBetaWormholes.indexOf( el ) < 0;\r\n                    } );\r\n                    blankReds = this.shuffle(blankReds);\r\n                    for (let blankRed of blankReds) {\r\n                        let blankRedTileNumber = newTiles.indexOf(blankRed)\r\n                        if (blankRedTileNumber >= 0) {\r\n                            let adjacentTilesNumbers = adjacencyData[blankRedTileNumber];\r\n                            let swappable = true;\r\n                            for (let adjacentTileNumber of adjacentTilesNumbers) {\r\n                                // Check for adjacency to another wormhole (excluding itself) and other anomalies\r\n                                if ((allBetaWormholes.indexOf(newTiles[adjacentTileNumber]) >= 0 && adjacentTileNumber !== betaWormholeTileNumber)) {\r\n                                    //\r\n                                    swappable = false;\r\n                                    break;\r\n                                }\r\n                            }\r\n                            if (swappable) {\r\n                                // This blank red has no other adjacent anomalies, so swap\r\n                                newTiles[betaWormholeTileNumber] = blankRed;\r\n                                newTiles[blankRedTileNumber] = betaWormhole;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\t//@KSL Make sure the requested anomalies are in the concerned player slices\r\n\tcheckRaceSlices(newTiles, useProphecyOfKings) {\r\n\t\r\n\t\t//Calculate slice data\r\n\t\tlet theSliceData = this.getSliceData(newTiles);\r\n\t\tlet weights = theSliceData[0].UsedWeights;\r\n\t\tconst allTrueAnomalies = useProphecyOfKings ? [...tileData.anomaly.concat(tileData.pokAnomaly)] : [...tileData.anomaly];\r\n\t\tconst allAlphaWormholes = useProphecyOfKings ? [...tileData.alphaWormholes.concat(tileData.pokAlphaWormholes)] : [...tileData.alphaWormholes];\r\n        const allBetaWormholes = useProphecyOfKings ? [...tileData.betaWormholes.concat(tileData.pokBetaWormholes)] : [...tileData.betaWormholes];\r\n\t\tlet anomalyTestSet = allTrueAnomalies;\r\n\t\t\t\t\t\t\r\n\t\tlet currentRaces2 = [];\r\n\t\tlet currentHomeTile = -1;\r\n\t\tfor (let k=0; k < theSliceData.length; k++){\r\n\t\t\tcurrentHomeTile = newTiles[theSliceData[k].HomeTile];\r\n\t\t\tcurrentRaces2[k] = raceData.homeSystemToRaceMap[currentHomeTile];\r\n\t\t}\r\n\t\t\r\n\t\tif(this.state.ensureRacialAnomalies && this.state.pickRaces) {\r\n            for (let r=0; r < currentRaces2.length; r++){\r\n\t\t\t\tlet race = currentRaces2[r];\r\n\t\t\t\tlet anomalies = []\r\n                let match = false;\r\n                // If The Clan of Saar are in the game, ensure they have an asteroid field in their slice\r\n                if(race === 'The Clan of Saar') {\r\n                    anomalies = useProphecyOfKings ? [...tileData.asteroidFields.concat(tileData.pokAsteroidFields)] : [...tileData.asteroidFields];\r\n                    match = true;\r\n                // If The Embers of Muaat are in the game, ensure they have a supernova in their slice\r\n                } else if(race === 'The Embers of Muaat') {\r\n                    anomalies = useProphecyOfKings ? [...tileData.supernovas.concat(tileData.pokSupernovas)] : [...tileData.supernovas];\r\n                    match = true;\r\n                // If The Empyrean are in the game, ensure they have a nebulae in their slice\r\n                } else if(race === 'The Empyrean') {\r\n                    anomalies = useProphecyOfKings ? [...tileData.nebulae.concat(tileData.pokNebulae)] : [...tileData.nebulae];\r\n                    match = true;\r\n                // If The Vuil'raith Cabal are in the game, ensure they have a gravity rift in their slice\r\n//                } else if(race === \"The Vuil'raith Cabal\") {\r\n//                    anomalies = useProphecyOfKings ? [...tileData.gravityRifts.concat(tileData.pokGravityRifts)] : [...tileData.gravityRifts];\r\n//                    match = true;\r\n\t\t\t\t// If The Ghosts of Creuss are in the game, ensure they have a wormhole in their slice\r\n                } else if(race === \"The Ghosts of Creuss\") {\r\n\t\t\t\t\tanomalies = allAlphaWormholes.concat(allBetaWormholes);\r\n\t\t\t\t\tanomalyTestSet = anomalies;\r\n                    match = true;\r\n                }\r\n\r\n\t\t\t\tif(match) {\r\n\r\n\t\t\t\t\tlet anomalyFound = false;\r\n\t\t\t\t\t\r\n\t\t\t\t\t//Check if the anomaly is already in the slice of the concerned race\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet thisSlice = theSliceData[r].Slice;\r\n\t\t\t\t\tlet playerSliceWeights = [];\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor (let sliceTileIndex of thisSlice) {\r\n\t\t\t\t\t\tif (anomalies.indexOf(newTiles[sliceTileIndex]) > -1) {\r\n\t\t\t\t\t\t\tanomalyFound = true;\r\n\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t//Calculate weights of all tiles in this players slice\r\n\t\t\t\t\t\tplayerSliceWeights.push(this.getWeight(newTiles[sliceTileIndex], weights, []));\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t//if yes, do nothing\r\n\t\t\t\t\t\r\n\t\t\t\t\t//if no, select a matching anomaly tile from the board to swap with\r\n\t\t\t\t\tif (!anomalyFound) {\r\n\t\t\t\t\t\t//search the boardTiles for a matching anomaly (should be somewhere on the board as ensureRacialAnomalies is True)\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet allMatchingAnomalyIndexes = [];\r\n\t\t\t\t\t\tfor (let matchingAnomaly of anomalies ) {\r\n\t\t\t\t\t\t\tif (newTiles.indexOf(matchingAnomaly) > -1) {\r\n\t\t\t\t\t\t\t\tallMatchingAnomalyIndexes.push(newTiles.indexOf(matchingAnomaly));\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t//Check if at least one matching anomaly is found on the board. This should be the case as \"ensureRacialAnomalies\" is True.\r\n\t\t\t\t\t\t//and swap this anomaly tile with a tile that is closest in weight in the slice of the concerned race\r\n\r\n\t\t\t\t\t\tif (allMatchingAnomalyIndexes.length > 0) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t//Simply select the first matching anomaly tile found\r\n\t\t\t\t\t\t\tlet anomalyIndexToSwap = allMatchingAnomalyIndexes[0];\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t//Check if there is a matching anomaly adjacent to the slice of the concerned player. Selecting this one will reduce the probability of having issues with adjacent anomalies later on.\r\n\t\t\t\t\t\t\tfor (let l=0; l < thisSlice.length; l++){\r\n\t\t\t\t\t\t\t\tlet adjacentTiles = adjacencyData[thisSlice[l]];\r\n\t\t\t\t\t\t\t\tfor (let adjacentTile of adjacentTiles) {\r\n\t\t\t\t\t\t\t\t\tif (allMatchingAnomalyIndexes.indexOf(adjacentTile) >= 0) {\r\n\t\t\t\t\t\t\t\t\t\tanomalyIndexToSwap = adjacentTile;\r\n\t\t\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tlet anomalyToSwapWeight = this.getWeight(newTiles[anomalyIndexToSwap], weights, []);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tlet deltaweight = 9999;\r\n\t\t\t\t\t\t\tlet playerTileIndexToSwap = -1;\r\n\t\t\t\t\t\t\tlet deltaweightBackup = 9999;\r\n\t\t\t\t\t\t\tlet playerTileIndexToSwapBackup = -1; //This is the backup swap tile, if there is no anomaly found in the player slice\r\n\t\t\t\t\t\t\tlet deltaweightBackup2 = 9999;\r\n\t\t\t\t\t\t\tlet playerTileIndexToSwapBackup2 = -1; //This is the second backup swap tile, if there is no anomaly found in the player slice\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tfor (let l=0; l < thisSlice.length; l++){\r\n\t\t\t\t\t\t\t\tif (deltaweight > Math.abs(anomalyToSwapWeight - playerSliceWeights[l])) {\r\n\t\t\t\t\t\t\t\t\t//only retain tiles in the player slice that are anomalies\r\n\t\t\t\t\t\t\t\t\tif (anomalyTestSet.indexOf(newTiles[thisSlice[l]]) >= 0) {\r\n\t\t\t\t\t\t\t\t\t\tdeltaweight = Math.abs(anomalyToSwapWeight - playerSliceWeights[l]);\r\n\t\t\t\t\t\t\t\t\t\tplayerTileIndexToSwap = l;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (deltaweightBackup > Math.abs(anomalyToSwapWeight - playerSliceWeights[l])) {\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t//or tiles that do not have adjacent anomalies\r\n\t\t\t\t\t\t\t\t\tlet adjacentTiles = adjacencyData[thisSlice[l]];\r\n\t\t\t\t\t\t\t\t\tlet swappable = true;\r\n\t\t\t\t\t\t\t\t\tfor (let adjacentTile of adjacentTiles) {\r\n\t\t\t\t\t\t\t\t\t\tif (anomalyTestSet.indexOf(newTiles[adjacentTile]) >= 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t// This tile has an adjacent anomaly, so throw it out\r\n\t\t\t\t\t\t\t\t\t\t\tswappable = false;\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (swappable) {\r\n\t\t\t\t\t\t\t\t\t\tdeltaweightBackup = Math.abs(anomalyToSwapWeight - playerSliceWeights[l]);\r\n\t\t\t\t\t\t\t\t\t\tplayerTileIndexToSwapBackup = l;\r\n\t\t\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t\t}\t\t\r\n\t\t\t\t\t\t\t\tif (deltaweightBackup2 > Math.abs(anomalyToSwapWeight - playerSliceWeights[l])) {\t\t\r\n\t\t\t\t\t\t\t\t\t\tdeltaweightBackup2 = Math.abs(anomalyToSwapWeight - playerSliceWeights[l]);\r\n\t\t\t\t\t\t\t\t\t\tplayerTileIndexToSwapBackup2 = l;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t//if there was no anomaly found in the player slice, take the backup swap file\r\n\t\t\t\t\t\t\tif (playerTileIndexToSwap == -1) {\r\n\t\t\t\t\t\t\t\tplayerTileIndexToSwap = playerTileIndexToSwapBackup;\r\n\t\t\t\t\t\t\t\tdeltaweight = deltaweightBackup;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (playerTileIndexToSwap == -1) {\r\n\t\t\t\t\t\t\t\tplayerTileIndexToSwap = playerTileIndexToSwapBackup2;\r\n\t\t\t\t\t\t\t\tdeltaweight = deltaweightBackup2;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t//Check if the tiles that are going to be swapped do not cause two anomalies to be adjacant (TODO)\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t//Swap tiles\r\n\t\t\t\t\t\t\tlet anomalyToSwap = newTiles[anomalyIndexToSwap];\r\n\t\t\t\t\t\t\tnewTiles[anomalyIndexToSwap] = newTiles[thisSlice[playerTileIndexToSwap]];\r\n\t\t\t\t\t\t\tnewTiles[thisSlice[playerTileIndexToSwap]] = anomalyToSwap;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n                }\t\t\t\t\r\n\t\t\t}\r\n        }\r\n\t}\r\n\t\r\n    ensureWormholesForType(possibleTiles, planetWormholes, allWormholes, oppositeWormholes, useProphecyOfKings, ensuredAnomalies) {\r\n        let allAnomalyList = useProphecyOfKings ? [...tileData.red.concat(tileData.pokRed)] : [...tileData.red];\r\n        let unusedWormholes = [];\r\n        let usedWormholes = [];\r\n\r\n        // Get an array of all unused wormholes\r\n        for (let wormholeIndex in allWormholes) {\r\n            possibleTiles.indexOf(allWormholes[wormholeIndex]) < 0 ?\r\n                unusedWormholes.push(allWormholes[wormholeIndex]) : usedWormholes.push(allWormholes[wormholeIndex]);\r\n        }\r\n\r\n        // If there is only one wormhole, then we need to add a new one in\r\n        if (usedWormholes.length === 1) {\r\n            /*\r\n            Lets do some tricky logic here. If we are using a planet wormhole tile, then we want to replace\r\n            another anomaly with one of the other one (pok: two) anomaly wormholes. If we are not using the planet tile,\r\n            then we can try to find a planet to replace with any remaining wormhole tiles.\r\n             */\r\n            unusedWormholes = this.shuffle(unusedWormholes);\r\n            let excludedTiles = [...allWormholes.concat(oppositeWormholes)].concat(ensuredAnomalies);\r\n\r\n            // Check that the single used wormhole is not a planet.\r\n            if (planetWormholes.indexOf(usedWormholes[0]) < 0) {\r\n                // Try to replace some other planet with a planet wormhole\r\n                unusedWormholes = planetWormholes;\r\n                excludedTiles = excludedTiles.concat(allAnomalyList);\r\n            } else {\r\n                // Using a planet, so try to replace an anomaly with a wormhole\r\n                let wormholesToUse = []\r\n                for (let unusedWormhole of unusedWormholes) {\r\n                    if (planetWormholes.indexOf(unusedWormhole) < 0) {\r\n                        wormholesToUse.push(unusedWormhole)\r\n                    }\r\n                }\r\n                unusedWormholes = wormholesToUse\r\n            }\r\n            possibleTiles = this.reverseReplace(possibleTiles, 1, unusedWormholes, excludedTiles, false);\r\n        }\r\n\r\n        return possibleTiles;\r\n    }\r\n\r\n    ensureAnomalies(possibleTiles, numPlanetsToPlace, useProphecyOfKings) {\r\n        // Only care about the tiles we will actually place\r\n        possibleTiles = possibleTiles.slice(0, numPlanetsToPlace);\r\n\r\n        // Check that there is a minimum number of anomalies on the board\r\n        let blueTileRatio = 2;\r\n        let redTileRatio = 1;\r\n        // For 3, 4, and 6 player games, there is a different ratio\r\n        switch (this.state.currentNumberOfPlayers) {\r\n            case(3):\r\n                blueTileRatio = 3\r\n                redTileRatio = 1\r\n                break;\r\n            case(4):\r\n                blueTileRatio = 5\r\n                redTileRatio = 3\r\n                break;\r\n            case(6):\r\n                blueTileRatio = 3\r\n                redTileRatio = 2\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        let numAnomaliesLeftToBePlaced = (numPlanetsToPlace / (blueTileRatio + redTileRatio)) * redTileRatio;\r\n\r\n        // If there is no anomalies to add, then we are done\r\n        if (numAnomaliesLeftToBePlaced < 0) {\r\n            return possibleTiles\r\n        }\r\n\r\n        // Still have to add a certain number of anomalies in. Get a list of possible anomalies we can add to the tile list\r\n        let allAnomalyList = useProphecyOfKings ? [...tileData.red.concat(tileData.pokRed)] : [...tileData.red];\r\n\r\n        // Remove all current anomalies in use from this list\r\n        let possibleAnomalies = []\r\n        for (let anomalyIndex in allAnomalyList) {\r\n            if (possibleTiles.indexOf(allAnomalyList[anomalyIndex]) < 0) {\r\n                // Not using this anomaly yet, so we can add it\r\n                possibleAnomalies.push(allAnomalyList[anomalyIndex])\r\n            } else {\r\n                // Anomaly is already being used\r\n                numAnomaliesLeftToBePlaced -= 1;\r\n            }\r\n        }\r\n\r\n        // Randomize, so anomalies we are using are not always the same\r\n        possibleAnomalies = this.shuffle(possibleAnomalies);\r\n\r\n        return this.reverseReplace(possibleTiles, numAnomaliesLeftToBePlaced, possibleAnomalies, allAnomalyList, false)\r\n\r\n    }\r\n\r\n    /**\r\n     * Replace tiles starting from the lowest weight (bottom of the list being defined by reversPlacementOrder)\r\n     * @param possibleTiles {Int8Array} The ordered list of tiles, cut to the needed size\r\n     * @param numTilesToReplace {Number} The number of tiles we need to try to replace from replacement into possible\r\n     * @param replacementTiles {Int8Array} An array of all the tiles we can pick from to put into possibleTiles\r\n     * @param excludedTiles {Int8Array} An array of tiles we do not want to replace in possible\r\n     * @param reverseBeforeAndAfter {Boolean} Whether we want to reverse the list before and after replacement\r\n     * @returns {Int8Array} An ordered list of tiles, with some tiles being replaced\r\n     */\r\n    reverseReplace (possibleTiles, numTilesToReplace, replacementTiles, excludedTiles, reverseBeforeAndAfter) {\r\n        // If we aren't placing in reverse order, we want to start changing the worst tiles (which are usually last)\r\n        if (reverseBeforeAndAfter) {\r\n            possibleTiles = possibleTiles.reverse()\r\n        }\r\n        let currentTileIndex = possibleTiles.length - 1;\r\n\r\n        // While there are anomalies to place and a place to put them...\r\n        while (numTilesToReplace > 0 && replacementTiles.length > 0 && currentTileIndex > 0) {\r\n            // Check the index to see that it is not an anomaly or a 0 or -1 or 18 or hyperlane\r\n            let tileOfInterest = possibleTiles[currentTileIndex]\r\n            if (excludedTiles.indexOf(tileOfInterest) < 0 && tileOfInterest !== -1  && tileOfInterest !== 18 && tileOfInterest !== 0 && typeof tileOfInterest !== \"string\") {\r\n                // It is a replaceable tile, so fill it from the new anomalies list\r\n                possibleTiles[currentTileIndex] = replacementTiles.shift()\r\n                numTilesToReplace -= 1;\r\n            }\r\n            currentTileIndex -= 1;\r\n        }\r\n\r\n        // Undo the reverse from before\r\n        if (reverseBeforeAndAfter) {\r\n            possibleTiles = possibleTiles.reverse()\r\n        }\r\n\r\n        return possibleTiles\r\n    }\r\n\r\n    // TODO rename from planet to tile\r\n    getWeightedPlanetList(possiblePlanets, weights, ensuredAnomalies) {\r\n        // Generate an array of tuples where the first element is the plant's tile number and the second is its weight\r\n        let planetWeights = [];\r\n        for (let planetTileNumber in possiblePlanets) {\r\n            planetWeights.push([possiblePlanets[planetTileNumber], this.getWeight(possiblePlanets[planetTileNumber], weights, ensuredAnomalies)])\r\n        }\r\n\r\n        // Sort the returned list by weight, with higher weighted planets being first\r\n        planetWeights.sort(function(a, b) {\r\n            return b[1] - a[1];\r\n        })\r\n\r\n        // Do a little post process shuffling for roughly similar planets\r\n        let currentIndex = 0;\r\n        let currentHighValue = planetWeights[0][1];\r\n        let currentSetToShuffle = [];\r\n        let postPossiblePlanets = [];\r\n        while (currentIndex < planetWeights.length) {\r\n            let planetWeight = planetWeights[currentIndex];\r\n            // Something in this array, lets see if we add to it\r\n            if (planetWeight[1] >= (currentHighValue + 10)) { //- this.state.shuffleThreshold)) { [@KSL switch off post process shuffling]\r\n                // Add this item to the array to shuffle\r\n                currentSetToShuffle.push(planetWeight);\r\n            } else {\r\n                // We are now outside our shuffle range. So shuffle what we have, and add it to the post\r\n                currentSetToShuffle = this.shuffle(currentSetToShuffle)\r\n                postPossiblePlanets = postPossiblePlanets.concat(currentSetToShuffle)\r\n                currentSetToShuffle = [planetWeight]\r\n                currentHighValue = planetWeight[1]\r\n            }\r\n\r\n            currentIndex += 1;\r\n        }\r\n        currentSetToShuffle = this.shuffle(currentSetToShuffle)\r\n        postPossiblePlanets = postPossiblePlanets.concat(currentSetToShuffle)\r\n\r\n//debugger;\r\n        // Convert from tuple down to just the tile number\r\n        let orderedPlanets = [];\r\n        for (let weightedPlanet in postPossiblePlanets) {\r\n            orderedPlanets.push(postPossiblePlanets[weightedPlanet][0]);\r\n        }\r\n\r\n        return orderedPlanets\r\n    }\r\n\r\n    getWeight(planetTileNumber, weights, ensuredAnomalies) {\r\n        let total_weight = 0\r\n        let tile = tileData.all[planetTileNumber.toString()]\r\n\r\n        // Go over all the planets in this tile and add up their values\r\n        for (let planetIndex in tile['planets']) {\r\n            let planet = tile['planets'][planetIndex]\r\n            total_weight += (planet['resources'] / 4) * weights['resource']\r\n            total_weight += (planet['influence'] / 4) * weights['influence']\r\n            total_weight += (weights['planet_count'] / 2)\r\n            total_weight += planet['specialty'] ? weights['specialty'] : 0\r\n        }\r\n\r\n        // Handle anomalies\r\n        if (tile['anomaly'] != null) { //tile['type'] === 'red') { @KSL changed\r\n            total_weight += weights['anomaly'] ; //+ 40; @KSL changed\r\n            // Providing bonuses to these sections mean the other ones are never used\r\n            // if (tile['anomaly'] === null\r\n            //     || tile['anomaly'] === 'asteroid-field'\r\n            //     || tile['anomaly'] === 'gravity-rift') {\r\n            //     // Give an extra boost to these anomalies, as they are easier to cross than others\r\n            //     total_weight += 20;  // Change total back to 30 if using this\r\n            // }\r\n        }\r\n        total_weight += tile['wormhole'] ? weights['wormhole'] : 0\r\n        total_weight += ensuredAnomalies.indexOf(planetTileNumber) > -1 ? weights['racial'] : 0\r\n\r\n        return total_weight\r\n    }\r\n    togglePickRacesHelp(event) {\r\n        this.setState({\r\n            pickRacesHelp: !this.state.pickRacesHelp\r\n        })\r\n    }\r\n    toggleBoardStyleHelp(event) {\r\n        this.setState({\r\n            boardStyleHelp: !this.state.boardStyleHelp\r\n        })\r\n    }\r\n    togglePlacementStyleHelp(event) {\r\n        this.setState({\r\n            placementStyleHelp: !this.state.placementStyleHelp\r\n        })\r\n    }\r\n    togglePickStyleHelp(event) {\r\n        this.setState({\r\n            pickStyleHelp: !this.state.pickStyleHelp\r\n        })\r\n    }\r\n    toggleSetPlayerNamesHelp(event) {\r\n        this.setState({\r\n            setPlayerNamesHelp: !this.state.setPlayerNamesHelp\r\n        })\r\n    }\r\n    toggleSetRacesHelp(event) {\r\n        this.setState({\r\n            setRacesHelp: !this.state.setRacesHelp\r\n        })\r\n    }\r\n    togglePickMultipleRacesHelp(event) {\r\n        this.setState({\r\n            pickMultipleRacesHelp: !this.state.pickMultipleRacesHelp\r\n        })\r\n    }\r\n    toggleShufflePriorityHelp(event) {\r\n        this.setState({\r\n            shufflePriorityHelp: !this.state.shufflePriorityHelp\r\n        })\r\n    }\r\n    toggleReversePlacementOrderHelp(event) {\r\n        this.setState({\r\n            reversePlacementOrderHelp: !this.state.reversePlacementOrderHelp\r\n        })\r\n    }\r\n    toggleEnsureRacialAnomaliesHelp(event) {\r\n        this.setState({\r\n            ensureRacialAnomaliesHelp: !this.state.ensureRacialAnomaliesHelp\r\n        })\r\n    }\r\n\ttoggleHideRaceTilesHelp(event) {\r\n        this.setState({\r\n            hideRaceTilesHelp: !this.state.hideRaceTilesHelp\r\n        })\r\n    }\r\n\ttoggleGenIterHelp(event) {\r\n        this.setState({\r\n            setIterationsHelp: !this.state.setIterationsHelp\r\n        })\r\n    }\r\n\ttoggleStopCritHelp(event) {\r\n        this.setState({\r\n            setStopCritHelp: !this.state.setStopCritHelp\r\n        })\r\n    }\r\n\r\n\t//KSL START\r\n\tgetSliceData(newTiles) {\r\n\t\t//let homeTiles = boardData.styles[\"6\"][\"KSL2\"][\"home_worlds\"];\r\n\t\tlet homeTiles = boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle]['home_worlds']\r\n\r\n\t\t//The function \"getNewTilesToPlace()\" from \"mapoptions.js\" needs to be invoked first in order to instantiate the \"systemIndexes\" array listing all tile indexes on the board\r\n\t\t//let systemIndexes = [7, 9, 11, 13, 15, 17, 33, 30, 27, 24, 21, 36, 8, 10, 12 , 14, 16, 18, 6, 5, 4, 3, 2, 1, 20, 23, 26, 29, 32, 35];\r\n\t\t\r\n\t\tlet primary = [...boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle][\"primary_tiles\"]];\r\n        let secondary = [...boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle][\"secondary_tiles\"]];\r\n        let tertiary = [...boardData.styles[this.state.currentNumberOfPlayers.toString()][this.state.currentBoardStyle][\"tertiary_tiles\"]];\r\n\t\tlet numTiles = primary.length + secondary.length + tertiary.length + homeTiles.length + 1;\r\n\r\n\t\t//the \"newTiles\" array listing all systems on the board needs to be instantiated\r\n\t\t//let newTiles = this.props.tiles;\r\n\t\t\r\n\t\tif (newTiles != null && newTiles != undefined && newTiles.length > 0) {\r\n\t\tdebugger;\r\n\t\tlet systemIndexes = [];\r\n\t\tif (true) {\r\n\t\t\t//This should work for any type of map\r\n\t\t\tsystemIndexes = this.getNewTilesToPlace();\r\n\t\t\tsystemIndexes = systemIndexes.concat(homeTiles);\r\n\t\t\tsystemIndexes.push(0);\r\n\t\t} else {\r\n\t\t\tfor (let i = 0; i < newTiles.length; i++) {\r\n\t\t\t\t//Works for all regular boards, where all indexes below numTiles are on the board. However, for oddly shaped boards, it does not work\r\n\t\t\t\tif (i < numTiles) { //newTiles[i] > -1) {\r\n\t\t\t\t\tsystemIndexes.push(i);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t//This does not work if the map is not completely generated yet\r\n\t\t\t\t//if (newTiles[i] > -1) {\r\n\t\t\t\t//\tsystemIndexes.push(i);\r\n\t\t\t\t//}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\tlet weights = {};\r\n\t\t\tswitch (this.state.currentPickStyle) {\r\n\t\t\t\tcase \"random\":\r\n\t\t\t\t\t//this.shuffle(newSystems)\r\n\t\t\t\t\t//return newSystems\r\n\t\t\t\tcase \"custom\":\r\n\t\t\t\t\tweights = {\r\n\t\t\t\t\t\t\"resource\": parseInt(this.state.resourceWeight),\r\n\t\t\t\t\t\t\"influence\": parseInt(this.state.influenceWeight),\r\n\t\t\t\t\t\t\"planet_count\": parseInt(this.state.planetCountWeight),\r\n\t\t\t\t\t\t\"specialty\": parseInt(this.state.specialtyWeight),\r\n\t\t\t\t\t\t\"anomaly\": parseInt(this.state.anomalyWeight),\r\n\t\t\t\t\t\t\"wormhole\": parseInt(this.state.wormholeWeight),\r\n\t\t\t\t\t\t\"racial\": parseInt(this.state.wormholeWeight) - 5\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"resource\":\r\n\t\t\t\t\tweights = {\r\n\t\t\t\t\t\t\"resource\": 100,\r\n\t\t\t\t\t\t\"influence\": 10,\r\n\t\t\t\t\t\t\"planet_count\": 10,\r\n\t\t\t\t\t\t\"specialty\": 10,\r\n\t\t\t\t\t\t\"anomaly\": 10,\r\n\t\t\t\t\t\t\"wormhole\": 10,\r\n\t\t\t\t\t\t\"racial\": 5\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"influence\":\r\n\t\t\t\t\tweights = {\r\n\t\t\t\t\t\t\"resource\": 10,\r\n\t\t\t\t\t\t\"influence\": 100,\r\n\t\t\t\t\t\t\"planet_count\": 10,\r\n\t\t\t\t\t\t\"specialty\": 10,\r\n\t\t\t\t\t\t\"anomaly\": 10,\r\n\t\t\t\t\t\t\"wormhole\": 10,\r\n\t\t\t\t\t\t\"racial\": 5\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"KSL\":\r\n\t\t\t\t\tweights = {\r\n\t\t\t\t\t\t\"resource\": 80,\r\n\t\t\t\t\t\t\"influence\": 40,\r\n\t\t\t\t\t\t\"planet_count\": 10,\r\n\t\t\t\t\t\t\"specialty\": 50,\r\n\t\t\t\t\t\t\"anomaly\": 10,\r\n\t\t\t\t\t\t\"wormhole\": 10,\r\n\t\t\t\t\t\t\"racial\": 5\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"balanced\":\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tif (this.props.useProphecyOfKings) {\r\n\t\t\t\t\t\tweights = {\r\n\t\t\t\t\t\t\t\"resource\": 80,\r\n\t\t\t\t\t\t\t\"influence\": 30,\r\n\t\t\t\t\t\t\t\"planet_count\": 15,\r\n\t\t\t\t\t\t\t\"specialty\": 50,\r\n\t\t\t\t\t\t\t\"anomaly\": 40,\r\n\t\t\t\t\t\t\t\"wormhole\": 25,\r\n\t\t\t\t\t\t\t\"racial\": 20\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tweights = {\r\n\t\t\t\t\t\t\t\"resource\": 80,\r\n\t\t\t\t\t\t\t\"influence\": 30,\r\n\t\t\t\t\t\t\t\"planet_count\": 15,\r\n\t\t\t\t\t\t\t\"specialty\": 40,\r\n\t\t\t\t\t\t\t\"anomaly\": 30,\r\n\t\t\t\t\t\t\t\"wormhole\": 25,\r\n\t\t\t\t\t\t\t\"racial\": 20\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\r\n\t\t\t//DETERMINE ADJACENCY DATA\r\n\r\n\t\t\tlet playerCounter = 1;\r\n\t\t\t\r\n\t\t\t//Array including one object per player. Each object contains the player identifier, the hometile, and the adjacency data\r\n\t\t\tlet allAdjData = [];\r\n\t\t\t\r\n\t\t\t//Array including one array per player, the adjacency data. This is a multidimensional array with the first element being the distance, and the second being the list of tile indexes at this distance\r\n\t\t\tlet allAdjDataArray = [];\r\n\r\n\r\n\t\t\tfor (let homeTile of homeTiles) {\r\n\t\t\t  let playerAdjData = [];\r\n\t\t\t  let tilesAlreadyListed = [];\r\n\t\t\t  \r\n\t\t\t  //List all tiles up to a distance of 6 away: increase the limit if larger boards need to be accomodated\r\n\t\t\t  for (let distance = 0; distance < 7; distance++) {\r\n\t\t\t\t\r\n\t\t\t\tlet thisTileArray = [];\r\n\t\t\t\tif (distance === 0){\r\n\t\t\t\t  thisTileArray = [homeTile];\r\n\t\t\t\t  tilesAlreadyListed.push(homeTile);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor (let startTile of playerAdjData[distance-1]) {\r\n\t\t\t\t\t//loop over all tiles in previous distance and list all adjacent tiles that are not listed yet\r\n\t\t\t\t\t  let adjArray = adjacencyData[startTile];\r\n\t\t\t\t\t  \r\n\t\t\t\t\t  for (let adjacentTile of adjArray) {\r\n\t\t\t\t\t\tif (tilesAlreadyListed.indexOf(adjacentTile) < 0){\r\n\t\t\t\t\t\t  //if this tile was not already identified closer to the hometile\r\n\t\t\t\t\t\t  if (systemIndexes.indexOf(adjacentTile) >= 0 || homeTiles.indexOf(adjacentTile) >= 0 || adjacentTile == \"0\") {\r\n\t\t\t\t\t\t\t//and if this tile is on the board\r\n\t\t\t\t\t\t\t//Then add tile to the array of adjacent tiles and add it to the alreadylisted tiles\r\n\t\t\t\t\t\t\ttilesAlreadyListed.push(adjacentTile);\r\n\t\t\t\t\t\t\tthisTileArray.push(adjacentTile); \r\n\t\t\t\t\t\t  }\r\n\t\t\t\t\t\t  \r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t  //if this tile was already identified closer to the hometile\r\n\t\t\t\t\t\t  //Then jump over it and do nothing          \r\n\t\t\t\t\t\t}            \r\n\t\t\t\t\t  }\r\n\t\t\t\t\t}     \r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t//TODO test what happens if thisTileArray is empty => should push an empty array, but still take up a \"position\"\r\n\t\t\t\tplayerAdjData.push(thisTileArray);\r\n\t\t\t\t\r\n\t\t\t  }\r\n\t\t\t  //console.log(\"Distance: \" + distance + \" PlayerAdjData level 0: \" + playerAdjData[0] + \" PlayerAdjData level 1: \" + playerAdjData[1]);\r\n\t\t\t  let newAdjData = {Player:\"P\"+playerCounter, HomeTile:homeTile, Distances:playerAdjData};\r\n\t\t\t  \r\n\t\t\t  allAdjData.push(newAdjData);\r\n\t\t\t  allAdjDataArray.push(playerAdjData);\r\n\t\t\t  playerCounter++;\r\n\t\t\t}\r\n\r\n\t\t\t//SLICE determination\r\n\t\t\t// go over all tiles on the board, ie in \"SystemIndexes\"\r\n\t\t\t// check to which HS it is the closest, and add to the slice of this player\r\n\t\t\t// also list the tiles that are equidistant between this player and another player\r\n\r\n\t\t\tlet allSliceData = [];\r\n\t\t\tlet allSliceDataArray = [];\r\n\t\t\tlet allSliceEquidistArray = [];\r\n\r\n\t\t\tfor (let thisplayer = 0; thisplayer < allAdjDataArray.length; thisplayer++) {\r\n\t\t\t  allSliceDataArray.push([]);\r\n\t\t\t  allSliceEquidistArray.push([]);\r\n\t\t\t}\r\n\r\n\t\t\tfor (let systemIndex of systemIndexes) {\r\n\t\t\t  \r\n\t\t\t\tlet distanceToPlayerX = [];\r\n\t\t\t\t//loop over all players\r\n\t\t\t\tfor (let thisplayer = 0; thisplayer < allAdjDataArray.length; thisplayer++) {\r\n\t\t\t\t\tlet tileFound = false;\r\n\t\t\t\t\tlet thisDistance = 0;\r\n\t\t\t\t\tdo {\r\n\t\t\t\t\t\tif (allAdjDataArray[thisplayer][thisDistance].indexOf(systemIndex) >= 0) {\r\n\t\t\t\t\t\t\tdistanceToPlayerX.push(thisDistance);\r\n\t\t\t\t\t\t\ttileFound = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t  \r\n\t\t\t\t\t\tthisDistance++;\r\n\t\t\t\t\t\tif (thisDistance >= allAdjDataArray[thisplayer].length) {\r\n\t\t\t\t\t\t\ttileFound = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\twhile (!tileFound);\r\n\t\t\t\t}\r\n\t\t\t  \r\n\t\t\t\tlet shortestDistance = 999;\r\n\t\t\t\tlet thePlayer = 999;\r\n\t\t\t\tlet equidistPlayers = [];\r\n\t\t\t\tlet equiDistTile = false;\r\n\t\t\t  \r\n\t\t\t\tfor (let thisplayer = 0; thisplayer < allAdjDataArray.length; thisplayer++) {\r\n\t\t\t\t\tif (distanceToPlayerX[thisplayer] < shortestDistance) {\r\n\t\t\t\t\t\tshortestDistance = distanceToPlayerX[thisplayer];\r\n\t\t\t\t\t\tthePlayer = thisplayer;\r\n\t\t\t\t\t\tequiDistTile = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (distanceToPlayerX[thisplayer] == shortestDistance) {\r\n\t\t\t\t\t\tequiDistTile = true;\r\n\t\t\t\t\t\tthePlayer = 999;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t  \r\n\t\t\t\t}\r\n\t\t\t\tif (thePlayer < 999 && shortestDistance > 0) {  //second check to exclude home system from slice\r\n\t\t\t\t\tallSliceDataArray[thePlayer].push(systemIndex);\r\n\t\t\t\t}\r\n\t\t\t\tfor (let i=0; i<distanceToPlayerX.length; i++) {\r\n\t\t\t\t\tif (distanceToPlayerX[i] == shortestDistance && equiDistTile) {\r\n\t\t\t\t\t\tallSliceEquidistArray[i].push(systemIndex);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (let j = 0; j < allAdjDataArray.length; j++) {\r\n\t\t\t\tlet thisPlayer = j+1;\r\n\t\t\t\tlet newAllSliceData = {Player:\"P\"+thisPlayer, HomeTile:allAdjData[j].HomeTile, Slice:allSliceDataArray[j], Equidistant:allSliceEquidistArray[j]};\r\n\t\t\t\tallSliceData.push(newAllSliceData);\r\n\t\t\t}\r\n\r\n\t\t\tlet fullSliceData = [];\r\n\t\t\t\r\n\t\t\t//loop over all players\r\n\t\t\tfor (let j = 0; j < allAdjDataArray.length; j++) {\r\n\t\t\t\tlet thisPlayer = j+1;\r\n\t\t\t\tlet resources = 0;\r\n\t\t\t\tlet influence = 0;\r\n\t\t\t\tlet numPlanets = 0;\r\n\t\t\t\tlet specialties = 0;\r\n\t\t\t\tlet wormholes = 0;\r\n\t\t\t\tlet anomalies = 0;\r\n\t\t\t  \r\n\t\t\t\t//Get slice characteristics\r\n\t\t\t\tfor (let tileNumber of allSliceDataArray[j]) {\r\n\t\t\t\t\tlet thisSystem = newTiles[tileNumber];\r\n\t\t\t\t\tif (thisSystem > 0){\r\n\t\t\t\t\t\tlet tile = tileData.all[thisSystem.toString()];\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tfor (let planetIndex in tile['planets']) {\r\n\t\t\t\t\t\t\tlet planet = tile['planets'][planetIndex];\r\n\t\t\t\t\t\t\tresources += planet['resources'];\r\n\t\t\t\t\t\t\tinfluence += planet['influence'];\r\n\t\t\t\t\t\t\tnumPlanets++;\r\n\t\t\t\t\t\t\tspecialties += planet['specialty'] ? 1 : 0;\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\twormholes += tile['wormhole'] ? 1 : 0;\r\n\t\t\t\t\t\tif (tile['anomaly'] != null) {\r\n\t\t\t\t\t\t\t//TODO: not all red are anomalies!\r\n\t\t\t\t\t\t\tanomalies++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t  \r\n\t\t\t\tlet resourcesEQ = 0;\r\n\t\t\t\tlet influenceEQ = 0;\r\n\t\t\t\tlet numPlanetsEQ = 0;\r\n\t\t\t\tlet specialtiesEQ = 0;\r\n\t\t\t\tlet wormholesEQ = 0;\r\n\t\t\t\tlet anomaliesEQ = 0;\r\n\t\t\t  \r\n\t\t\t\t//Get Equidistant characteristics\r\n\t\t\t\tfor (let tileNumber of allSliceEquidistArray[j]) {\r\n\t\t\t\t\tlet thisSystem = newTiles[tileNumber];\r\n\t\t\t\t\tif (thisSystem > 0){\r\n\t\t\t\t\t\tlet tile = tileData.all[thisSystem.toString()];\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tfor (let planetIndex in tile['planets']) {\r\n\t\t\t\t\t\t\tlet planet = tile['planets'][planetIndex];\r\n\t\t\t\t\t\t\tresourcesEQ += planet['resources'];\r\n\t\t\t\t\t\t\tinfluenceEQ += planet['influence'];\r\n\t\t\t\t\t\t\tnumPlanetsEQ++;\r\n\t\t\t\t\t\t\tspecialtiesEQ += planet['specialty'] ? 1 : 0;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\twormholesEQ += tile['wormhole'] ? 1 : 0;\r\n\t\t\t\t\t\tif (tile['anomaly'] != null) {\r\n\t\t\t\t\t\t\t//TODO: not all red are anomalies!\r\n\t\t\t\t\t\t\tanomaliesEQ++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t  \r\n\t\t\t\tlet resourcesHS = 0;\r\n\t\t\t\tlet influenceHS = 0;\r\n\t\t\t\tlet numPlanetsHS = 0;\r\n\t\t\t\tlet specialtiesHS = 0;\r\n\t\t\t\tlet wormholesHS = 0;\r\n\t\t\t\t// debugger;\r\n\t\t\t\tlet thisHomeTile = allAdjData[j].HomeTile;\r\n\t\t\t\tlet thisSystem = newTiles[thisHomeTile];\r\n\t\t\t\tif (thisSystem > 0){\r\n\t\t\t\t\tlet tile = tileData.all[thisSystem.toString()];\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor (let planetIndex in tile['planets']) {\r\n\t\t\t\t\t\tlet planet = tile['planets'][planetIndex];\r\n\t\t\t\t\t\tresourcesHS += planet['resources'];\r\n\t\t\t\t\t\tinfluenceHS += planet['influence'];\r\n\t\t\t\t\t\tnumPlanetsHS++;\r\n\t\t\t\t\t\tspecialtiesHS += planet['specialty'] ? 1 : 0;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t} \r\n\t\t\t\t\twormholesHS += tile['wormhole'] ? 1 : 0;\r\n\t\t\t\t}\r\n\t\t\t  //debugger;\r\n\t\t\t\tlet sliceWeight = 0;\r\n\t\t\t\tsliceWeight += (resources / 4) * weights['resource'];\r\n\t\t\t\tsliceWeight += (influence / 4) * weights['influence'];\r\n\t\t\t\tsliceWeight += (numPlanets / 2) * weights['planet_count'];\r\n\t\t\t\tsliceWeight += specialties * weights['specialty'];\r\n\t\t\t\tsliceWeight += wormholes * weights['wormhole'];\r\n\t\t\t\tsliceWeight += anomalies * (weights['anomaly']);\r\n\t\t\t  \r\n\t\t\t\tlet EQWeight = 0;\r\n\t\t\t\tEQWeight += (resourcesEQ / 4) * weights['resource'];\r\n\t\t\t\tEQWeight += (influenceEQ / 4) * weights['influence'];\r\n\t\t\t\tEQWeight += (numPlanetsEQ / 2) * weights['planet_count'];\r\n\t\t\t\tEQWeight += specialtiesEQ * weights['specialty'];\r\n\t\t\t\tEQWeight += wormholesEQ * weights['wormhole'];\r\n\t\t\t\tEQWeight += anomaliesEQ * (weights['anomaly']);\r\n\t\t\t  \r\n\t\t\t\tlet HSWeight = 0;\r\n\t\t\t\tHSWeight += (resourcesHS / 4) * weights['resource'];\r\n\t\t\t\tHSWeight += (influenceHS / 4) * weights['influence'];\r\n\t\t\t\tHSWeight += (numPlanetsHS / 2);\r\n\t\t\t\tHSWeight += specialtiesHS * weights['specialty'];\r\n\t\t\t\tHSWeight += wormholesHS * weights['wormhole'];\r\n\t\t\t\t//HSWeight += anomaliesHS * weights['anomaly'] + 40;\r\n\t\t\t  \r\n\t\t\t\tlet totalWeight = sliceWeight + 0.5*EQWeight;\r\n\t\t\t\t//debugger;\r\n\t\t\t\tlet playerWeight = 0;\r\n\t\t\t\t//alternative weight calculation\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\tfor (let tileNumber of allSliceDataArray[j]) {\r\n\t\t\t\t\tlet thisSystem = newTiles[tileNumber];\r\n\t\t\t\t\tif (thisSystem > 0){\r\n\t\t\t\t\t\tlet thisWeight = this.getWeight(thisSystem, weights, []);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet foundDistance = false;\r\n\t\t\t\t\t\tlet distance = 0;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tdo {\r\n\t\t\t\t\t\t\tlet theArray = allAdjDataArray[j][distance];\r\n\t\t\t\t\t\t\tif (theArray.indexOf(tileNumber) > -1) {\r\n\t\t\t\t\t\t\t\tfoundDistance = true;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdistance++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} while (!foundDistance && distance < allAdjDataArray[j].length)\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (foundDistance) {\r\n\t\t\t\t\t\t\tswitch (distance) {\r\n\t\t\t\t\t\t\t\tcase 0:\r\n\t\t\t\t\t\t\t\t\tplayerWeight += thisWeight;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\t\t\t\tplayerWeight += 0.75*thisWeight;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\t\t\tplayerWeight += 0.5*thisWeight;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\t\t\tplayerWeight += 0.25*thisWeight;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfor (let tileNumber of allSliceEquidistArray[j]) {\r\n\t\t\t\t\tlet thisSystem = newTiles[tileNumber];\r\n\t\t\t\t\tif (thisSystem > 0){\r\n\t\t\t\t\t\tlet thisWeight = this.getWeight(thisSystem, weights, []);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet foundDistance = false;\r\n\t\t\t\t\t\tlet distance = 0;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tdo {\r\n\t\t\t\t\t\t\tlet theArray = allAdjDataArray[j][distance];\r\n\t\t\t\t\t\t\tif (theArray.indexOf(tileNumber) > -1) {\r\n\t\t\t\t\t\t\t\tfoundDistance = true;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdistance++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} while (!foundDistance && distance < allAdjDataArray[j].length)\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (foundDistance) {\r\n\t\t\t\t\t\t\tswitch (distance) {\r\n\t\t\t\t\t\t\t\tcase 0:\r\n\t\t\t\t\t\t\t\t\tplayerWeight += 0.5*thisWeight;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\t\t\t\tplayerWeight += 0.5*0.75*thisWeight;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\t\t\tplayerWeight += 0.5*0.5*thisWeight;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\t\t\tplayerWeight += 0.5*0.25*thisWeight;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tlet sliceTiles = [];\r\n\t\t\t\tfor (let k = 0;k < allSliceDataArray[j].length; k++) {\r\n\t\t\t\t\tlet tIndex = allSliceDataArray[j][k];\r\n\t\t\t\t\tsliceTiles[k] = newTiles[tIndex];\r\n\t\t\t\t}\r\n\t\t\t  \r\n\t\t\t  \r\n\t\t\t\tlet newAllSliceData = {Player:\"P\"+thisPlayer, HomeTile:allAdjData[j].HomeTile, Slice:allSliceDataArray[j], Equidistant:allSliceEquidistArray[j], SliceTiles:sliceTiles, HomeResources:resourcesHS, HomeInfluence:influenceHS, HomePlanets:numPlanetsHS, HomeSpecialties:specialtiesHS, HomeWormholes:wormholesHS, SliceResources:resources, SliceInfluence:influence, SlicePlanets:numPlanets, SliceSpecialties:specialties, SliceWormholes:wormholes, SliceAnomalies:anomalies, EQResources:resourcesEQ, EQInfluence:influenceEQ, EQPlanets:numPlanetsEQ, EQSpecialties:specialtiesEQ, EQWormholes:wormholesEQ, EQAnomalies:anomaliesEQ, SliceWeight:sliceWeight, EQWeight:EQWeight, HSWeight:HSWeight, TotalWeight:totalWeight, PlayerWeight:playerWeight, UsedWeights:weights};\r\n\t\t\t\tfullSliceData.push(newAllSliceData);\r\n\t\t\t}\r\n\t\t\r\n\t\t\treturn fullSliceData;\r\n\t\t\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\t\r\n/*\r\n\t\tfor (let j = 0; j < allAdjDataArray.length; j++){\r\n\t\t  \r\n\t\t  document.write(\"Player: \" + fullSliceData[j].Player + \" - Hometile: \" + fullSliceData[j].HomeTile + \" - Tiles in slice: \" + fullSliceData[j].Slice + \" - Equidistant tiles: \" + fullSliceData[j].Equidistant + \"<br>--- RES in HS: \" + fullSliceData[j].HomeResources + \" - INF in HS: \" + fullSliceData[j].HomeInfluence + \" - Planets in HS: \" + fullSliceData[j].HomePlanets + \" - SPEC in HS: \" + fullSliceData[j].HomeSpecialties + \" - Wormholes in HS: \" + fullSliceData[j].HomeWormholes + \"<br>--- RES in slice: \" + fullSliceData[j].SliceResources + \" - INF in slice: \" + fullSliceData[j].SliceInfluence + \" - Planets in slice: \" + fullSliceData[j].SlicePlanets + \" - SPEC in slice: \" + fullSliceData[j].SliceSpecialties + \" - Wormholes in slice: \" + fullSliceData[j].SliceWormholes + \" - Anomalies in slice: \" + fullSliceData[j].SliceAnomalies + \"<br>--- RES in EQD: \" + fullSliceData[j].EQResources + \" - INF in EQD: \" + fullSliceData[j].EQInfluence + \" - Planets in EQD: \" + fullSliceData[j].EQPlanets + \" - SPEC in EQD: \" + fullSliceData[j].EQSpecialties + \" - Wormholes in EQD: \" + fullSliceData[j].EQWormholes + \" - Anomalies in EQD: \" + fullSliceData[j].EQAnomalies + \"<br>--- Slice Weight: \" + fullSliceData[j].SliceWeight + \" - EQ Weight: \" + fullSliceData[j].EQWeight + \" - HS Weight: \" + fullSliceData[j].HSWeight + \" - Total Weight: \" + fullSliceData[j].TotalWeight + \"<br>\");\r\n\t\t}*/\r\n\t}\t\t\t\r\n\t\r\n\t//KSL END\t\r\n\t\r\n    render() {\r\n        return (\r\n            <div id=\"options\" className={this.props.visible ? \"\" : \"d-none\"}>\r\n                <div className=\"title\">\r\n                    <h4 className=\"text-center\">Generation Options</h4>\r\n                </div>\r\n                <form id=\"generateForm\" onSubmit={this.generateBoard}>\r\n\r\n                    <div className=\"custom-control custom-checkbox mb-3\">\r\n                        <input type=\"checkbox\" className=\"custom-control-input\" id=\"pokExpansion\" name=\"useProphecyOfKings\" checked={this.props.useProphecyOfKings} onChange={this.updatePok} />\r\n                        <label className=\"custom-control-label\" htmlFor=\"pokExpansion\">Use Prophecy of Kings Expansion</label>\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label htmlFor=\"playerCount\">Number of Players</label>\r\n                        <select className=\"form-control\" id=\"playerCount\" name=\"currentNumberOfPlayers\" value={this.state.currentNumberOfPlayers} onChange={this.updatePlayerCount}>\r\n                            {this.state.currentNumberOfPlayersOptions.map((x) => <option key={x} value={x}>{x}</option>)}\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label htmlFor=\"boardStyle\" className=\"d-flex\">Board Style\r\n                            <QuestionCircle className=\"icon\" onClick={this.toggleBoardStyleHelp} />\r\n                        </label>\r\n                        <select className=\"form-control\" id=\"boardStyle\" name=\"currentBoardStyle\" value={this.state.currentBoardStyle} onChange={this.updateBoardStyle}>\r\n                            {this.state.currentBoardStyleOptions.map((x) => <option key={x} value={x}>{this.capitalize(x)}</option>)}\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label htmlFor=\"placementStyle\" className=\"d-flex\">Placement Style\r\n                            <QuestionCircle className=\"icon\" onClick={this.togglePlacementStyleHelp} />\r\n                        </label>\r\n                        <select className=\"form-control\" id=\"placementStyle\" name=\"currentPlacementStyle\" value={this.state.currentPlacementStyle} onChange={this.handleInputChange}>\r\n                            {this.state.optionsPossible.placementStyles.map((x) => <option key={x} value={x}>{this.capitalize(x)}</option>)}\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label htmlFor=\"pickStyle\" className=\"d-flex\">System Weighting\r\n                            <QuestionCircle className=\"icon\" onClick={this.togglePickStyleHelp} />\r\n                        </label>\r\n                        <select className=\"form-control\" id=\"pickStyle\" name=\"currentPickStyle\" value={this.state.currentPickStyle} onChange={this.handleInputChange}>\r\n                            {this.state.optionsPossible.pickStyles.map((x) => <option key={x} value={x}>{this.capitalize(x)}</option>)}\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div className={\"ml-2 collapse \" + (this.state.currentPickStyle === \"custom\" ? \"show\" : \"\")} id=\"customPickStyle\">\r\n                        <div className=\"card card-body\">\r\n                            <label htmlFor=\"customResource\">Resource</label>\r\n                            <input type=\"range\" className=\"custom-range\" name=\"resourceWeight\" value={this.state.resourceWeight} onChange={this.handleInputChange} />\r\n\r\n                            <label htmlFor=\"customInfluence\">Influence</label>\r\n                            <input type=\"range\" className=\"custom-range\" name=\"influenceWeight\" value={this.state.influenceWeight} onChange={this.handleInputChange} />\r\n\r\n                            <label htmlFor=\"customPlanetCount\">Planet Count</label>\r\n                            <input type=\"range\" className=\"custom-range\" name=\"planetCountWeight\" value={this.state.planetCountWeight} onChange={this.handleInputChange} />\r\n\r\n                            <label htmlFor=\"customSpecialty\">Specialty</label>\r\n                            <input type=\"range\" className=\"custom-range\" name=\"specialtyWeight\" value={this.state.specialtyWeight} onChange={this.handleInputChange} />\r\n\r\n                            <label htmlFor=\"customAnomaly\">Anomaly</label>\r\n                            <input type=\"range\" className=\"custom-range\" name=\"anomalyWeight\" value={this.state.anomalyWeight} onChange={this.handleInputChange} />\r\n\r\n                            <label htmlFor=\"customWormhole\">Wormhole</label>\r\n                            <input type=\"range\" className=\"custom-range\" name=\"wormholeWeight\" value={this.state.wormholeWeight} onChange={this.handleInputChange} />\r\n                        </div>\r\n                    </div>\r\n\r\n\r\n                    <div className=\"form-group\">\r\n                        <label htmlFor=\"seed\">Specific Seed</label>\r\n                        <input className=\"form-control\" id=\"seed\" name=\"updateSeed\" type=\"text\" placeholder=\"Enter a number to seed generation...\" value={this.state.currentSeed} onChange={this.updateSeed} />\r\n                    </div>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<div className=\"form-group\">\r\n                        <label htmlFor=\"geniters\">Board Generation Iteration Number (limit at 50)<QuestionCircle className=\"icon\" onClick={this.toggleGenIterHelp} /></label>\r\n\t\t\t\t\t\t\r\n                        <input className=\"form-control\" id=\"geniters\" name=\"resetGenIters\" type=\"text\" placeholder=\"Iteration Number...\" value={this.state.generationIterations} onChange={this.resetGenerationIterations} />\r\n\t\t\t\t\t\t\r\n                    </div>\r\n\t\t\t\t\t<div className=\"form-group\">\r\n                        <label htmlFor=\"stopCriterion\">Balance Convergence Limit (relative)<QuestionCircle className=\"icon\" onClick={this.toggleStopCritHelp} /></label>\r\n\t\t\t\t\t\t\r\n                        <input className=\"form-control\" id=\"stopCriterion\" name=\"stopCriterion\" type=\"text\" placeholder=\"Stopping Criterion\" value={this.state.stopCriterion} onChange={this.resetStopCriterion} />\r\n\t\t\t\t\t\t\r\n                    </div>\r\n\r\n                    <div className=\"custom-control custom-checkbox mb-3 d-flex\">\r\n                        <input type=\"checkbox\" className=\"custom-control-input\" id=\"pickRaces\" name=\"pickRaces\" checked={this.state.pickRaces} onChange={this.handleInputChange} />\r\n                        <label className=\"custom-control-label\" htmlFor=\"pickRaces\">Pick Races for Players</label>\r\n                        <QuestionCircle className=\"icon\" onClick={this.togglePickRacesHelp} />\r\n                    </div>\r\n                    <div className={\"ml-2 mb-2 collapse \" + (this.state.pickRaces ? \"show\" : \"\")} id=\"pickRacesCollapse\">\r\n                        <div className=\"card card-body\">\r\n                            <button type=\"button\" className=\"btn btn-outline-primary mb-2\" onClick={this.toggleSetRacesHelp}>Set Included Races</button>\r\n\r\n                            <button type=\"button\" className=\"btn btn-outline-primary mb-2\" onClick={this.toggleSetPlayerNamesHelp}>Set Player Names</button>\r\n                            \r\n                            <div className=\"custom-control custom-checkbox d-flex\">\r\n                                <input type=\"checkbox\" className=\"custom-control-input\" id=\"ensureRacialAnomalies\" name=\"ensureRacialAnomalies\" checked={this.state.ensureRacialAnomalies} onChange={this.handleInputChange} />\r\n                                <label className=\"custom-control-label\" htmlFor=\"ensureRacialAnomalies\">Ensure Racial Anomalies</label>\r\n                                <QuestionCircle className=\"icon\" onClick={this.toggleEnsureRacialAnomaliesHelp} />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"custom-control custom-checkbox mb-3 d-flex\">\r\n                        <input type=\"checkbox\" className=\"custom-control-input\" id=\"shuffleBoards\" name=\"shuffleBoards\" checked={this.state.shuffleBoards} onChange={this.handleInputChange} />\r\n                        <label className=\"custom-control-label\" htmlFor=\"shuffleBoards\">Randomize Priorities Before Placement</label>\r\n                        <QuestionCircle className=\"icon\" onClick={this.toggleShufflePriorityHelp} />\r\n                    </div>\r\n\r\n                    <div className=\"custom-control custom-checkbox mb-3 d-flex\">\r\n                        <input type=\"checkbox\" className=\"custom-control-input\" id=\"reversePlacementOrder\" name=\"reversePlacementOrder\" checked={this.state.reversePlacementOrder} onChange={this.handleInputChange} />\r\n                        <label className=\"custom-control-label\" htmlFor=\"reversePlacementOrder\">Reverse Placement Order</label>\r\n                        <QuestionCircle className=\"icon\" onClick={this.toggleReversePlacementOrderHelp} />\r\n                    </div>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<div className=\"custom-control custom-checkbox mb-3 d-flex\">\r\n                        <input type=\"checkbox\" className=\"custom-control-input\" id=\"hideRaceTiles\" name=\"hideRaceTiles\" checked={this.props.hideRaceTiles} onChange={this.updateHRT} />\r\n                        <label className=\"custom-control-label\" htmlFor=\"hideRaceTiles\">Hide Racial tiles on map</label>\r\n                        <QuestionCircle className=\"icon\" onClick={this.toggleHideRaceTilesHelp} />\r\n                    </div>\r\n\t\t\t\t\t\r\n\r\n                    <SetPlayerNameModal visible={this.state.setPlayerNamesHelp} currentPlayerNames={this.props.currentPlayerNames}\r\n                                        hideModal={this.toggleSetPlayerNamesHelp} handleNameChange={this.handleNameChange}\r\n                    />\r\n                    <SetRacesModal visible={this.state.setRacesHelp} races={this.state.optionsPossible.races}\r\n                                   pokRaces={this.state.optionsPossible.pokRaces} useProphecyOfKings={this.props.useProphecyOfKings}\r\n                                   currentRaces={this.props.currentRaces}\r\n                                   hideModal={this.toggleSetRacesHelp} handleRacesChange={this.handleRacesChange}\r\n                    />\r\n\r\n                    <HelpModal key={\"help-board\"} visible={this.state.boardStyleHelp} hideModal={this.toggleBoardStyleHelp} title={\"About Board Style\"}\r\n                         content='<p>\r\n                         Board style changes how the tiles are actually laid out on a newly generated map.\r\n                         <br>\r\n                         <br>\r\n                         Changing this would cause you to expect different hex layouts, such as different patterns of tiles, usage of hyperlanes, or unorthodox placement of home worlds.\r\n                         </p>'\r\n                    />\r\n                    <HelpModal key={\"help-placement\"} visible={this.state.placementStyleHelp} hideModal={this.togglePlacementStyleHelp} title={\"About Placement Style\"}\r\n                         content='<p>\r\n                         Placement style dictates where important tiles are placed. Most revolve around having at least one tile near the home system with good resources.\r\n                         <br>\r\n                         <br>\r\n                         <br><b>Slice:</b> Places tiles like a normal player would. Prioritizes a good pathway to mecatol, and filling in the area around the home system with good tiles.\r\n                         <br><b>Initial:</b> Only guarantees a good tile right in front of the home system (on the way to mecatol). Everything else is random.\r\n                         <br><b>Home:</b> Prioritizes all of the adjacent tiles to the home system and everything else is random.\r\n                         <br><b>Random:</b> Shuffles the priority levels completely. No favoritism to tiles near the home system.\r\n\t\t\t\t\t\t <br><b>Fairness*:</b> Ensures a better distribution over players slices by alternating placement between players more optimally.\r\n\t\t\t\t\t\t <br><b>OptimalBalance**:</b> Entirely different placement style, without predefined placement queue. Systems are placed from most valuable to least valuable, and assigned to the player with the least valuable slice.\r\n                         </p>'\r\n                    />\r\n                    <HelpModal key={\"help-pick\"} visible={this.state.pickStyleHelp} hideModal={this.togglePickStyleHelp} title={\"About Pick Style\"}\r\n                               content='<p>\r\n                         Pick Style is used to determine how tiles are weighted for when they are placed on the board. A higher weighted tile means that the hex is more important, and so (depending on the placement style) it is put closer to home worlds to facilitate available assets.\r\n                         <br>\r\n                         <br><b>Balanced:</b> A custom weight which favors resources and planet count more than anomalies. This more accurately factors in tech specialties and influence as trade-offs to the \"Resource\" pick.\r\n                         <br><b>Resource:</b> Tiles are ordered primarily by their resource values. Higher resource planets are more coveted, and so are more important.\r\n                         <br><b>Influence:</b> Similar to \"Resource\", tiles are ordered primarily by their influence values.\r\n                         <br><b>Random:</b> Tiles are completely randomly ordered. Expect chaotic and unbalanced maps.\r\n                         <br><b>Custom:</b> Enter your own values in for balancing tradeoffs between various tile qualities.\r\n                         </p>'\r\n\r\n                    />\r\n                    <HelpModal key={\"help-races\"} visible={this.state.pickRacesHelp} hideModal={this.togglePickRacesHelp} title={\"About Picking Races\"}\r\n                         content=\"<p>\r\n                         Automatically assigns races to the players on the boards.\r\n                         <br>\r\n                         <br>\r\n                         From the set of races, turning this on will assign every player a random race (designated by assigning them the homeworld tile of that race). You should pick which player sits at a certain position before turning this on.\r\n                         </p>\"\r\n                    />\r\n                    <HelpModal key={\"help-multiple\"} visible={this.state.pickMultipleRacesHelp} hideModal={this.togglePickMultipleRacesHelp} title={\"About Picking Multiple Races\"}\r\n                         content=\"<p>\r\n                         Divides all the races evenly up amongst the players in the game (with no overflow), so that they can choose from a selection instead of being specifically assigned one race.\r\n                         <br>\r\n                         <br>\r\n                         Some groups prefer to have a draft, where every player is given a few races to pick between. This lets them pick the races that they want to play, but not have any conflicts with other players about playing a certain race.\r\n                         </p>\"\r\n                    />\r\n                    <HelpModal key={\"help-priority\"} visible={this.state.shufflePriorityHelp} hideModal={this.toggleShufflePriorityHelp} title={\"About Shuffling Priority\"}\r\n                         content='<p>\r\n                         Randomizes the priority picks for each picking round.\r\n                         <br>\r\n                         <br>\r\n                         Normally when placing tiles, this tool attempts to place the tiles so player 1 does not always get the best tiles. To do this, it follows the game setup rules and (in a 6 player game) player 1 gets to place tile 1 and 12, while player 6 gets to place tile 6 and 7.\r\n                         <br>\r\n                         <br>\r\n                         Turning this on stops this from happening, and instead completely randomizes the placement order.\r\n                         </p>'\r\n                    />\r\n                    <HelpModal key={\"help-reverse\"} visible={this.state.reversePlacementOrderHelp} hideModal={this.toggleReversePlacementOrderHelp} title={\"About Reverse Placement Order\"}\r\n                         content='<p>\r\n                         Reverses which tiles are placed first in placement order.\r\n                         <br>\r\n                         <br>\r\n                         Tiles are normally placed in priority (see randomize priority help). This reverses the order, so that the last picks are first, which generally has the effect of pushing the more valuable tiles towards the center of the galaxy.\r\n                         </p>'\r\n                    />\r\n                    <HelpModal key={\"help-racial-anomalies\"} visible={this.state.ensureRacialAnomaliesHelp} hideModal={this.toggleEnsureRacialAnomaliesHelp} title={\"About Ensure Racial Anomalies\"}\r\n                         content=\"<p>\r\n                         Ensures that races get their beneficial anomalies\r\n                         <br>\r\n                         <br>\r\n                         This option makes it so that Muaat will always receive a supernova, Saar will always receive an asteroid field, Empyrean will always receive a nebulae and Vuil'raith will always receive a gravity rift.\r\n                         </p>\"\r\n                    />\r\n\t\t\t\t\t<HelpModal key={\"help-generation-iterations\"} visible={this.state.setIterationsHelp} hideModal={this.toggleGenIterHelp} title={\"About Generation Iterations\"}\r\n                         content=\"<p>\r\n                         The board generation will iterate until the difference between the player slice with the maximum total weight and that with the minimum total weight is smaller than 25. When 50 iterations are reached, the loop ends.\r\n                         <br>\r\n                         <br>\r\n                         This field mentions the last iteration done. If value at limit (50), then the target maximum weight difference of 25 is not achieved. Manually reset the field to 0 and regenerate the board to try again.\r\n                         </p>\"\r\n                    />\r\n\t\t\t\t\t<HelpModal key={\"help-stopping-criterion\"} visible={this.state.setStopCritHelp} hideModal={this.toggleStopCritHelp} title={\"About Balance Stopping Criterion\"}\r\n                         content=\"<p>\r\n                         The board generation will iterate until the difference between the player slice with the maximum total weight and that with the minimum total weight divided by the minimum total weight slice is smaller than the Balance Convergence Limit set. When 50 iterations are reached without convergence, the loop ends.\r\n                         <br>\r\n                         <br>\r\n                         0.1 is a good value to achieve player balance with limited iterations.\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\tset 999 if only a single iteration is desired. \r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\tIf the Placement Style OptimalBalance is used, can drop the limit to 0.05.\r\n                         </p>\"\r\n                    />\r\n\t\t\t\t\t<HelpModal key={\"help-hideRaceTiles\"} visible={this.state.hideRaceTilesHelp} hideModal={this.toggleHideRaceTilesHelp} title={\"About Hiding Race Tiles\"}\r\n                         content=\"<p>\r\n                         Hide the racial home tiles on the map.\r\n                         \r\n                         </p>\"\r\n                    />\r\n            \r\n                    <button type=\"submit\" className=\"btn btn-primary\">Generate</button>\r\n                </form>\r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default MapOptions;","import React from 'react';\r\nimport $ from 'jquery';\r\nimport './App.css';\r\nimport BootstrapScripts from \"./helpers/BootstrapScripts\";\r\nimport MoreInfo from \"./panels/MoreInfo\";\r\nimport ExtraTiles from \"./panels/ExtraTiles\";\r\nimport MainOverview from \"./overview/MainOverview\";\r\nimport MainMap from \"./map/MainMap\";\r\nimport MapControls from \"./map/MapControls\";\r\nimport OptionsControls from \"./options/OptionsControls\";\r\nimport MapOptions from \"./options/MapOptions\";\r\nimport tileData from \"./data/tileData.json\";\r\nimport boardData from \"./data/boardData.json\";\r\nimport raceData from \"./data/raceData.json\";\r\nimport {calculateOffsets} from \"./helpers/Helpers\";\r\nimport ReactTooltip from \"react-tooltip\";\r\n\r\n\r\n/**\r\n * The core application page. Holds the states for common objects like tile data and player names. Responsible for\r\n * drawing the actual map.\r\n */\r\nclass App extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        \r\n        this.state = {\r\n            isOptionsMenuShowing: true,\r\n            overviewVisible: true,\r\n            extraTilesVisible: false,\r\n            moreInfoVisible: false,\r\n            backgroundAnimated: true,\r\n            showAllExtraTiles: false,\r\n            customMapBuilding: false,\r\n            tiles: [],\r\n            unusedTiles: [],\r\n\t\t\tsliceData: {},\r\n\t\t\thideRaceTiles: false,\r\n            overlayVisible: false,\r\n            zoom: 1.0,\r\n            lastCall: 0,\r\n            mobileBreakpoint: 700,\r\n            isMobileView: false,\r\n            encodedOptions: \"\",\r\n\r\n            useProphecyOfKings: false,\r\n            currentPlayerNames: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n            currentRaces: [...raceData.races],\r\n\r\n            lockedTiles: [],\r\n            excludedTiles: [],\r\n            includedTiles: [],\r\n            tileClicked: -1,\r\n            currentMobileHover: \"\",\r\n        };\r\n\r\n        this.mapOptions = React.createRef();\r\n        this.map = React.createRef();\r\n\r\n        this.drawMap = this.drawMap.bind(this);\r\n\r\n        this.onPopState = this.onPopState.bind(this);\r\n        this.checkResize = this.checkResize.bind(this);\r\n\r\n        this.updateTiles = this.updateTiles.bind(this);\r\n        this.updateLockedTiles = this.updateLockedTiles.bind(this);\r\n        this.updateInExcludedTiles = this.updateInExcludedTiles.bind(this);\r\n        this.updateTileClicked = this.updateTileClicked.bind(this);\r\n        this.updateRaces = this.updateRaces.bind(this);\r\n        this.updatePlayerNames = this.updatePlayerNames.bind(this);\r\n        this.validateTiles = this.validateTiles.bind(this);\r\n        this.toggleBackground = this.toggleBackground.bind(this);\r\n        this.removeTrailing = this.removeTrailing.bind(this);\r\n        this.getTileNumber = this.getTileNumber.bind(this);\r\n\r\n        this.toggleOptionsMenu = this.toggleOptionsMenu.bind(this);\r\n        this.toggleProphecyOfKings = this.toggleProphecyOfKings.bind(this);\r\n\t\tthis.toggleHideRaceTiles = this.toggleHideRaceTiles.bind(this);\r\n        this.toggleOverlay = this.toggleOverlay.bind(this);\r\n        this.updateTileNumberOverlays = this.updateTileNumberOverlays.bind(this);\r\n        this.toggleMoreInfo = this.toggleMoreInfo.bind(this);\r\n        this.toggleExtraTiles = this.toggleExtraTiles.bind(this);\r\n        this.toggleShowAllExtraTiles = this.toggleShowAllExtraTiles.bind(this);\r\n        this.toggleCustomMapBuilding = this.toggleCustomMapBuilding.bind(this);\r\n        this.showExtraTiles = this.showExtraTiles.bind(this);\r\n        this.zoomScroll = this.zoomScroll.bind(this);\r\n        this.zoomPlusClick = this.zoomPlusClick.bind(this);\r\n        this.zoomMinusClick = this.zoomMinusClick.bind(this);\r\n        \r\n        this.drag = this.drag.bind(this);\r\n        this.drop = this.drop.bind(this);\r\n        this.dragEnter = this.dragEnter.bind(this);\r\n        this.dragLeave = this.dragLeave.bind(this);\r\n        this.allowDrop = this.allowDrop.bind(this);\r\n        this.handleDrop = this.handleDrop.bind(this);\r\n        this.handleTouchMove = this.handleTouchMove.bind(this);\r\n        this.handleTouchEnd = this.handleTouchEnd.bind(this);\r\n\r\n    }\r\n    \r\n    /* URL CONTROLS */\r\n\r\n    /**\r\n     * After all elements on the html page have been created, run this.\r\n     */\r\n    componentDidMount() {\r\n        // Setup the main jquery selectors\r\n        // TODO move these or find a way to not use them\r\n        this.$mapContainer =  $(\"#mainContent\");\r\n        this.$tiMap = $(\"#map\");\r\n\r\n        // Grab the variables from the url on back/forward events\r\n        window.onpopstate = this.onPopState\r\n        this.onPopState();\r\n\r\n        // Change the map dimensions whenever the page size is different\r\n        window.onresize = this.checkResize\r\n        this.checkResize();\r\n\r\n        // add when mounted\r\n        document.addEventListener(\"mousedown\", this.updateTileClicked);\r\n        document.addEventListener(\"wheel\", this.zoomScroll, true);\r\n    }\r\n\r\n    /**\r\n     * We are done with the page, removing everything.\r\n     */\r\n    componentWillUnmount() {\r\n        window.onpopstate = () => {};\r\n        document.removeEventListener(\"mousedown\", this.updateTileClicked);\r\n        document.removeEventListener(\"wheel\", this.zoomScroll);\r\n    }\r\n\r\n    /**\r\n     * When the window size is changed, update various components to be better looking on mobile vs desktop.\r\n     */\r\n    checkResize() {\r\n        if (window.innerWidth < this.state.mobileBreakpoint) {\r\n            if (!this.state.isMobileView) {\r\n                // Just transitioned into mobile state, so hide the options menu\r\n                this.setState({\r\n                    isMobileView: true,\r\n                    isOptionsMenuShowing: false,\r\n                })\r\n                document.documentElement.style.setProperty('--options-width', \"0px\");\r\n            } // else { // We went from mobile to mobile, don't need to do anything\r\n        } else {\r\n            // We are in desktop state\r\n            this.setState({\r\n                isMobileView: false,\r\n                isOptionsMenuShowing: true,\r\n            })\r\n            document.documentElement.style.setProperty('--options-width', \"400px\");\r\n        }\r\n\r\n        // Redraw with the new mobile conditions\r\n        this.drawMap()\r\n    }\r\n\r\n    /**\r\n     * Whenever we go back, grab the tiles from the url bar, and set them as the current tiles.\r\n     * @param {*} event The event that triggered this function.\r\n     */\r\n    onPopState(event) {\r\n        // Get the tiles from the url\r\n        let url = new URL(document.location);\r\n        let settings = url.searchParams.get(\"settings\");\r\n        let tiles = url.searchParams.get(\"tiles\");\r\n\r\n        // Make sure the tiles parameter is set to something\r\n        const newTiles = tiles !== null ? this.validateTiles(tiles) : [];\r\n        if (settings !== null && settings !== undefined && settings !== \"\") {\r\n            // Settings param is set, so make the tile\r\n            this.setState({\r\n                encodedOptions: settings,\r\n            }, () => {\r\n                this.mapOptions.current.decodeSettings(settings, newTiles);\r\n            })\r\n        } else if (newTiles.length > 0) {\r\n            this.setState({\r\n                tiles: newTiles,\r\n\t\t\t\tsliceData: {}\r\n            }, this.drawMap)\r\n        } else {\r\n            // No tiles or settings to worry about, just bring us back to the main page\r\n            this.setState({\r\n                tiles: [],\r\n\t\t\t\tsliceData: {}\r\n            }, this.drawMap)\r\n        }\r\n    };\r\n    \r\n    /* TILE CHANGING FUNCTIONS */\r\n\r\n    /**\r\n     * Updates the tiles state with a new set of tiles, and also pushes it to the url for sharable links\r\n     * @param {number[]} newTiles\r\n     * @param newEncodedOptions the settings, encoded as a string\r\n     * @param isNewGeneration A setting to be set when a new generation occurs, to trigger adding it to the history\r\n     */\r\n    updateTiles(newTiles, newEncodedOptions, isNewGeneration, newSliceData) {\r\n        // Remove the unused tile numbers at the end of the array\r\n        newTiles = this.removeTrailing(newTiles);\r\n\t\t\r\n        // Add it to the url as a parameter\r\n        let params = '&tiles=' + newTiles.toString()\r\n        let encodedOptions = this.state.encodedOptions;\r\n        if (newEncodedOptions !== undefined) {\r\n            if (this.state.lockedTiles.length > 0 || this.state.includedTiles.length > 0) {\r\n                params = \"?settings=\" + encodedOptions + params\r\n            } else {\r\n                params = \"?settings=\" + newEncodedOptions\r\n            }\r\n            encodedOptions = newEncodedOptions\r\n        } else {\r\n            params = \"?settings=\" + encodedOptions + params\r\n        }\r\n\r\n        if (isNewGeneration || newEncodedOptions === undefined) {\r\n            // This is a new generation, or we are moving tiles, so need to push the new state\r\n            window.history.pushState({}, null, window.location.pathname + params);\r\n        }\r\n\r\n        // Hide the options menu when we are on mobile (for when the tiles update and the options menu is open)\r\n        let newOptionsMenuState = this.state.isOptionsMenuShowing\r\n        if (this.state.isMobileView) {\r\n            newOptionsMenuState = false;\r\n        }\r\n\r\n        // Update the unused tiles list\r\n        let systemNumbers = []\r\n        systemNumbers = systemNumbers.concat(tileData.blue).concat(tileData.red);\r\n        if (this.state.useProphecyOfKings) {\r\n            systemNumbers = systemNumbers.concat(tileData.pokBlue).concat(tileData.pokRed);\r\n        }\r\n        let unusedTiles = []\r\n        for (let systemNumber of systemNumbers) {\r\n            // If it is not on the map, show the system tile. Otherwise, hide it.\r\n            if (!newTiles.includes(systemNumber)) {\r\n                unusedTiles.push(systemNumber)\r\n            }\r\n        }\r\n        let tileClicked = this.state.tileClicked;\r\n        if (isNewGeneration) {\r\n            tileClicked = -1\r\n        }\r\n\r\n        this.setState({\r\n            tiles: newTiles,\r\n\t\t\tsliceData: newSliceData,\r\n            unusedTiles: unusedTiles,\r\n            tileClicked: tileClicked,\r\n            encodedOptions: encodedOptions,\r\n            isOptionsMenuShowing: newOptionsMenuState,\r\n        }, () => {\r\n            // Update the extra tiles menu, and draw a new map with the new tiles\r\n            this.showExtraTiles();\r\n            this.drawMap();\r\n        });\r\n    }\r\n\r\n    updateLockedTiles(newLockedTiles) {\r\n        this.setState({\r\n            lockedTiles: newLockedTiles,\r\n        })\r\n    }\r\n\r\n    updateTileClicked(newTileClicked) {\r\n        if (typeof newTileClicked !== \"number\" &&\r\n            (newTileClicked.target.id === \"mainContent\" || newTileClicked.target.id === \"map\")) {\r\n            this.setState({\r\n                tileClicked: -1,\r\n            })\r\n        } else if (typeof newTileClicked === \"number\") {\r\n            this.setState({\r\n                tileClicked: newTileClicked,\r\n            })\r\n        }\r\n    }\r\n\r\n    updateInExcludedTiles(newIncludedTiles, newExcludedTiles) {\r\n        this.setState({\r\n            includedTiles: newIncludedTiles,\r\n            excludedTiles: newExcludedTiles,\r\n        })\r\n    }\r\n\r\n    /**\r\n     * Removes any trailing -1s from a tile string.\r\n     * @param {number[]} tiles the tile string to clean\r\n     * @returns {number[]} the clean tile string\r\n     */\r\n    removeTrailing(tiles) {\r\n        while(tiles[tiles.length - 1] === -1){\r\n            tiles.pop();\r\n        }\r\n        return tiles;\r\n    }\r\n\r\n    /**\r\n     * Attempts to validate a given tile string, by cleaning it up and turning it into an object.\r\n     * @returns {number[]} An array of numbers representing tiles.\r\n     */\r\n    validateTiles(tiles) {\r\n        // Remove any spaces\r\n        tiles = tiles.replaceAll(\" \", \"\");\r\n        \r\n        // Check if it has opening and closing brackets. If so, remove them\r\n        if (tiles.charAt(0) === \"[\") {\r\n            tiles = tiles.substring(1, tiles.length);\r\n        }\r\n        if (tiles.charAt(tiles.length - 1) === \"]\") {\r\n            tiles = tiles.substring(0, tiles.length-1);\r\n        }\r\n        \r\n        // Now split on commas\r\n        tiles = tiles.split(',');\r\n        let newTiles = [];\r\n        for (let tile of tiles) {\r\n            newTiles.push(this.getTileNumber(tile));\r\n        }\r\n        return newTiles;\r\n    }\r\n    \r\n    /* BUTTON ACTIONS */\r\n\r\n    /**\r\n     * Toggle the visibility of the options menu for both desktop and mobile clients.\r\n     */\r\n    toggleOptionsMenu() {\r\n        // Set the css variable for options width (for desktop only)\r\n        if (window.innerWidth >= this.state.mobileBreakpoint) {\r\n            let optionsSize = this.state.isOptionsMenuShowing ? \"0px\" : \"400px\";\r\n            document.documentElement.style.setProperty('--options-width', optionsSize);\r\n        }\r\n        \r\n        // Update the map so that it correctly uses the new width\r\n        this.drawMap();\r\n        \r\n        // Update the state to the new view\r\n        this.setState({\r\n            isOptionsMenuShowing: !this.state.isOptionsMenuShowing,\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Toggle the system number overlay.\r\n     */\r\n    toggleOverlay() {\r\n        this.updateTileNumberOverlays(!this.state.overlayVisible);\r\n        \r\n        this.setState({\r\n            overlayVisible: !this.state.overlayVisible,\r\n        });\r\n    }\r\n    \r\n    updateTileNumberOverlays(showTiles) {\r\n        // Toggle the tile overlays\r\n        for (let tileNumber = 0; tileNumber < boardData.pokSize; tileNumber++) {\r\n            let numOverlay = $(\"#number-\" + tileNumber);\r\n            if (showTiles) {\r\n                // Want to show all the tiles\r\n                if (this.getTileNumber(this.state.tiles[tileNumber]) !== -1 || this.state.customMapBuilding) {\r\n                    numOverlay.show();\r\n                } else {\r\n                    // Hide the -1s when not custom map building\r\n                    numOverlay.hide()\r\n                }\r\n            } else {\r\n                // Currently showing all tiles, so with toggle we will be hiding them\r\n                if (this.state.tiles[tileNumber] !== 0 || !this.state.moreInfoVisible) {\r\n                    numOverlay.hide()\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    toggleShowAllExtraTiles() {\r\n        this.setState({\r\n            showAllExtraTiles: !this.state.showAllExtraTiles,\r\n        }, this.showExtraTiles );\r\n    }\r\n\r\n    toggleCustomMapBuilding() {\r\n        this.setState({\r\n            customMapBuilding: !this.state.customMapBuilding,\r\n        }, () => {\r\n            this.updateTileNumberOverlays(this.state.customMapBuilding || this.state.overlayVisible);\r\n            this.showExtraTiles();\r\n            this.drawMap();\r\n        } );\r\n    }\r\n\r\n    /**\r\n     * Toggle whether we need to use the prophecy of kings expansion or not\r\n     */\r\n    toggleProphecyOfKings() {\r\n        this.setState({\r\n            useProphecyOfKings: !this.state.useProphecyOfKings,\r\n        }, this.showExtraTiles);\r\n    }\r\n\t\r\n\ttoggleHideRaceTiles() {\r\n        this.setState({\r\n            hideRaceTiles: !this.state.hideRaceTiles,\r\n        }, this.drawMap);\r\n    }\r\n\r\n    /**\r\n     * Toggle whether the more info side panel is visible. If the extra tiles panel had just been triggered, we just\r\n     * need to hide the more info panel.\r\n     * @param {*} event The event that triggered this function.\r\n     * @param {boolean} justTriggeredTiles Whether or not the extra tiles panel had just been opened.\r\n     */\r\n    toggleMoreInfo(event, justTriggeredTiles) {\r\n        // Guarantee that justTriggeredTiles is set\r\n        justTriggeredTiles = justTriggeredTiles === undefined ? false : justTriggeredTiles;\r\n\r\n        let optionsSize = this.state.moreInfoVisible ? \"0px\" : \"400px\";\r\n        document.documentElement.style.setProperty('--more-info-width', optionsSize);\r\n        \r\n        // Show the player names\r\n        for (let tileNumber = 0; tileNumber < boardData.pokSize; tileNumber++) {\r\n            if (this.state.tiles[tileNumber] === 0 && !this.state.overlayVisible) {\r\n                let numOverlay = $(\"#number-\" + tileNumber);\r\n                if (!this.state.moreInfoVisible) {\r\n                    // more info button pressed, so show overlay\r\n                    numOverlay.show()\r\n                } else {\r\n                    numOverlay.hide()\r\n                }\r\n            }\r\n        }\r\n\r\n        this.setState({\r\n            moreInfoVisible: !this.state.moreInfoVisible,\r\n        }, () => {\r\n            // Hide the extra tiles if the user just pressed the show more info button\r\n            if (this.state.extraTilesVisible && !justTriggeredTiles) {\r\n                this.toggleExtraTiles(event, true);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Toggle whether the extra tiles side panel is visible.\r\n     * @param {*} event The event that triggered this function.\r\n     * @param {boolean} justTriggeredInfo Whether or not the more info panel had just been opened.\r\n     */\r\n    toggleExtraTiles(event, justTriggeredInfo) {\r\n        justTriggeredInfo = justTriggeredInfo === undefined ? false : justTriggeredInfo;\r\n\r\n        // Update what tiles are going to be displayed\r\n        this.showExtraTiles();\r\n\r\n        let optionsSize = this.state.extraTilesVisible ? \"0px\" : \"250px\";\r\n        document.documentElement.style.setProperty('--extra-tiles-width', optionsSize);\r\n\r\n        this.setState({\r\n            extraTilesVisible: !this.state.extraTilesVisible,\r\n        }, () => {\r\n            if (this.state.moreInfoVisible && !justTriggeredInfo) {\r\n                this.toggleMoreInfo(event, true);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Update what tiles are visible in the extra tiles panel based on the current tiles being used on the map\r\n     */\r\n    showExtraTiles() {\r\n        let systemNumbers = []\r\n        systemNumbers = systemNumbers.concat(tileData.blue).concat(tileData.red);\r\n        if (this.state.useProphecyOfKings || this.state.showAllExtraTiles) {\r\n            systemNumbers = systemNumbers.concat(tileData.pokBlue).concat(tileData.pokRed);\r\n        }\r\n        if (this.state.customMapBuilding) {\r\n            systemNumbers = [-1].concat(systemNumbers.concat(tileData.hyperlanes));\r\n        }\r\n\r\n        for (let systemNumber of systemNumbers) {\r\n            // If it is not on the map, show the system tile. Otherwise, hide it.\r\n            let systemSelector = $(\"#extra-\" + systemNumber);\r\n            let overlaySelector = $(\"#extra-number-\" + systemNumber);\r\n\r\n            if (this.state.showAllExtraTiles || this.state.customMapBuilding) {\r\n                systemSelector.show();\r\n                overlaySelector.show();\r\n            } else {\r\n                if (!this.state.tiles.includes(systemNumber)) {\r\n                    systemSelector.show()\r\n                    overlaySelector.show();\r\n                } else {\r\n                    systemSelector.hide()\r\n                    overlaySelector.hide();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * Toggle the background animation, from moving stars to static, and visa versa\r\n     */\r\n    toggleBackground() {\r\n        if (!this.state.backgroundAnimated) {\r\n            $(\"#stars\").css(\"animation\", \"animateStar 50s linear infinite\");\r\n            $(\"#stars2\").css(\"animation\", \"animateStar 100s linear infinite\");\r\n            $(\"#stars3\").css(\"animation\", \"animateStar 150s linear infinite\");\r\n        } else {\r\n            $(\"#stars\").css(\"animation\", \"staticStar 50s linear infinite\");\r\n            $(\"#stars2\").css(\"animation\", \"staticStar 100s linear infinite\");\r\n            $(\"#stars3\").css(\"animation\", \"staticStar 150s linear infinite\");\r\n        }\r\n        this.setState({\r\n            backgroundAnimated: !this.state.backgroundAnimated,\r\n        });\r\n    }\r\n\r\n    zoomScroll(event) {\r\n        if (this.state.lastCall < (Date.now() - 200) &&\r\n            event.ctrlKey &&\r\n            (event.target.id === \"mainContent\" || event.target.id === \"map\" || event.target.id.split(\"-\")[0] === \"tile\")) {\r\n            if (event.deltaY < 0) {\r\n                if (this.state.zoom < 3) {\r\n                    this.setState({\r\n                        zoom: this.state.zoom + 0.20,\r\n                        lastCall: Date.now()\r\n                    }, this.drawMap );\r\n                }\r\n            } else if (event.deltaY > 0) {\r\n                if (this.state.zoom > 0.5) {\r\n                    this.setState({\r\n                        zoom: this.state.zoom - 0.20,\r\n                        lastCall: Date.now()\r\n                    }, this.drawMap );\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Zoom the map in by a set amount, up until it is the same size as the original images. Then redraw the map.\r\n     */\r\n    zoomPlusClick() {\r\n        if (this.state.zoom < 3) {\r\n            this.setState({\r\n                zoom: this.state.zoom + 0.75,\r\n            }, this.drawMap );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Zoom the map out by a set amount, up until it is too small to see. Then redraw the map.\r\n     */\r\n    zoomMinusClick() {\r\n        if (this.state.zoom > 0.5) {\r\n            this.setState({\r\n                zoom: this.state.zoom - 0.75,\r\n            }, this.drawMap );\r\n        }\r\n    }\r\n\r\n    updateRaces(races) {\r\n        this.setState({\r\n            currentRaces: races,\r\n        });\r\n    }\r\n\r\n    updatePlayerNames(playerNames) {\r\n        this.setState({\r\n            currentPlayerNames: playerNames,\r\n        });\r\n    }\r\n\r\n    /* MAP GENERATION */\r\n\r\n    getTileNumber(tile, numberOnly) {\r\n        if (tile !== undefined) {\r\n            let hyperlaneRegex = /^((8[3-9]|90|91)[AB])-?([0-5])?$/gm\r\n            let result = hyperlaneRegex.exec(tile);\r\n            if (result) {\r\n                if (numberOnly) {\r\n                    return Number(result[2]);\r\n                } else {\r\n                    return result[1];\r\n                }\r\n            } else {\r\n                let regex = /^(80|81|82|-1|[0-7]?[0-9])-?([0-5])?$/gm\r\n                result = regex.exec(tile);\r\n                if (result) {\r\n                    return Number(result[1])\r\n                } else {\r\n                    return -1\r\n                }\r\n            }\r\n        } else {\r\n            return -1\r\n        }\r\n    }\r\n\r\n    /**\r\n     * The main rendering function for the map. Using the tile string, cleanly lays out a map that is centered in the\r\n     * map div.\r\n     */\r\n    drawMap() {\r\n        // Check to see if there are any tiles to render currently\r\n        if (this.state === undefined || this.state.tiles.length <= 0) {\r\n            this.setState({\r\n                overviewVisible: true,\r\n                mapVisible: false,\r\n                mapControlsVisible: false,\r\n            });\r\n            return;\r\n        } else {\r\n            this.setState({\r\n                overviewVisible: false,\r\n                mapVisible: true,\r\n                mapControlsVisible: true,\r\n            });\r\n        }\r\n\r\n        // Set the map height based on which tiles are being used\r\n        let mapNumberTilesHeight = 1;\r\n        let mapNumberTilesWidth = 1;\r\n        if (this.getTileNumber(this.state.tiles[37], true) >= 0 || this.getTileNumber(this.state.tiles[38], true) >= 0 || this.getTileNumber(this.state.tiles[60], true) >= 0\r\n            || this.getTileNumber(this.state.tiles[48], true) >= 0 || this.getTileNumber(this.state.tiles[49], true) >= 0 || this.getTileNumber(this.state.tiles[50], true) >= 0) {\r\n            mapNumberTilesHeight = 9;\r\n            mapNumberTilesWidth = 7;\r\n        } else if (this.getTileNumber(this.state.tiles[19], true) >= 0 || this.getTileNumber(this.state.tiles[20], true) >= 0 || this.getTileNumber(this.state.tiles[36], true) >= 0\r\n            || this.getTileNumber(this.state.tiles[27], true) >= 0 || this.getTileNumber(this.state.tiles[28], true) >= 0 || this.getTileNumber(this.state.tiles[29], true) >= 0) {\r\n            mapNumberTilesHeight = 7;\r\n            mapNumberTilesWidth = 5.5;\r\n        } else if (this.getTileNumber(this.state.tiles[7], true) >= 0 || this.getTileNumber(this.state.tiles[8], true) >= 0 || this.getTileNumber(this.state.tiles[18], true) >= 0\r\n            || this.getTileNumber(this.state.tiles[12], true) >= 0 || this.getTileNumber(this.state.tiles[13], true) >= 0 || this.getTileNumber(this.state.tiles[14], true) >= 0) {\r\n            mapNumberTilesHeight = 5;\r\n            mapNumberTilesWidth = 4;\r\n        } else if (this.getTileNumber(this.state.tiles[1], true) >= 0 || this.getTileNumber(this.state.tiles[2], true) >= 0 || this.getTileNumber(this.state.tiles[6], true) >= 0\r\n            || this.getTileNumber(this.state.tiles[3], true) >= 0 || this.getTileNumber(this.state.tiles[4], true) >= 0 || this.getTileNumber(this.state.tiles[5], true) >= 0) {\r\n            mapNumberTilesHeight = 3;\r\n            mapNumberTilesWidth = 2.5;\r\n        }\r\n\r\n        // Configuration options for magic numbers\r\n        let mapPadding = 0; // The amount of pad spacing to apply to the map edges\r\n        let mapTileWidth = 364; // The width of every tile in the static folder\r\n        let mapTileHeight = 317;\r\n\r\n        // Get extra information about the map\r\n        let mapWidth = this.$mapContainer.width() - (2 * mapPadding); // Put padding on top/bottom of map\r\n        let mapHeight = this.$mapContainer.height() - (2 * mapPadding); // Put padding on either side of map\r\n        let tileWidth = Math.floor(mapWidth / mapNumberTilesWidth)\r\n        let tileHeight = Math.floor(mapHeight / mapNumberTilesHeight)\r\n\r\n        // Determine which will be our constraining factor, width or height?\r\n        let constraintWidth = Math.min(this.state.zoom * Math.min(tileWidth, Math.floor((mapTileWidth / mapTileHeight) * tileHeight)), mapTileWidth) // Prohibit over-zooming\r\n        let constraintHeight = Math.floor((mapTileHeight / mapTileWidth) * constraintWidth)\r\n\r\n        // Configure the map container to be this size\r\n        this.$tiMap.css(\"width\", constraintWidth * mapNumberTilesWidth)\r\n            .css(\"height\", constraintHeight * mapNumberTilesHeight);\r\n\r\n        // Calculate the offset values for margin left and margin top per tile\r\n        let offsets = calculateOffsets(constraintWidth, constraintHeight)\r\n\r\n        // Loop over tiles to assign various values to them\r\n        let currentPlayerNumber = 0;\r\n        for (let tileNumber = 0; tileNumber < offsets.length; tileNumber++) {\r\n            // Create the selectors\r\n            let tile = $(\"#tile-\" + tileNumber);\r\n            let tileWrapper = $(\"#tile-wrapper-\" + tileNumber);\r\n            let numOverlay = $(\"#number-\" + tileNumber);\r\n            let underlay = $(\"#underlay-\" + tileNumber);\r\n            \r\n            // Decide if we should be displaying this tile\r\n            if (this.state.tiles[tileNumber] >= 0 || typeof this.state.tiles[tileNumber] === \"string\" || this.state.customMapBuilding) {\r\n                tile\r\n                    .css(\"left\", 0)\r\n                    .css(\"top\", 0)\r\n                    .css({'transform' : 'rotate(0)'})  // Reset any rotations from other hyperlanes\r\n                    .show();\r\n\r\n                tileWrapper\r\n                    .css(\"width\", constraintWidth)\r\n                    .css(\"height\", constraintHeight)\r\n                    .css(\"margin-left\", offsets[tileNumber][0])\r\n                    .css(\"margin-top\", offsets[tileNumber][1])\r\n                    .css(\"left\", (mapNumberTilesWidth / 2) * constraintWidth)\r\n                    .css(\"top\", (mapNumberTilesHeight / 2) * constraintHeight)\r\n                    .show()\r\n\r\n                if (typeof this.state.tiles[tileNumber] === \"string\") {\r\n                    // Hyperlane, so remove the last section and check if it needs to be rotated\r\n                    if (this.state.tiles[tileNumber].split(\"-\")[1] !== \"0\") {\r\n                        let degrees = 60 * Number(this.state.tiles[tileNumber].split(\"-\")[1]);\r\n                        tile.css({'transform' : 'rotate('+ degrees +'deg)'});\r\n                    }\r\n                }\r\n            } else {\r\n                tile.hide();\r\n            }\r\n\r\n            // Create the number overlay and the hover underlay for the tile\r\n            numOverlay\r\n                .css(\"margin-left\", \"-10px\")\r\n                .css(\"top\", constraintHeight/2 - 10)\r\n                .html(this.getTileNumber(this.state.tiles[tileNumber]))\r\n\r\n            underlay.css(\"width\", constraintWidth + 6)\r\n                .css(\"height\", constraintHeight + 6)\r\n                .css(\"margin-left\", \"-3px\")\r\n                .css(\"margin-top\", \"-3px\")\r\n    \r\n            // Set the names on the player home worlds to not be 0\r\n            if (this.state.tiles[tileNumber] === 0) {  // TODO should this override on selected races too?\r\n                // Show the player name\r\n                let name = this.state.currentPlayerNames[currentPlayerNumber];\r\n                numOverlay.html(name === \"\" ? \"P\" + (currentPlayerNumber + 1) : name);\r\n                currentPlayerNumber += 1;\r\n            }\r\n        }\r\n\r\n        // Clear any css classes on the map\r\n        this.$tiMap.removeClass(\"center-map\");\r\n        this.$tiMap.removeClass(\"center-map-vertical\");\r\n        this.$tiMap.removeClass(\"center-map-horizontal\");\r\n\r\n        // Check to see if we are zoomed, or map is always screen size.\r\n        if (this.state.zoom > 1.0) {\r\n            // Check to see if we should still be horizontally or vertically centered\r\n            if ((constraintWidth * mapNumberTilesWidth) < mapWidth) {\r\n                this.$tiMap.addClass(\"center-map-horizontal\");\r\n            } else if ((constraintHeight * mapNumberTilesHeight) < mapHeight) {\r\n                this.$tiMap.addClass(\"center-map-vertical\");\r\n            } else {\r\n                // Use default map values\r\n            }\r\n\r\n            // TODO find what the mouse is hovering nearest to, or over. Get that element, and zoom in. Something like\r\n            //  this? https://stackoverflow.com/questions/6519043/get-mouse-position-on-scroll\r\n\r\n            // Center Mecatol Rex on the screen\r\n            $(\"#tile-0\").get(0).scrollIntoView({behavior: \"smooth\", block:\"center\", inline: \"center\"});\r\n        } else {\r\n            // No need to move the map around, just center it on the screen\r\n            this.$tiMap.addClass(\"center-map\");\r\n        }\r\n    }\r\n\r\n    /* DRAG AND DROP FUNCTIONS, modified from https://www.w3schools.com/html/html5_draganddrop.asp */\r\n\r\n    allowDrop(ev) {\r\n        ev.preventDefault();\r\n    }\r\n    dragEnter(ev){\r\n        let targetSelector = $(\"#\" + ev.target.id);\r\n        let targetUnderlay = $(\"#underlay-\" + ev.target.id.split(\"-\")[1]);\r\n        targetSelector.addClass(\"tile-target\")\r\n        targetUnderlay.addClass(\"underlay-target\")\r\n    }\r\n    dragLeave(ev){\r\n        let targetSelector = $(\"#\" + ev.target.id);\r\n        let targetUnderlay = $(\"#underlay-\" + ev.target.id.split(\"-\")[1]);\r\n        targetSelector.removeClass(\"tile-target\")\r\n        targetUnderlay.removeClass(\"underlay-target\")\r\n    }\r\n    drag(ev) {\r\n        ev.dataTransfer.setData(\"text\", ev.target.id);\r\n    }\r\n    drop(ev) {\r\n        ev.preventDefault();\r\n        // Get the associated ids\r\n        let fromId = ev.dataTransfer.getData(\"text\");\r\n        let targetId = ev.target.id;\r\n\r\n        this.handleDrop(targetId, fromId)\r\n    }\r\n    handleDrop(targetId, fromId) {\r\n        // Create selectors\r\n        let targetSelector = $(\"#\" + targetId);\r\n        let fromSelector = $(\"#\" + fromId);\r\n        let targetUnderlay = $(\"#underlay-\" + targetId.split(\"-\")[1]);\r\n\r\n        // Get various variables for calculations\r\n        let targetType = targetId.split(\"-\")[0];\r\n        let fromType = fromId.split(\"-\")[0];\r\n        let targetSecond = targetId.slice(targetId.indexOf(\"-\") + 1);\r\n        let fromSecond = fromId.slice(fromId.indexOf(\"-\") + 1);\r\n\r\n        let tilesCopy = [...this.state.tiles];\r\n        let swapSources = true;\r\n\r\n        // Determine what swap is happening\r\n        if (fromType === \"tile\" && targetType === \"tile\") {\r\n            // Both are on the main map, so simply swap their positions in the tile array\r\n            let temp = tilesCopy[targetSecond];\r\n            tilesCopy[targetSecond] = tilesCopy[fromSecond];\r\n            tilesCopy[fromSecond] = temp;\r\n        } else if (fromType === \"extra\" && targetType === \"tile\") {\r\n            // Moving from the extra tiles onto the main map\r\n            let temp = tilesCopy[targetSecond];\r\n            tilesCopy[targetSecond] = this.getTileNumber(fromSecond);\r\n            // Update the id of the tile\r\n            if (this.state.showAllExtraTiles || this.state.customMapBuilding) {\r\n                swapSources = false;\r\n            } else {\r\n                fromSelector.attr('id', 'extra-' + temp)\r\n            }\r\n        } else if (fromType === \"tile\" && targetType === \"extra\") {\r\n            // Moving from the main map to the tiles\r\n            let temp = tilesCopy[fromSecond];\r\n            tilesCopy[fromSecond] = this.getTileNumber(targetSecond);\r\n            // Update the id of the tile\r\n            if (this.state.showAllExtraTiles || this.state.customMapBuilding) {\r\n                swapSources = false;\r\n            } else {\r\n                targetSelector.attr('id', 'extra-' + temp)\r\n            }\r\n        } else {\r\n            if (this.state.showAllExtraTiles || this.state.customMapBuilding) {\r\n                swapSources = false;\r\n            } else {\r\n                // Swapping extra tiles... Just update the ids\r\n                targetSelector.attr('id', 'extra-' + fromSecond)\r\n                fromSelector.attr('id', 'extra-' + targetSecond)\r\n            }\r\n        }\r\n\r\n        // Only swap sources if we need to\r\n        if (swapSources) {\r\n            // Temporarily store the target's source, and swap\r\n            let targetSource = targetSelector.attr('src');\r\n            targetSelector.attr('src', fromSelector.attr('src'));\r\n            fromSelector.attr('src', targetSource);\r\n        }\r\n\r\n        // Clear the target classes\r\n        targetSelector.removeClass(\"tile-target\");\r\n        targetUnderlay.removeClass(\"underlay-target\");\r\n    \r\n        // Check if we have empty tiles to fill in now. This can only happen with custom maps\r\n        if (this.state.customMapBuilding) {\r\n            tilesCopy = Array.from(tilesCopy, item => typeof item === 'undefined' ? -1 : item);\r\n        }\r\n\r\n        // Update the tile string\r\n        this.setState({\r\n            tileClicked: -1,\r\n        }, () => {\r\n            this.updateTiles(tilesCopy);\r\n        } );\r\n    }\r\n    handleTouchMove(event) {\r\n        let changedTouch = event.changedTouches[0];\r\n        let elem = document.elementFromPoint(changedTouch.clientX, changedTouch.clientY);\r\n        if (elem.id !== undefined && elem.id !== \"\" && elem.id !== this.state.currentMobileHover) {\r\n            // At a transition stage\r\n            let targetSelector = $(\"#\" + elem.id);\r\n            let targetUnderlay = $(\"#underlay-\" + elem.id.split(\"-\")[1]);\r\n            targetSelector.addClass(\"tile-target\")\r\n            targetUnderlay.addClass(\"underlay-target\")\r\n\r\n            if (this.state.currentMobileHover !== \"\") {\r\n                let targetSelector = $(\"#\" + this.state.currentMobileHover);\r\n                let targetUnderlay = $(\"#underlay-\" + this.state.currentMobileHover.split(\"-\")[1]);\r\n                targetSelector.removeClass(\"tile-target\")\r\n                targetUnderlay.removeClass(\"underlay-target\")\r\n            }\r\n\r\n            this.setState({\r\n                currentMobileHover: elem.id,\r\n                tileClicked: -1,\r\n            });\r\n        }\r\n    }\r\n    handleTouchEnd(event) {\r\n        // event.preventDefault();\r\n        event.stopPropagation();\r\n        let changedTouch = event.changedTouches[0];\r\n        let elem = document.elementFromPoint(changedTouch.clientX, changedTouch.clientY);\r\n        this.handleDrop(event.target.id, elem.id)\r\n\r\n        if (this.state.currentMobileHover !== \"\") {\r\n            let targetSelector = $(\"#\" + this.state.currentMobileHover);\r\n            let targetUnderlay = $(\"#underlay-\" + this.state.currentMobileHover.split(\"-\")[1]);\r\n            targetSelector.removeClass(\"tile-target\")\r\n            targetUnderlay.removeClass(\"underlay-target\")\r\n            this.setState({\r\n                currentMobileHover: \"\",\r\n                tileClicked: -1,\r\n            });\r\n        }\r\n    }\r\n    \r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <div id=\"mainContent\" className=\"justify-content-center align-items-center\" onClick={this.updateTileClicked}>\r\n                    <MainOverview visible={this.state.overviewVisible}\r\n                    />\r\n                    \r\n                    <MainMap visible={this.state.mapVisible} overlayVisible={this.state.overlayVisible}\r\n                             tiles={this.state.tiles} useProphecyOfKings={this.state.useProphecyOfKings} hideRaceTiles={this.state.hideRaceTiles}\r\n\r\n                             ref={this.map}\r\n\r\n                             unusedTiles={this.state.unusedTiles} updateTiles={this.updateTiles}\r\n                             lockedTiles={this.state.lockedTiles} updateLockedTiles={this.updateLockedTiles}\r\n                             includedTiles={this.state.includedTiles} updateInExcludedTiles={this.updateInExcludedTiles}\r\n                             excludedTiles={this.state.excludedTiles}\r\n                             tileClicked={this.state.tileClicked} updateTileClicked={this.updateTileClicked}\r\n                             getTileNumber={this.getTileNumber}\r\n\r\n                             drag={this.drag} drop={this.drop} dragEnter={this.dragEnter} dragLeave={this.dragLeave} allowDrop={this.allowDrop} touchEnd={this.handleTouchEnd} touchMove={this.handleTouchMove}\r\n                    />\r\n                </div>\r\n\r\n                <OptionsControls visible={this.state.isOptionsMenuShowing} isMobileView={this.state.isMobileView}\r\n                                 toggleOptions={this.toggleOptionsMenu}\r\n                />\r\n\r\n                <MapControls visible={this.state.mapControlsVisible} extraTilesVisible={this.state.extraTilesVisible}\r\n                             moreInfoVisible={this.state.moreInfoVisible} overlayVisible={this.state.overlayVisible}\r\n                             tiles={this.state.tiles} map={this.map} sliceData={this.state.sliceData}\r\n\r\n                             toggleOverlay={this.toggleOverlay}\r\n                             toggleMoreInfo={this.toggleMoreInfo} toggleExtraTiles={this.toggleExtraTiles}\r\n                             zoomPlus={this.zoomPlusClick} zoomMinus={this.zoomMinusClick}\r\n                             toggleBackground={this.toggleBackground}\r\n                />\r\n                \r\n                <ExtraTiles visible={this.state.extraTilesVisible} overlayVisible={this.state.overlayVisible}\r\n                            useProphecyOfKings={this.state.useProphecyOfKings} showAllExtraTiles={this.state.showAllExtraTiles}\r\n                            customMapBuilding={this.state.customMapBuilding}\r\n\r\n                            updateTiles={this.updateTiles} toggleShowAllExtraTiles={this.toggleShowAllExtraTiles}\r\n                            toggleCustomMapBuilding={this.toggleCustomMapBuilding}\r\n\r\n                            drag={this.drag} drop={this.drop} dragEnter={this.dragEnter} dragLeave={this.dragLeave} allowDrop={this.allowDrop}\r\n                />\r\n                \r\n                <MoreInfo visible={this.state.moreInfoVisible} currentPlayerNames={this.state.currentPlayerNames}\r\n\t\t\t\t\t\t\tuseProphecyOfKings={this.state.useProphecyOfKings} tiles={this.state.tiles} sliceData={this.state.sliceData}\r\n\t\t\t\t\t\t\tgetTileNumber={this.getTileNumber}\r\n                />\r\n                \r\n                <MapOptions visible={this.state.isOptionsMenuShowing} useProphecyOfKings={this.state.useProphecyOfKings} hideRaceTiles={this.state.hideRaceTiles}\r\n                            currentPlayerNames={this.state.currentPlayerNames} currentRaces={this.state.currentRaces}\r\n                            tiles={this.state.tiles} sliceData={this.state.sliceData} includedTiles={this.state.includedTiles}\r\n                            excludedTiles={this.state.excludedTiles} lockedTiles={this.state.lockedTiles}\r\n\r\n                            ref={this.mapOptions}\r\n\r\n                            toggleProphecyOfKings={this.toggleProphecyOfKings} updateTiles={this.updateTiles} toggleHideRaceTiles={this.toggleHideRaceTiles}\r\n                            showExtraTiles={this.showExtraTiles} updateRaces={this.updateRaces}\r\n                            updatePlayerNames={this.updatePlayerNames}\r\n                />\r\n\r\n                <ReactTooltip effect={\"solid\"}/>\r\n                <BootstrapScripts />\r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default App;\r\n","/**\r\n * Calculate offsets of the tiles in relation to Mecatol Rex (the center tile). This information\r\n * is stored in an array of two value arrays. The two value arrays reperesent the margin left\r\n * and margin top to offset the tile (based on size of of tiles).\r\n * @param width The width (in pixels) of a single tile\r\n * @param height The height (in pixels) of a single tile\r\n * @returns {(number[]|(number)[])[]} an array of two value arrays.\r\n */\r\nexport const calculateOffsets = (width, height) => {\r\n    let leftWidth = -width\r\n    let topHeight = -height\r\n    let halfWidth = Math.ceil(leftWidth * 0.5)\r\n    let halfHeight = Math.ceil(topHeight * 0.5)\r\n    let treQuarWidth = Math.ceil(leftWidth * 0.75)\r\n\r\n    return [\r\n        [halfWidth, halfHeight],  // Mecatol Rex\r\n        // Inner ring\r\n        [halfWidth, halfHeight + topHeight],\r\n        [halfWidth - treQuarWidth, halfHeight + halfHeight],\r\n        [halfWidth - treQuarWidth, 0],\r\n        [halfWidth, halfHeight - topHeight],\r\n        [halfWidth + treQuarWidth, 0],\r\n        [halfWidth + treQuarWidth, halfHeight + halfHeight],\r\n        // Middle ring\r\n        [halfWidth, halfHeight + topHeight + topHeight],\r\n        [halfWidth - treQuarWidth, halfHeight + topHeight + halfHeight],\r\n        [halfWidth - leftWidth - halfWidth, halfHeight + topHeight],\r\n        [halfWidth - leftWidth - halfWidth, halfHeight],\r\n        [halfWidth - leftWidth - halfWidth, halfHeight - topHeight],\r\n        [halfWidth - treQuarWidth, halfHeight - topHeight - halfHeight],\r\n        [halfWidth, halfHeight - topHeight - topHeight],\r\n        [halfWidth + treQuarWidth, halfHeight - topHeight - halfHeight],\r\n        [halfWidth + leftWidth + halfWidth, halfHeight - topHeight],\r\n        [halfWidth + leftWidth + halfWidth, halfHeight],\r\n        [halfWidth + leftWidth + halfWidth, halfHeight + topHeight],\r\n        [halfWidth + treQuarWidth, halfHeight + topHeight + halfHeight],\r\n        // Outer Ring\r\n        [halfWidth, halfHeight + topHeight + topHeight + topHeight],\r\n        [halfWidth - treQuarWidth, halfHeight + topHeight + topHeight + halfHeight],\r\n        [halfWidth - leftWidth - halfWidth, halfHeight + topHeight + topHeight],\r\n        [halfWidth - treQuarWidth - leftWidth - halfWidth, halfHeight + topHeight + halfHeight],\r\n        [halfWidth - treQuarWidth - leftWidth - halfWidth, halfHeight + halfHeight],\r\n        [halfWidth - treQuarWidth - leftWidth - halfWidth, halfHeight - halfHeight],\r\n        [halfWidth - treQuarWidth - leftWidth - halfWidth, halfHeight - topHeight - halfHeight],\r\n        [halfWidth - leftWidth - halfWidth, halfHeight - topHeight - topHeight],\r\n        [halfWidth - treQuarWidth, halfHeight - topHeight - topHeight - halfHeight],\r\n        [halfWidth, halfHeight - topHeight - topHeight - topHeight],\r\n        [halfWidth + treQuarWidth, halfHeight - topHeight - topHeight - halfHeight],\r\n        [halfWidth + leftWidth + halfWidth, halfHeight - topHeight - topHeight],\r\n        [halfWidth + treQuarWidth + leftWidth + halfWidth, halfHeight - topHeight - halfHeight],\r\n        [halfWidth + treQuarWidth + leftWidth + halfWidth, halfHeight - halfHeight],\r\n        [halfWidth + treQuarWidth + leftWidth + halfWidth, halfHeight + halfHeight],\r\n        [halfWidth + treQuarWidth + leftWidth + halfWidth, halfHeight + topHeight + halfHeight],\r\n        [halfWidth + leftWidth + halfWidth, halfHeight + topHeight + topHeight],\r\n        [halfWidth + treQuarWidth, halfHeight + topHeight + topHeight + halfHeight],\r\n        // Extended Ring\r\n        [halfWidth, halfHeight + topHeight + topHeight + topHeight + topHeight],\r\n        [halfWidth - treQuarWidth, halfHeight + topHeight + topHeight + topHeight + halfHeight],\r\n        [halfWidth - leftWidth - halfWidth, halfHeight + topHeight + topHeight + topHeight],\r\n        [halfWidth - treQuarWidth - leftWidth - halfWidth, halfHeight + topHeight + topHeight + halfHeight],\r\n        [halfWidth - leftWidth - leftWidth - leftWidth, halfHeight + topHeight + topHeight],\r\n        [halfWidth - leftWidth - leftWidth - leftWidth, halfHeight + topHeight],\r\n        [halfWidth - leftWidth - leftWidth - leftWidth, halfHeight],\r\n        [halfWidth - leftWidth - leftWidth - leftWidth, halfHeight - topHeight],\r\n        [halfWidth - leftWidth - leftWidth - leftWidth, halfHeight - topHeight - topHeight],\r\n        [halfWidth - treQuarWidth - leftWidth - halfWidth, halfHeight - topHeight - topHeight - halfHeight],\r\n        [halfWidth - leftWidth - halfWidth, halfHeight - topHeight - topHeight - topHeight],\r\n        [halfWidth - treQuarWidth, halfHeight - topHeight - topHeight - topHeight - halfHeight],\r\n        [halfWidth, halfHeight - topHeight - topHeight - topHeight - topHeight],\r\n        [halfWidth + treQuarWidth, halfHeight - topHeight - topHeight - topHeight - halfHeight],\r\n        [halfWidth + leftWidth + halfWidth, halfHeight - topHeight - topHeight - topHeight],\r\n        [halfWidth + treQuarWidth + leftWidth + halfWidth, halfHeight - topHeight - topHeight - halfHeight],\r\n        [halfWidth + leftWidth + leftWidth + leftWidth, halfHeight - topHeight - topHeight],\r\n        [halfWidth + leftWidth + leftWidth + leftWidth, halfHeight - topHeight],\r\n        [halfWidth + leftWidth + leftWidth + leftWidth, halfHeight],\r\n        [halfWidth + leftWidth + leftWidth + leftWidth, halfHeight + topHeight],\r\n        [halfWidth + leftWidth + leftWidth + leftWidth, halfHeight + topHeight + topHeight],\r\n        [halfWidth + treQuarWidth + leftWidth + halfWidth, halfHeight + topHeight + topHeight + halfHeight],\r\n        [halfWidth + leftWidth + halfWidth, halfHeight + topHeight + topHeight + topHeight],\r\n        [halfWidth + treQuarWidth, halfHeight + topHeight + topHeight + topHeight + halfHeight],\r\n    ]\r\n}\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}